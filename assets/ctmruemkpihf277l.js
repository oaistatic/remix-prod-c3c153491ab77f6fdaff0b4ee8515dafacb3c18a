import{f9 as E,V as R,w as l,G as f}from"./njq6ygky3ttysgdk.js";import{r as t,z as C,e as M,f as b,j as h,d as S}from"./fs6h2trisr1juto6.js";import{e as A}from"./d7a6rc8fexfzu7dt.js";const y="oauthRedirectUri",U=E(function(){const i=t.useRef(!1),[_,g]=t.useState(""),{code:s,error:r,error_description:n,state:e,[y]:p}=Object.fromEntries(new URLSearchParams(_.substring(1)).entries()),a=C().pluginId,o=M(),u=R(),c=b();return t.useEffect(()=>{g(window.location.hash)},[]),t.useEffect(()=>{if(i.current)return;a&&s&&e&&(i.current=!0);async function D(){if(!a||!s||!e){c("/");return}if(e.startsWith("v2__"))try{const d=await A.user_connection_oauth_callback(a,s,e);c(l(f.CUSTOM_MSG,d.redirect_to??"/",o.formatMessage(m.connectedDriveSyncDesc)))}catch{c(l(f.CUSTOM_ERROR,"/",o.formatMessage(m.connectedDriveErrorDesc)));return}}D()},[a,s,e,o,c,p]),t.useEffect(()=>{r&&u.danger(`${r}${n?`: ${n}`:""}`)},[r,n,u]),h.jsx(h.Fragment,{})}),m=S({connectedDriveSyncDesc:{id:"CACallback.connectedDriveSyncDesc.1",defaultMessage:"Your account has been connected."},connectedDriveErrorDesc:{id:"CACallback.connectedDriveErrorDesc.1",defaultMessage:"We encountered an issue. Please retry and contact your admin if this issue persists."},emailNotMatchDesc:{id:"CACallback.emailNotMatchDesc.1",defaultMessage:"The account you're trying to connect to doesn't match your ChatGPT account"}});export{U as default};
//# sourceMappingURL=ctmruemkpihf277l.js.map
