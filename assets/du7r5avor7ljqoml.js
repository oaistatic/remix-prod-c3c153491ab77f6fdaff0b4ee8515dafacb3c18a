import{r as R,e as T,j as o,d as z}from"./fs6h2trisr1juto6.js";import{c0 as _,cE as B,j as G,cF as P,d as p,cD as q,fR as $,bE as k}from"./njq6ygky3ttysgdk.js";import{bB as D,e1 as U,e2 as V,e3 as W,e4 as H,e5 as J,e6 as K}from"./d7a6rc8fexfzu7dt.js";import{a as O,I as Q}from"./o3d0pfqxdj7nivvr.js";import"./loh8e64j4csffv26.js";function X({asset:s,contextConnectorSourceUrl:f,isSingle:i,className:l}){const g=_(),n=B(g).flags,[t,d]=R.useState(!1),{isUnauthenticated:x}=G(),e=n?.includes(P.NoAuthEnableFileUploads),a=D(s.asset_pointer),r=U.useState(E=>U.selectFile(E,a)),w=V(r?.file??null,r?.file.name,r?.fileId??void 0,r?.gizmoId,r?.contextConnectorInfo,!0),I=x&&r&&e,{gizmoEditorData:M}=W(),S=H(),c=T(),{data:C,isLoading:y,error:N}=O({asset:s,gizmoId:M?.id,getServerUrl:!I}),{url:j,width:u,height:h}=w&&e?{width:s.width,height:s.height,url:w}:C??{},A=y||!t,F=u&&h?{Landscape:u>h,Portrait:u<h,Square:u===h}:void 0,m=["overflow-hidden rounded-lg"];i&&(m.push("w-full h-full"),F?.Landscape?m.push("max-w-96 max-h-64"):F?.Portrait?m.push("max-h-96 max-w-64"):m.push("max-w-64 max-h-64")),l&&m.unshift(l);let v;return j!=null&&(v=o.jsx(Q,{alt:c.formatMessage(L.imageAltText),className:p("max-w-full",!i&&"aspect-square","object-cover object-center",m),src:j,width:u,height:h,onLoad:()=>d(!0)}),S||(v=o.jsx(J,{src:j,alt:c.formatMessage(L.imageAltText),contextConnectorSourceUrl:f,className:p(m),children:v}))),o.jsx("div",{className:p(m),children:o.jsx("div",{className:p("relative flex h-auto w-full max-w-lg items-center justify-center overflow-hidden bg-token-main-surface-secondary text-token-text-tertiary",!i&&"aspect-square"),children:j!=null?v:o.jsx("div",{className:"flex items-center justify-center",style:{aspectRatio:`${u} / ${h}`,width:u},title:A?c.formatMessage(L.loadingImage):c.formatMessage(L.errorLoadingImage),children:A?o.jsx(q,{}):N?o.jsx($,{className:"icon-sm"}):null})})})}const L=z({loadingImage:{id:"textMessage.loadingImage",defaultMessage:"Loading..."},errorLoadingImage:{id:"textMessage.errorLoadingImage",defaultMessage:"Could not load image"},imageAltText:{id:"textMessage.imageAltText",defaultMessage:"Uploaded image"},targetedReply:{id:"textMessage.targetedReply",defaultMessage:"Replying to:"}});function b({assets:s,attachments:f,isUserTurn:i=!0,clientThreadId:l}){const g=s.length===1,{containerClassname:n,imageClassnames:t}=b.computeClassnames(s.length);return o.jsxs("div",{className:"flex w-[var(--user-chat-width,70%)] flex-col items-end",children:[o.jsx("div",{className:p("flex flex-row items-center justify-end gap-1",n),children:s.map((d,x)=>{const e=f?.find(a=>a.id&&d.asset_pointer.includes(a.id));return o.jsx(X,{asset:d,isSingle:g,contextConnectorSourceUrl:e?.context_connector_info?.source_url,className:t[x]},x)})}),o.jsx(K,{featureType:k.ATTACHMENT,isUserTurn:i,clientThreadId:l})]})}b.computeClassnames=s=>{if(s<2)return{containerClassname:null,imageClassnames:[]};let f=s>=4?"flex-wrap":"";const i=Array(s),l=e=>{i.fill(e)},g=e=>{f+=` ${e}`},n=(e,a)=>{i[e]=p(i[e],a)},t=s<=4&&s%2===0?2:3,d=Math.ceil(s/t),x=s%t!==0;t===2?(l("h-32 w-32"),g("max-w-72")):d<=2?(l("h-24 w-24 sm:h-32 sm:w-32"),g("max-w-80 sm:max-w-100")):(l("h-16 w-16"),g("max-w-52"));for(let e=0;e<s;e++){const a=Math.floor(e/t),r=e%t,w=Math.min(s-a*t,t),I=a===0,M=a===d-1,S=a===d-2,c=r===0,C=r===w-1;I&&c&&n(e,"rounded-tl-2xl"),I&&C&&n(e,"rounded-tr-2xl"),M&&c&&n(e,"rounded-bl-2xl"),M&&C&&n(e,"rounded-br-sm"),x&&c&&S&&n(e,"rounded-bl-2xl")}return{containerClassname:f,imageClassnames:i}};export{b as TextMessageImageGroup};
//# sourceMappingURL=du7r5avor7ljqoml.js.map
