import{a0 as _,bU as F,E as l,F as p,bV as N,aU as w,eR as c}from"./njq6ygky3ttysgdk.js";import{v as I,M as U,w as x,x as O,y as D}from"./d7a6rc8fexfzu7dt.js";import{u as P,g as V}from"./csg4i0wk6hi0jvkd.js";import{r as G,b as Q}from"./fs6h2trisr1juto6.js";function q({clientThreadId:s,conversationMode:g}){const u=_(),d=G.useContext(I),a=Q(),y=F(),E=P(),H=U.useIsEnabled(s);return({nodeId:r,sourceEvent:S,requestedModelId:t,appendMessages:C,extraStreamParams:e})=>{const i=l(s),f=p.getTree(i).getAllSiblingIds(r),o=p.getParentPromptNode(i,r);if(!o)throw new Error("Regeneration must have parent prompt");const T=x(a)??[],h=f?.length===1&&e?.forceUseSearch===void 0,R=N(a,y);let m=[];if(t){const v=O(R?.models,t),M=V({modelConfig:v,systemHints:T,isTemporaryChatEnabled:u}).map(n=>n.systemHint);m=Array.from(E).filter(n=>M.includes(n))}H&&(e={...e??{},enableMessageFollowups:!0});const{systemHints:b,extraStreamParams:A}=D(m,e);d({completionType:w.Variant,requestedModelId:t,sourceEvent:S,completionMetadata:{variantPurpose:h?"comparison_implicit":"none",conversationMode:g??l(s)?.mode,systemHints:b??o.message.metadata?.system_hints,searchSource:e?.forceUseSearch===!0?c.CONVERSATION_REGENERATE_WITH_SEARCH:e?.forceUseSearch===!1?c.CONVERSATION_REGENERATE_WITHOUT_SEARCH:void 0},parentMessageId:o.id,appendMessages:C,extraStreamParams:A})}}export{q as u};
//# sourceMappingURL=gunpso70jnmarvod.js.map
