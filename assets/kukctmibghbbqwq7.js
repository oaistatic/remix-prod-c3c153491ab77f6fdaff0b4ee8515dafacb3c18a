const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/e2g2hq5kkzs5dpru.js","assets/fs6h2trisr1juto6.js","assets/d7a6rc8fexfzu7dt.js","assets/njq6ygky3ttysgdk.js","assets/root-cl538jor.css","assets/conversation-small-m9kq0y4e.css","assets/navzvmlqmmmpvnl2.js","assets/cmimobs5zklmrm9x.js","assets/csg4i0wk6hi0jvkd.js","assets/dr3h4pxnog1msvu6.js","assets/jwwhrtj6dkdymig3.js","assets/ijutvl794yycgs5p.js","assets/lj0prj6na7gf1jpf.js","assets/n9whwsbg0rx5cs8k.js","assets/crv164w6r8tn71zi.js"])))=>i.map(i=>d[i]);
import{r as m,f as Pt,j as e,M as P,a5 as U,d as ve,a7 as fe,e as V,L as Ur,as as ba,k as Gr,z as zr}from"./fs6h2trisr1juto6.js";import{m as Wr,a as Vr}from"./lj0prj6na7gf1jpf.js";import{g4 as R,eA as rt,z as me,E as le,ru as Z,fq as qr,fp as dt,k as xs,o8 as bs,cL as mn,P as Nt,pM as pn,rv as Sa,bb as lt,b$ as $r,rw as Yr,rx as Kr,ry as Jr,rz as Xr,rA as Qr,rB as Zr,nW as rs,rC as Go,rD as el,rE as tl,rF as sl,kK as nl,kN as ol,gL as al,B as Ss,dR as il,kJ as rl,rG as gn,rH as ll,r3 as cl,gt as va,mq as ul,rI as dl,g3 as we,rJ as ml,mZ as kt,kA as pl,rK as T,rL as ya,rM as gl,rN as hl,rO as fl,rP as xl,rQ as bl,rR as Sl,rS as vl,rT as yl,rU as Cl,rV as jl,rW as kl,rX as wl,rY as _l,rZ as Al,r_ as Ml,bi as Pl,r$ as Nl,md as El,hJ as Et,g9 as zo,s0 as Tl,ky as Ca,s1 as Rl,s2 as Bl,ab as Il,o as ja,h6 as Dl,s3 as Ll,s4 as Fl,gj as Hl,co as Ol,a8 as vs,dD as ka,hI as Ul,e9 as Gl,gg as zl,s5 as Wl,mg as ys,s6 as Te,s7 as ss,qY as Vl,gp as ql,r2 as $l,hw as mt,ah as wa,hv as Cs,m2 as hn,hx as js,hy as ks,s8 as Yl,s9 as Kl,dp as ws,bO as Jl,sa as fn,sb as et,sc as xn,sd as Xl,se as Ql,c0 as gt,a6 as bn,sf as Zl,sg as us,my as ec,cn as tc,m3 as sc,sh as nc,si as oc,sj as ac,sk as Sn,sl as ic,sm as ds,sn as rc,so as lc,sp as cc,sq as wt,sr as ls,ss as uc,hD as dc,st as mc,ja as pc,su as gc,sv as hc,sw as fc,sx as _a,sy as Aa,sz as Ma,sA as xc,sB as Pa,sC as Qs,kz as bc,sD as Wo,sE as Sc,sF as vc,sG as yc,sH as Cc,sI as jc,sJ as kc,sK as wc,sL as _c,sM as Ac,sN as Mc,sO as Pc,sP as Nc,sQ as Ec,sR as Tc,sS as Rc,sT as Bc,lX as Ic,sU as Dc,sV as Lc,sW as Fc,sX as Hc,qa as Oc,sY as Uc,sZ as Gc,s_ as zc,U as Zs,s$ as Re,k7 as Vo,t0 as Na,t1 as Ea,t2 as ms,c5 as Qe,ln as en,t3 as vn,t4 as yn,e3 as Cn,c1 as jn,c2 as kn,c_ as wn,k6 as _n,cY as An,cZ as Mn,k9 as Wc,t5 as Vc,b_ as Pn,c3 as cs,c4 as qc,eG as $c,x as Ta,gv as Yc,q$ as qo,t6 as $o,G as Nn,t7 as Ra,t8 as Ct,t9 as Kc,ta as Jc,lt as ps,tb as Ba,tc as Xc,td as Qc,te as Yo,tf as Zc,tg as eu,c$ as tu,th as su,ti as nu,tj as ou,iH as Ia,k5 as au,nh as iu,a1 as En,gq as Da,mj as gs,eb as ru,ec as lu,ed as cu,hK as La,ee as Fa,ef as Ha,tk as Oa,eg as uu,tl as du,eh as mu,ei as pu,tm as gu,dE as hu,tn as fu,qV as xu,qW as bu,to as Su,a2 as Ua,jm as Ga,d as hs,tp as Ko,tq as za,tr as Wa,ts as tn,g8 as Jo,bk as vu,e1 as yu,e4 as Cu,M as ju,r8 as ku,tt as wu,mL as _u,tu as Au,tv as Mu,tw as Pu,iV as Nu,eM as Eu,iR as Tu,ir as Ru,ch as Bu,tx as Iu,ty as Du,tz as Lu,eJ as Xo,iY as Fu,bE as Hu,tA as Ou,H as Uu,Y as Gu,hH as zu,tB as Wu,tC as Vu,tD as qu,tE as $u,ea as Yu,tF as Qo,tG as Zo,tH as Ku,tI as Ju,cg as Xu,q7 as Qu,m5 as Zu,tJ as ed,tK as td,tL as sd,g5 as nd,tM as od,d0 as ad,el as id,em as rd,tN as ld,N as cd,mc as ud,ki as $s,kj as Ys,hY as dd,y as md,eE as pd,mX as gd,tO as hd,i7 as fd}from"./d7a6rc8fexfzu7dt.js";import{u as _s,S as xd,t as bd,v as Sd,w as vd,z as yd,A as Cd,B as ns,D as jd,c as Tn,d as Va}from"./ijutvl794yycgs5p.js";import{ho as kd,j as ye,aF as Ae,gq as wd,P as w,a as D,bw as _d,bx as Ad,c5 as Ge,d as B,aq as tt,hp as qa,a3 as ce,F as Q,dw as Be,hq as ee,E as Ze,bA as Md,a4 as $a,hr as Ya,aG as _t,a_ as ea,e as Ka,v as Pd,eq as Ja,L as ct,ah as Nd,aA as Ed,bQ as Rn,bR as Bn,g as Ks,fp as In,bH as Dn,cJ as ta,cD as Xa,hs as Qa,ht as sn,y as Ln,B as Td,cq as Se,hu as Ue,aT as Rd,c7 as Za,ex as ei,bT as ze,al as Ie,hv as ti,hw as Bd,am as Me,hx as Id,bF as Fn,cF as fs,bG as Dd,cG as si,aD as Hn,g5 as Ld,S as At,c8 as nn,dE as Fd,aj as Hd,gH as Od,gI as Ud,hy as Gd,hz as zd,hA as As,dC as Wd,V as Tt,c0 as ni,cE as oi,I as ai,dA as Vd,eR as ii,cV as qd,cT as $d,c4 as ri,c3 as X,bK as Yd,cB as sa,ek as Kd,bU as Jd,R as na,f as Xd,aM as Qd,a0 as Zd,fY as em,fX as tm,cA as oa,l as os,hB as sm,hC as nm,hD as om,z as am,hE as im,hF as rm,hG as lm,eQ as cm,d9 as um,D as dm,a1 as mm,dM as pm,hH as gm,fC as hm,aU as fm,a7 as xm,fD as bm}from"./njq6ygky3ttysgdk.js";import{a as We,b as On,h as ht,t as on,f as li,i as Rt,d as pt,u as Bt,c as Sm,j as vm,k as aa,l as ym,m as Cm,s as jm,n as km}from"./csg4i0wk6hi0jvkd.js";import{u as ci}from"./gunpso70jnmarvod.js";import{b as ui,u as wm,A as _m}from"./jyg6m0czwgwjnl3i.js";import{G as di}from"./en8ogvlmn3lccz09.js";import{U as Am,S as mi}from"./gvhvfcdqhc5unmaw.js";import{G as Mm}from"./wqepkoieaii7q4ep.js";import{a as pi,m as Mt,d as gi}from"./fu6bathgya5b9rdr.js";import{P as Pm}from"./gfo75oujoeaedm5y.js";function hi(t){const s=On(),n=t.useState(o=>o.getSystemHints()[0]);return s.size?s.values().next().value:n}function Un(t,s){const{clearAllSystemHintModeTriggers:n,setThreadSystemHintMode:a}=We();return m.useCallback(({hint:o,enable:r})=>{n();const c=!!o.composerBarButtonInfo;r?c?(a(o.systemHint,!0,{clientThreadId:s}),t.removeSystemHints()):(t.addSystemHint(o.systemHint,o.name),setTimeout(()=>{t.focus()},0)):t.removeSystemHints()},[n,t,a,s])}const Nm={[R.Research]:kd.DEEP_RESEARCH};function Em(t){return Nm[t]??null}function Tm(t,s){return new Date(t).toLocaleDateString(s,{month:"long",day:"numeric"})}const Rm="https://persistent.oaistatic.com/image-gen/nux.222e584e.mp4",Bm="https://help.openai.com/en/articles/8932459",fi=[{title:"Create an image",body:" of a magazine cover of cute animals with headlines and text",type:rt.Autocomplete,prompt:"Create an image of a photorealistic magazine cover for 'CUTE ANIMALS,' featuring three impossibly cute and stylishly accessorized pets, with realistic, catchy headlines and teaser text"},{title:"Create an image",body:" for a garden-themed birthday party invitation",type:rt.Autocomplete,prompt:"Create an image of a colorful invitation for a garden-themed birthday party, including whimsical typography"},{title:"Create an image",body:" of an astronaut with an inflatable duck on Mars",type:rt.Autocomplete,prompt:"Create a photorealistic image of an international astronaut on Mars, wearing a giant duck inflatable toy around its waist"},{title:"Create an image",body:" of a tutorial for cooking pasta",type:rt.Autocomplete,prompt:"Create an image of a comic-book style tutorial for cooking pasta"}],rh=()=>{const{isLoading:t,eligible:s}=me(le.hasSeenShibaHomeNux),{isUnauthenticated:n}=ye(),{value:a}=Ae("2781425969");return n||!a?"hide":t?"loading":s?"show":"hide"},lh=({onClose:t,clientThreadId:s})=>{const{markAsViewed:n}=me(le.hasSeenShibaHomeNux),a=_s(),o=Pt(),r=wd("2604379743").config.value,c=typeof r.nux_video_url=="string"?r.nux_video_url:Rm,i=typeof r.nux_image_url=="string"?r.nux_image_url:"",[d,p]=m.useState(!1),u=Un(a,s),{activeSystemHints:l}=ht(s),g=l.find(x=>x.systemHint===R.PictureV2);m.useEffect(()=>{w.logEventWithStatsig(D.chatgptImageGenNuxModalShown,"chatgpt_imagegen_nux_modal_shown")},[]);const f=()=>{n(),t()},h=()=>{n(),t(),a.setText("Create an image"),requestAnimationFrame(()=>{requestAnimationFrame(()=>{g&&u({hint:g,enable:!0}),a.focus()})}),a.setAutocompletions(fi)};return e.jsx(e.Fragment,{children:e.jsxs(_d,{isOpen:!0,noPadding:!0,onClose:Ad,shouldIgnoreClickOutside:!0,showCloseButton:!1,size:"custom",type:"success",className:"max-w-lg",children:[e.jsxs("div",{className:"relative aspect-[3/2] w-full",children:[!d&&e.jsx("img",{src:i,alt:"",className:"absolute inset-0 h-full w-full object-cover object-bottom transition-opacity duration-300"}),e.jsx("video",{src:c,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"h-full w-full object-cover object-bottom",onLoadedData:()=>p(!0)})]}),e.jsxs("div",{className:"flex flex-col gap-2 px-8 pb-6 pt-6 text-center",children:[e.jsx("div",{className:"text-xl font-medium",children:e.jsx(P,{id:"KgZP2O",defaultMessage:"Image creation just got better"})}),e.jsx("div",{className:"w-full text-token-text-secondary",children:e.jsx(P,{id:"/oguus",defaultMessage:"ChatGPT now thinks a little longer to make more accurate and detailed images. <link>Learn more</link>",values:{link:x=>e.jsx("a",{href:Bm,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 no-underline",children:x})}})}),e.jsx("div",{className:"mt-2 w-full text-xs text-[#8F8F8F] dark:text-[#C4C4C4]",children:e.jsx(P,{id:"6pIXUv",defaultMessage:"You must have permission to edit images you upload, including consent from any people in them."})}),e.jsxs("div",{className:"mt-4 flex w-full gap-3",children:[e.jsx(Ge,{color:"secondary",onClick:f,className:"flex-1",children:e.jsx(P,{id:"6nf9tD",defaultMessage:"Not now"})}),e.jsx(Ge,{color:"primary",onClick:()=>{h(),o("/?model=gpt-4o")},className:"flex-1",children:e.jsx(P,{id:"ms5BU0",defaultMessage:"Try it"})})]})]})]})})},xi=({className:t,children:s})=>e.jsx(U.div,{className:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.1,delay:0}},transition:{type:"tween",duration:.3,delay:.2},children:s});function Im({canContinue:t,onContinueGenerating:s}){const n=m.useCallback(o=>{s(o),on()},[s]);let a=null;return t&&(a=e.jsx(Lm,{onHandleContinueGenerating:n})),a&&e.jsx("div",{className:"flex h-full w-full items-center justify-end gap-0 py-4 md:gap-2",children:a})}function Dm({className:t}){return e.jsx(qr,{className:B("-rotate-180",t)})}const Lm=({onHandleContinueGenerating:t})=>e.jsx(xi,{children:e.jsx(Ge,{as:"button",color:"secondary",onClick:t,className:"whitespace-nowrap py-2",icon:Dm,size:"small",children:e.jsx(P,{...Z.continueGenerating})})}),Fm=({clientThreadId:t,rateLimitInfo:s,onDismiss:n,onInteract:a,onMount:o})=>{const{name:r,title:c,call_to_action:i,description:d}=s,p=tt(),u=dt(!0),l=dt(!1),g=qa(),f=ce(t,Q.getIsNewConversation),h=p?.planType??"unknown",x=g&&"block_reason"in g?g.block_reason:null,k="banner_description",y=m.useMemo(()=>({type:r||"unknown",location:k,plan_type:h,is_new_conversation:f,is_hard_block:!!g,hard_block_reason:x??"",call_to_action:i}),[r,k,h,f,g,x,i]),C=Pt(),_=xs(),{isUnauthenticated:E}=ye(),A=bs(),j=mn(Be.signUpButtonText),I=Nt(),H=ci({clientThreadId:t}),v=N=>{switch(N){case ee.AUTHENTICATE:return{text:A?Be.logInButtonText:j,onClick:()=>{_({authType:A?"login":"signup",callback:M=>{A?w.logLogInButtonClicked({location:`Rate limit banner - ${r}`,provider:M}):w.logSignUpButtonClicked({location:`Rate limit banner - ${r}`,provider:M})}})}};case ee.AUTHENTICATE_SECONDARY:return{text:A?j:Be.logInButtonText,onClick:()=>{_({authType:A?"signup":"login",callback:M=>{A?w.logSignUpButtonClicked({location:`Rate limit banner - ${r}`,provider:M}):w.logLogInButtonClicked({location:`Rate limit banner - ${r}`,provider:M})}})}};case ee.GET_PLUS:return{text:jt.getPlusButton,onClick:()=>{w.logRateLimitGetPlusButtonClicked(y),E?_({authType:A?"login":"signup",shouldOpenPaymentModalOnAuth:!0,callback:M=>{A?w.logLogInButtonClicked({location:"Rate limit banner Get Plus upsell",provider:M}):w.logSignUpButtonClicked({location:"Rate limit banner Get Plus upsell",provider:M})}}):lt(C,"Prompt textarea rate limit banner")}};case ee.NEW_CHAT:return{text:jt.newChatButton,onClick:()=>{u({modelId:"",location:k})}};case ee.PAID_USER_O3_MINI_HIGH:{const M=Q.getCurrentLeafId(Ze(t)),z=()=>{l({modelId:"o3-mini-high",location:"In-context upsell o3-mini-high for Plus banner - Try it button"}),H({sourceEvent:new Event("click"),nodeId:M,requestedModelId:"o3-mini-high"})};return w.logEventWithStatsig(D.inContextUpsellBannerO3MiniHighCtaClicked,"chatgpt_in_context_upsell_banner_o3_mini_high_cta_clicked",{location:"In-context upsell o3-mini-high for Plus banner - Try it button",eventProperties:y}),{text:jt.o3MiniHighButton,onClick:z}}case ee.FREE_USER_O3_MINI_HIGH:return{text:jt.getPlusButton,onClick:()=>{w.logEventWithStatsig(D.inContextUpsellBannerO3MiniHighCtaClicked,"chatgpt_in_context_upsell_banner_o3_mini_high_cta_clicked",{location:"In-context upsell o3-mini-high for Free banner - Get Plus button",eventProperties:y}),lt(C,"Prompt textarea in-context upsell banner")}};case"get_pro":return{text:jt.getProButton,onClick:()=>{w.logRateLimitUpgradePlanButtonClicked({...y,upgrade_plan_tye:"pro"}),E?_({authType:A?"login":"signup",shouldOpenPaymentModalOnAuth:!0,callback:M=>{A?w.logLogInButtonClicked({location:"Rate limit banner Get Pro upsell",provider:M}):w.logSignUpButtonClicked({location:"Rate limit banner Get Pro upsell",provider:M})}}):lt(C,"Prompt textarea rate limit banner")}}}};pn(()=>{w.logRateLimitBannerShown(y),o?.()});let[b,F]=i??[];b===ee.AUTHENTICATE&&I&&(F=ee.AUTHENTICATE_SECONDARY);const O={primaryAction:v(b),secondaryAction:v(F)};return e.jsx(Sa,{onDismiss:n,title:c,description:d,actions:O,onInteract:a})},jt=ve({getPlusButton:{id:"TeyLcp",defaultMessage:"Get Plus"},getProButton:{id:"Pl8/Vk",defaultMessage:"Get Pro"},newChatButton:{id:"7OvnJ5",defaultMessage:"New chat"},o3MiniHighButton:{id:"DXaA+T",defaultMessage:"Try it"}}),Hm=({clientThreadId:t,rateLimitInfo:s,onDismiss:n,onInteract:a,onMount:o})=>{const{name:r,title:c,call_to_action:i,description:d}=s,p=tt(),u=dt(!0),l=dt(!1),g=qa(),f=ce(t,Q.getIsNewConversation),h=p?.planType??"unknown",x=Nt(),k=g&&"block_reason"in g?g.block_reason:null,y="banner_description",C=m.useMemo(()=>({type:r||"unknown",location:y,plan_type:h,is_new_conversation:f,is_hard_block:!!g,hard_block_reason:k??"",call_to_action:i}),[r,y,h,f,g,k,i]),_=Pt(),E=xs(),{isUnauthenticated:A}=ye(),j=bs(),I=mn(Be.signUpButtonText),H=ci({clientThreadId:t}),v=N=>{switch(N){case ee.AUTHENTICATE:return{text:j?Be.logInButtonText:I,onClick:()=>{E({authType:j?"login":"signup",callback:M=>{j?w.logLogInButtonClicked({location:`Rate limit banner - ${r}`,provider:M}):w.logSignUpButtonClicked({location:`Rate limit banner - ${r}`,provider:M})}})}};case ee.AUTHENTICATE_SECONDARY:return{text:j?I:Be.logInButtonText,onClick:()=>{E({authType:j?"signup":"login",callback:M=>{j?w.logSignUpButtonClicked({location:`Rate limit banner - ${r}`,provider:M}):w.logLogInButtonClicked({location:`Rate limit banner - ${r}`,provider:M})}})}};case ee.GET_PLUS:return{text:as.getPlusButton,onClick:()=>{w.logRateLimitGetPlusButtonClicked(C),A?E({authType:j?"login":"signup",shouldOpenPaymentModalOnAuth:!0,callback:M=>{j?w.logLogInButtonClicked({location:"Rate limit banner Get Plus upsell",provider:M}):w.logSignUpButtonClicked({location:"Rate limit banner Get Plus upsell",provider:M})}}):lt(_,"Prompt textarea rate limit banner")}};case ee.NEW_CHAT:return{text:as.newChatButton,onClick:()=>{u({modelId:"",location:y})}};case ee.PAID_USER_O3_MINI_HIGH:{const M=Q.getCurrentLeafId(Ze(t)),z=()=>{l({modelId:"o3-mini-high",location:"In-context upsell o3-mini-high for Plus banner - Try it button"}),H({sourceEvent:new Event("click"),nodeId:M,requestedModelId:"o3-mini-high"})};return w.logEventWithStatsig(D.inContextUpsellBannerO3MiniHighCtaClicked,"chatgpt_in_context_upsell_banner_o3_mini_high_cta_clicked",{location:"In-context upsell o3-mini-high for Plus banner - Try it button",eventProperties:C}),{text:as.o3MiniHighButton,onClick:z}}case ee.FREE_USER_O3_MINI_HIGH:return{text:as.getPlusButton,onClick:()=>{w.logEventWithStatsig(D.inContextUpsellBannerO3MiniHighCtaClicked,"chatgpt_in_context_upsell_banner_o3_mini_high_cta_clicked",{location:"In-context upsell o3-mini-high for Free banner - Get Plus button",eventProperties:C}),lt(_,"Prompt textarea in-context upsell banner")}}}};pn(()=>{w.logRateLimitBannerShown(C),o?.()}),m.useEffect(()=>()=>{w.logEventWithStatsig(D.rateLimitBannerDismissed,"chatgpt_rate_limit_banner_dismissed",C)},[C]);let[b,F]=i??[];b===ee.AUTHENTICATE&&x&&(F=ee.AUTHENTICATE_SECONDARY);const O={primaryAction:v(b),secondaryAction:v(F)};return e.jsx(Sa,{onDismiss:n,title:c,description:d,actions:O,onInteract:a})},as=ve({getPlusButton:{id:"TeyLcp",defaultMessage:"Get Plus"},newChatButton:{id:"7OvnJ5",defaultMessage:"New chat"},o3MiniHighButton:{id:"DXaA+T",defaultMessage:"Try it"}}),bi=t=>{const{value:s}=Ae("1028682714");return s?e.jsx(Fm,{...t}):e.jsx(Hm,{...t})},Om=({clientThreadId:t})=>{const s=Ya(),n=ce(t,Q.getRequestId),a=ce(t,Q.getCurrentLeafId),o=$a(n),r=s?.name?()=>{switch(s.name){case"o3-mini-high-in-context-upsell-free":case"o3-mini-high-in-context-upsell-plus":Zr(a);break}}:void 0;m.useEffect(()=>{o&&ea.dismissBanner()},[o]);const c=s?.is_dismissible?()=>{w.logEventWithStatsig(D.rateLimitBannerDismissed,"chatgpt_rate_limit_banner_dismissed",{type:s?.name}),ea.dismissBanner()}:void 0,i=()=>{switch(s?.name){case"o3-mini-high-in-context-upsell-free":case"o3-mini-high-in-context-upsell-plus":sl({interactedInPeriod:!0});break}};return e.jsx(fe,{children:s&&e.jsx(U.div,{transition:{type:"tween",ease:"easeInOut",duration:.1},initial:{opacity:0,transform:"translateY(8px)"},animate:{opacity:1,transform:"translateY(0px)"},exit:{opacity:0,transform:"translateY(8px)"},children:e.jsx(bi,{clientThreadId:t,rateLimitInfo:s,onDismiss:c,onInteract:i,onMount:r})})})};function Um(t,s,n,a,o,r,c,i,d,p,u){if(d||s.some(C=>C.model_slug==="o3-mini-high")||n.id==="o3-mini-high"||i&&c&&rs(Date.now(),c)<Go)return!1;const h=a==null||rs(Date.now(),a)>=el,x=o===p,k=c==null||r==null||rs(Date.now(),c)>=Go||r<tl;return h&&k||x?t.name==="o3-mini-high-in-context-upsell-free"?u("should_show_o3_mini_high_upsell_banner_free_user_to_plus",!1):u("should_show_o3_mini_high_upsell_banner_plus_user",!1):!1}function Gm(t){const s=Md(),n=$r(t),a=ce(t,Q.getRequestId),o=ce(t,Q.getCurrentLeafId),r=$a(a),c=Ya(),i=Yr(h=>h.lastSeenInContextUpsellBannerAt),d=Kr(h=>h.inContextUpsellBannerPeriodExposureCount),p=Jr(h=>h.inContextUpsellBannerPeriodStartAt),u=Xr(h=>h.inContextUpsellBannerLastSeenId),l=Qr(h=>h.inContextUpsellBannerInteractedInPeriod),{layer:g}=_t("1368081792");let f=!1;switch(c?.name){case null:case void 0:f=!1;break;case"o3-mini-high-in-context-upsell-free":case"o3-mini-high-in-context-upsell-plus":f=Um(c,s,n,i,u,d,p,l,r,o,g.get);break;default:f=!0}return!r&&f}const an=window.sessionStorage,rn=Ka(Pd(()=>({memoryFullBannerDismissed:!!an?.getItem(ct.MemoryFullBannerDismissed)}))),Si={dismissBanner(){rn.setState(t=>{t.memoryFullBannerDismissed=!0}),an?.setItem(ct.MemoryFullBannerDismissed,"true")},clearDismissedBanner(){rn.setState(t=>{t.memoryFullBannerDismissed=!1}),an?.removeItem(ct.MemoryFullBannerDismissed)}};function zm(t){const s=Ja(t),n=nl(),{data:a}=ol(s,!1,n),o=a!=null,r=o&&a.memoryFullPct>=100,[c,i]=m.useState(!1);m.useEffect(()=>{!r&&o&&(i(!0),Si.clearDismissedBanner())},[r,o]);const d=rn(p=>p.memoryFullBannerDismissed);return r&&c&&!d}function Wm(){const t=V(),{openSettings:s}=al();return e.jsx(U.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx(Ss,{title:t.formatMessage(is.memoryFullTitle),content:t.formatMessage(is.memoryFullTooltip,is.memoryFullTooltip.values),primaryCtaText:t.formatMessage(is.memoryManageButton),onPrimaryCtaClick:()=>s(il.Personalization),onDismiss:()=>Si.dismissBanner()})})}const is=ve({memoryFullTitle:{id:"yRGU2/",defaultMessage:"Memory is full."},memoryManageButton:{id:"a5A88o",defaultMessage:"Manage"},memoryFullTooltip:{id:"neUc+N",defaultMessage:"New memories won’t be created until you make space. <a>Learn more</a>",values:{a:t=>e.jsx("a",{href:rl,target:"_blank",rel:"noopener noreferrer",className:"underline",children:t})}}});function Vm(){const t=V(),s=()=>{vi.setState({lastSeenUpsellBannerAt:Date.now()})};return e.jsx(Ss,{primaryCtaText:t.formatMessage(Js.connectLabel),onPrimaryCtaClick:()=>{window.location.href="/admin/ca"},onDismiss:s,content:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ll,{size:16,icons:[e.jsx(cl,{className:"icon-md"},"slack"),e.jsx(va,{className:"icon-md"},"gDrive")]}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("div",{className:"flex items-center gap-2 font-bold",children:t.formatMessage(Js.title)}),e.jsx("span",{className:"text-token-text-secondary",children:t.formatMessage(Js.description)})]})]})})}const qm=7,$m="oai/apps/caUpsellBanner",vi=Ka()(Nd(()=>({lastSeenUpsellBannerAt:void 0}),{name:$m}));function Ym(t){const s=vi(d=>d.lastSeenUpsellBannerAt?rs(Date.now(),d.lastSeenUpsellBannerAt)>=qm:!0),{activeSystemHints:n}=ht(t),a=m.useMemo(()=>n.some(d=>d.systemHint===R.ContextualAnswers),[n]),{connectionInstanceData:o,isLoading:r}=gn({skip:!a}),c=Ed(),i=!!c?.isAdminOfAccount()||!!c?.isOwnerOfAccount();return s&&a&&i&&!r&&o?.connection_statuses.length===0}const Js=ve({connectLabel:{id:"ContextualAnswersAdminUpsellBanner.connectLabel",defaultMessage:"Connect"},title:{id:"ContextualAnswersAdminUpsellBanner.title",defaultMessage:"Set up internal knowledge for your team"},description:{id:"ContextualAnswersAdminUpsellBanner.description",defaultMessage:"Enable your team to leverage knowledge from your Slack and Google Drive"}}),Gn=le.hasSeenMemoryInSearch;function Km(){const t=Pt();m.useEffect(()=>{w.logEventWithStatsig(D.chatgptMemoryInSearchAnnouncementShown,"chatgpt_memory_in_search_announcement_shown")},[]);const{markAsViewed:s}=me(Gn),n=m.useCallback(()=>{w.logEventWithStatsig(D.chatgptMemoryInSearchAnnouncementClosed,"chatgpt_memory_in_search_announcement_closed"),s()},[s]),a=m.useCallback(()=>{w.logEventWithStatsig(D.chatgptMemoryInSearchAnnouncementCTAClicked,"chatgpt_memory_in_search_announcement_cta_clicked"),t("#settings/Personalization"),s()},[s,t]);return e.jsx(Ss,{onPrimaryCtaClick:a,primaryCtaText:e.jsx(P,{id:"8MwdJw",defaultMessage:"Settings"}),onDismiss:n,content:e.jsxs("div",{className:"flex-grow",children:[e.jsx("div",{className:"mb-0.5 font-semibold",children:e.jsx(P,{id:"Sdp8JT",defaultMessage:"Search, now with memory"})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(P,{id:"a4czFu",defaultMessage:"ChatGPT can now use memories to shape searches it sends to search providers, to give you more relevant answers. You can turn this off at any time in settings. {learnMoreLink}",values:{learnMoreLink:e.jsx("a",{href:"https://help.openai.com/en/articles/9237897-chatgpt-search",target:"_blank",rel:"noopener noreferrer",className:"underline",children:e.jsx(P,{id:"JMsjZT",defaultMessage:"Learn more"})},"learn-more-link")}})})]})})}function yi(){const t=me(Gn),{userIsInSearchHoldoutWithWebDisabled:s}=li();return t.eligible&&!t.isLoading&&!s}function Jm(){const{markAsViewed:t,eligible:s}=me(Gn);return s?t:void 0}const Xm=()=>{const{shouldShowSkipButton:t}=ul();return t?e.jsx(xi,{className:"flex justify-center",children:e.jsx(Ge,{as:"button",color:"secondary",onClick:()=>dl.skipParagen(),children:e.jsx(P,{...Qm.skip})})}):null},Qm=ve({skip:{id:"dvcUbp",defaultMessage:"Skip"}}),Zm=Rn(()=>Bn(()=>import("./e2g2hq5kkzs5dpru.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(t=>t.JawboneNotificationsBanner)),Ci=m.memo(function({className:s}){const{store:n}=we(),a=n.useIsHeaderContentAreaPopulated();return e.jsx("div",{className:B(s??"absolute bottom-full left-0 right-0",gl.PromptTextareaHeader),children:e.jsx(ml,{shouldRender:a,contentArea:kt.Header,children:e.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[e.jsx(ep,{}),e.jsx(tp,{})]})})})});function ep(){const{store:t}=we(),s=t.useSharedProps(r=>r?.clientThreadId),n=t.useContentAreaId(kt.HeaderTop),a=pl();let o;switch(n){case T.ProjectConversationTaskNoFileAccess:o=e.jsx(ap,{});break;case T.AdvancedVoiceOnMobileAnnouncement:o=e.jsx(wl,{clientThreadId:s});break;case T.S09KM1:o=null;break;case T.ParagenControls:o=e.jsx(Xm,{});break;case T.BannerSignup:o=e.jsx(op,{});break;case T.BannerTermsDisclaimer:o=e.jsx(ip,{});break;case T.PromptTextareaAction:o=e.jsx(rp,{});break;case T.BannersRateLimit:o=e.jsx(lp,{});break;case T.BannerSidekickAnnouncement:o=e.jsx(kl,{});break;case T.SearchBrowserExtensionAnnouncement:o=e.jsx(bd,{});break;case T.MemoryInSearchAnnouncement:o=e.jsx(Km,{});break;case T.MoonshineAnnouncement:o=e.jsx(jl,{});break;case T.CustomizeChatGPTAnnouncement:o=e.jsx(Cl,{});break;case T.SearchBrowserExtensionReactiveAnnouncement:o=e.jsx(xd,{});break;case T.BannerMemoryFull:o=e.jsx(Wm,{});break;case T.Box:o=e.jsxs("div",{id:"Box",className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",e.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;case T.JawboneAnnouncement:a?o=e.jsx(Zm,{}):o=null;break;case T.JawboneMaxActiveAnnouncement:a?o=e.jsx(yl,{}):o=null;break;case T.PromoRedemptionAnnouncement:o=e.jsx(vl,{});break;case T.OperatorAnnouncement:o=e.jsx(Sl,{});break;case T.BannerPlusUpsell:o=e.jsx(bl,{});break;case T.ContextualAnswersAdminUpsell:o=e.jsx(Vm,{});break;case T.ReferrerRedemptionAvailableAnnouncement:o=e.jsx(xl,{});break;case T.RefereeRedemptionAvailableAnnouncement:o=e.jsx(fl,{});break;case T.ReferralProgramUpsellAnnouncement:o=e.jsx(hl,{});break;default:o=null;break}return o}function tp(){const{store:t}=we(),s=t.useContentAreaId(kt.HeaderBottom);let n;switch(s){case ya.DallePromptControls:n=e.jsx(np,{});break;default:n=null;break}return n}const sp=Rn(()=>Bn(()=>import("./cmimobs5zklmrm9x.js"),__vite__mapDeps([7,1,3,4,2,5,8,9])).then(t=>t.default));function np(){const{store:t}=we(),s=t.useSharedProps(n=>n?.composerController);return s?e.jsx(sp,{composerController:s}):null}function op(){const{store:t}=we(),s=t.useSharedProps(o=>o?.clientThreadId),n=bs(),a=_l();return s?n?e.jsx(Al,{threadId:s,showSignUp:a}):e.jsx(Ml,{threadId:s,showLogin:a}):null}function ap(){return m.useEffect(()=>()=>{Ks.getItem(ct.TasksHasSeenProjectDisclaimerBanner)||Ks.setItem(ct.TasksHasSeenProjectDisclaimerBanner,!0)},[]),e.jsx(Ss,{icon:e.jsx(Pl,{}),title:e.jsx(P,{id:"ibX3g7",defaultMessage:"Tasks can’t access project files"}),content:e.jsx(P,{id:"fm94Tm",defaultMessage:"There’s a task in this conversation — just FYI, it won’t be able to access project files."}),onDismiss:()=>{Ks.setItem(ct.TasksHasSeenProjectDisclaimerBanner,!0)}})}function ip(){const{store:t}=we(),s=t.useSharedProps(n=>n?.clientThreadId);return s?e.jsx(Nl,{threadId:s}):null}function rp(){const{store:t}=we(),s=t.useSharedProps();return s?e.jsx(Im,{...s}):null}function lp(){const{store:t}=we(),s=t.useSharedProps(n=>n?.clientThreadId);return s?e.jsx(Om,{clientThreadId:s}):null}function ia({clientThreadId:t,onClick:s}){m.useEffect(()=>{Tl(t)},[t]);const n=V();return e.jsx(U.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:e.jsx(Ca,{onClick:()=>{Rl(t),s()},label:n.formatMessage(pp.moreStarterPrompts)})})}function cp({starterPrompt:t,starterPrompts:s,index:n,disabled:a,onSelectStarterPrompt:o}){const r=t.theme??t.title,c=wm(),{mutate:i}=Bl(),d=t.category==="onboarding"?p=>{i({key:le.hasUsedConversationalOnboardingStarterPrompt}),c(p,t,s,n)}:p=>o?.(p,t,s,n);return e.jsx(Ca,{disabled:a,onClick:d,icon:e.jsx(Il,{category:t.category,useV2Colors:!0}),label:r})}const up=5,dp=3;function ji({starterPrompts:t,onSelectStarterPrompt:s,disabled:n,clientThreadId:a,onExpand:o,mobileLayout:r=!1}){const c=r?dp:up,[i,d]=m.useState(c),[p,u]=m.useState(!1),l=m.useRef(null),g=t.length<=i;m.useEffect(()=>{zo(t.slice(0,c),a)},[a]),m.useEffect(()=>{if(!p&&!g&&l.current){const h=l.current,x=h.getBoundingClientRect(),k=x.width,y=Array.from(h.children);let C=0;for(let _=0;_<y.length&&y[_].getBoundingClientRect().right-x.left<=k;_++)C++;d(C),u(!0)}},[t,g,p]);const f=()=>{const h=t.slice(i,t.length).map(x=>({...x,isAdditional:!0}));h.length>0&&zo(h,a),d(t.length),o()};return e.jsxs("div",{className:B("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",p&&t.length>0?"opacity-100":"opacity-[0.01]",r?"flex-wrap":"flex-nowrap"),children:[e.jsxs("ul",{className:B("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",g||r?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:l,children:[t.slice(0,i).map((h,x)=>e.jsx(U.li,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},children:e.jsx(cp,{starterPrompt:h,starterPrompts:t,index:x,disabled:n,onSelectStarterPrompt:s})},h.id??x)),r&&t.length>i&&e.jsx(ia,{clientThreadId:a,onClick:f})]}),!r&&t.length>i&&e.jsx(ia,{clientThreadId:a,onClick:f})]})}const ch=({clientThreadId:t,currentModelId:s,isModelLoaded:n})=>{const[a,o]=m.useState(!1),r=In(),{prospectiveModelId:c}=Et(t),i=n?s:c??"auto",{promptStarters:d,shouldShowStarterPrompts:p,onSelectStarterPrompt:u}=ui({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:t,limit:8,modelSlug:i});return e.jsx(U.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:B(!a&&"h-[116px]"),children:p&&d&&e.jsx(ji,{starterPrompts:d,onSelectStarterPrompt:u,disabled:r,clientThreadId:t,onExpand:()=>o(!0),mobileLayout:!0})})},mp=({currentModelId:t,clientThreadId:s,isModelLoaded:n})=>{const{isUnauthenticated:a}=ye(),[o,r]=m.useState(!1),c=El(),i=In(),{prospectiveModelId:d}=Et(s),p=n?t:d??"auto",{promptStarters:u,shouldShowStarterPrompts:l,onSelectStarterPrompt:g}=ui({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:s,limit:8,modelSlug:p});return e.jsx(U.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:B("hidden min-h-[108px] max-w-full",c?"@lg/thread:block":"lg:block",a&&o?"":"h-[70px]"),children:l&&u&&e.jsx(ji,{starterPrompts:u,onSelectStarterPrompt:g,disabled:i,clientThreadId:s,onExpand:()=>r(!0)})})},pp=ve({moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"}}),ra=Dn.div`m-8 flex flex-col items-center`;function la(t){return e.jsx(U.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0,transition:{duration:.5,ease:"easeIn"}},...t})}function gp({clientThreadId:t}){const n=ce(t,o=>o?.promptGptRating)?.gizmoId,{data:a}=ja(n);return n==null||a==null||!Dl(a)?null:e.jsx(hp,{gizmoId:n})}function hp({gizmoId:t}){const[s,n]=m.useState(!1),[a,o]=m.useState(!1),r=Ll(t),c=async d=>{n(!0),setTimeout(()=>{o(!0)},5e3),w.logEvent(D.submitInlineRating,{gizmo_id:t,rating:d}),await r.mutateAsync({rating:d})},i=async()=>{o(!0),w.logEvent(D.dismissInlineRating,{gizmo_id:t}),await r.mutateAsync({})};return m.useEffect(()=>{a||w.logEvent(D.showInlineRating,{gizmo_id:t})},[a,t]),a?null:s?e.jsx(ra,{children:e.jsxs(la,{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"rounded-lg border border-token-border-heavy p-4",children:e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(P,{id:"gizmo.inlineReview.reviewLeft",defaultMessage:"Feedback sent"}),e.jsx(ta,{onClick:()=>{o(!0)}})]})}),e.jsx("div",{className:"text-xs text-token-text-tertiary",children:e.jsx(P,{id:"gizmo.inlineReview.reviewLeftSubtext",defaultMessage:'To update your rating, click "Send Feedback" in the GPT Menu'})})]})}):e.jsx(ra,{children:e.jsxs(la,{className:"flex flex-col items-center gap-4 rounded-lg border border-token-border-heavy p-4",children:[e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(P,{id:"gizmo.inlineReview.prompt",defaultMessage:"How would you rate this GPT so far?"}),e.jsx(ta,{onClick:i})]}),e.jsx(Fl,{rating:void 0,onRating:c})]})})}const ki=Dn.div`group flex h-10 items-center gap-2 rounded-lg px-2 hover:bg-token-main-surface-secondary text-sm text-token-text-primary`;function fp(){const{data:t,isLoading:s}=zl({cutId:"recent",limit:8}),{data:n,isLoading:a}=Wl();return{isLoading:s||a,recent:t,pinned:n}}function xp({query:t,onSelectGizmo:s,selectedIdx:n},a){const o=Hl(),r=m.useRef([]),{isLoading:c,recent:i,pinned:d}=fp();m.useImperativeHandle(a,()=>({handleEnterOnIndex:l=>{if(!u[l])return l<p.length?p[l].resource:"create"},getResultsLength:()=>p.length+1,scrollToItem:l=>{const g=r.current[l];g&&g.scrollIntoView({behavior:"instant",block:"nearest"})}}));let p=[];if(c)return e.jsx("div",{className:"absolute right-4 top-0 flex h-full items-center justify-center",children:e.jsx(Xa,{})});i&&p.push(...i.pages.flatMap(l=>l.list.items).map(l=>({resource:l.resource,from:"recent"}))),d&&p.push(...d.items.map(l=>({resource:l,from:"pinned"}))),p=Ol(p,l=>l.resource.gizmo.id);const u=p.map(l=>l.resource.gizmo.tags?.includes(vs.WorkspaceDisabled));return t&&t!==""&&(p=p.filter(l=>(l.resource.gizmo.display.name.toLowerCase()+l.resource.gizmo.display.description?.toLowerCase()+l.resource.gizmo.author.display_name?.toLowerCase()).includes(t?.toLowerCase()))),e.jsxs("div",{className:"max-h-40 overflow-y-auto",children:[p.map((l,g)=>e.jsx("div",{ref:f=>{r.current[g]=f},tabIndex:g,onClick:()=>{u[g]||s(l.resource)},children:e.jsx(yp,{gizmoResource:l.resource,from:l.from,showDescription:o,isSelected:n===g,grayedOut:u[g]})},l.resource.gizmo.id)),e.jsx("div",{ref:l=>{r.current[p.length]=l},tabIndex:p.length,onClick:()=>{s("create")},children:e.jsx(Sp,{isSelected:n===p.length})},"create")]})}const bp=m.forwardRef(xp),Sp=({isSelected:t})=>e.jsx(ki,{className:t?"bg-token-main-surface-secondary":"",children:e.jsxs(Ur,{to:"/gpts/editor",target:"_blank",className:"flex flex-row space-x-2 font-semibold",children:[e.jsx("span",{className:"self-center",children:e.jsx(ka,{className:"icon-sm"})}),e.jsx("span",{children:e.jsx(P,{...wi.dropdownCreateLabel})})]})}),vp=({onClick:t,onClose:s})=>{const[n,a]=m.useState(null),o=m.useRef(null),r=m.useRef(null),[c,i]=m.useState(0),d=V(),p=u=>{w.logEvent(D.mentionsClickGizmo,{gizmo_id:u==="create"?"create":u.gizmo.id}),u!=="create"&&t(u)};return e.jsxs(e.Fragment,{children:[e.jsx("input",{autoFocus:!0,placeholder:d.formatMessage(wi.searchPlaceholder),ref:o,onKeyDown:u=>{if(u.nativeEvent.isComposing)return;const l=r.current?.getResultsLength()??0;if((u.key==="Escape"||u.key==="Backspace"&&!n)&&(u.preventDefault(),s()),u.key==="Enter"||u.key==="Tab"){u.preventDefault();const g=r.current?.handleEnterOnIndex(c);if(!g)return;g==="create"?(window.open("/gpts/editor","_blank"),s()):p(g)}if(u.key==="ArrowDown"&&c<l-1){u.preventDefault();const g=c+1;r.current?.scrollToItem(g),i(g)}if(u.key==="ArrowUp"&&c>0){u.preventDefault();const g=c-1;r.current?.scrollToItem(g),i(g)}},onChange:u=>{a(u.target.value),i(0)},className:"w-full border-0 bg-token-main-surface-primary p-2 text-sm focus:outline-none"}),e.jsx(bp,{ref:r,query:n,selectedIdx:c,onSelectGizmo:p})]})},ca=({onClick:t,onClose:s})=>{const n=Qa(),a=!!n;return pn(()=>{w.logEvent(D.mentionsOpened,{gizmo_selector_disabled:a})}),a?e.jsx(bi,{clientThreadId:sn,rateLimitInfo:n}):e.jsx("div",{onBlur:o=>{o.currentTarget.contains(o.relatedTarget)||s()},className:"popover rounded-2xl border border-token-border-light bg-token-main-surface-primary p-2 shadow-lg",children:e.jsx(vp,{onClick:t,onClose:s})})};function yp({gizmoResource:t,from:s,showDescription:n,isSelected:a,grayedOut:o}){const r=!!t.gizmo.tags?.includes(vs.FirstParty);return e.jsxs(ki,{className:B(a?"bg-token-main-surface-secondary":"",o&&"opacity-50"),children:[e.jsx(di,{isFirstParty:r,src:t.gizmo.display.profile_picture_url,className:B("icon-xl h-7 w-7 flex-shrink-0",o&&"grayscale group-hover:grayscale-0")}),e.jsxs("div",{className:"flex h-fit grow flex-row justify-between space-x-2 overflow-hidden text-ellipsis whitespace-nowrap",children:[e.jsxs("div",{className:"flex flex-row space-x-2",children:[e.jsx("span",{className:"shrink-0 truncate font-semibold",children:t.gizmo.display.name}),n&&e.jsx("span",{className:"flex-grow truncate text-sm text-token-text-tertiary sm:max-w-xs lg:max-w-md",children:t.gizmo.display.description})]}),e.jsx("span",{className:"shrink-0 self-center",children:s==="recent"?e.jsx(Ul,{className:"icon-sm"}):e.jsx(Gl,{className:"icon-sm"})})]})]})}const wi=ve({talkingTo:{id:"TaggingDropdown.talkingTo",defaultMessage:"Talking to"},dropdownCreateLabel:{id:"TaggingDropdown.dropdownCreateLabel",defaultMessage:"Create a GPT"},searchPlaceholder:{id:"TaggingDropdown.searchPlaceholder",defaultMessage:"Search recent and pinned GPTs"}});function Cp(){const{value:t}=Ae("1166240779");return t}function ft(t){const n=On().has(R.Research),a=Cp();return ce(t,r=>{if(!n||!a)return{state:"disabled",shouldShowResearchText:!1};const c=Q.getConversationTurns(r),i=c.filter(l=>l.role===Ln.User),d=Td(i);let p=0;for(let l=i.length-1;l>=0&&i[l].messages.some(f=>f.metadata?.system_hints?.includes(R.Research));l--)p++;const u=i.some(l=>l.messages.some(g=>g.metadata?.system_hints?.includes(R.Research)));if(c.length===0||!u)return{state:"initial",shouldShowResearchText:!0};if(d?.messages.some(l=>l.metadata?.system_hints?.includes(R.Research))){const l=c.findIndex(f=>f===d);return c.filter((f,h)=>h>l&&f.messages.some(x=>x.metadata?.b1de6e2_rm)).length>0?{state:"recurrent",shouldShowResearchText:!0}:p%2===0?{state:"running",shouldShowResearchText:!1}:{state:"clarify",shouldShowResearchText:!1}}return{state:"recurrent",shouldShowResearchText:!0}})}const jp=350;function kp({suggestionData:t,visualTreatment:s,composerController:n,clientThreadId:a}){const o=V(),{state:r}=ft(a),i=o.formatMessage(Z.researchSuggestionInitial),d=o.formatMessage(Z.deepResearchPlaceholderBullet1),p=o.formatMessage(Z.deepResearchPlaceholderBullet2),u=o.formatMessage(Z.deepResearchPlaceholderBullet3),{displayedText:l,isStreaming:g}=ss(i,{enableStreaming:r!=="disabled"},[n.isEmpty()]),f=jp,{displayedText:h,isStreaming:x}=ss(d,{startDelay:f,enableStreaming:r!=="disabled"}),{displayedText:k,isStreaming:y}=ss(p,{enableStreaming:!x&&r!=="disabled"}),{displayedText:C}=ss(u,{enableStreaming:!x&&!y&&r!=="disabled"});return e.jsx("div",{className:B("mb-[8px] mt-[-8px] flex select-none items-start justify-between text-token-text-tertiary",s==="legacy"&&"pl-1"),children:n.isEmpty()?e.jsxs("ul",{className:"list-disc pl-5 text-token-text-tertiary marker:text-token-text-tertiary",children:[h&&e.jsx("li",{children:h}),k&&e.jsx("li",{children:k}),C&&e.jsx("li",{children:C})]}):e.jsx("div",{className:B("relative flex items-center",n.hasMultipleLines()&&"pt-2"),children:e.jsx("div",{className:B(g&&"result-streaming",t?.isLoading&&"pulse","text-token-text-tertiary"),children:e.jsx("p",{children:l})})})})}const ln={type:"spring",stiffness:48.7,damping:13.54,mass:1};function _i({enabled:t,children:s,...n}){const a=ys();return e.jsxs(U.div,{initial:{minHeight:0},animate:{minHeight:t?"142px":0},exit:{minHeight:0},transition:a?Te:ln,className:"flex flex-col justify-start",children:[s,t&&e.jsx(kp,{...n})]})}function Ai(t){const s=ft(t),n=Ae("3544641259")?.value;return s.state!=="disabled"&&n}function Mi(t){const s=Ae("3544641259")?.value,n=ce(t,r=>r?.selectedSources??[Ue.Web]),a=m.useMemo(()=>new Set(n),[n]),o=m.useCallback(r=>{t&&Rd(t,c=>{const i=c.selectedSources??new Set([Ue.Web]);i.has(r)?(i.delete(r),c.selectedSources=i):(i.add(r),c.selectedSources=i)})},[t]);return s?{selectedSources:a,toggleSource:o}:{selectedSources:void 0,toggleSource:()=>{}}}function Xs({label:t,selected:s,onClick:n,Icon:a,isVanguard:o,iconColor:r}){return e.jsxs("button",{type:"button","aria-pressed":s,onClick:c=>{c.stopPropagation(),c.preventDefault(),n()},className:B("flex min-h-8 items-center gap-1 rounded-full px-2 py-1 text-sm font-medium transition-colors focus:outline-none",s?"border border-token-border-light bg-token-main-surface-primary":o?"text-token-text-secondary":"text-token-text-tertiary",o?"":"border border-token-border-light"),children:[e.jsx(a,{"aria-hidden":!0,className:B("h-4 w-4 transition-colors",s?"bg-token-main-surface-primary":"grayscale filter",r||"text-token-text-primary")}),e.jsxs("span",{children:[t," "]}),s&&e.jsx(Za,{className:"h-4 w-4 text-token-text-tertiary"})]})}const Pi=({clientThreadId:t,isVanguard:s=!1})=>{const{selectedSources:n,toggleSource:a}=Mi(t),{connectorConfig:o}=Vl(),r=!!o.get(Se.GDRIVE_ACTION_CONNECTOR)?.access_token,c=ys(),i=!!o.get(Se.GITHUB_CONNECTOR)?.access_token,d=()=>{window.location.assign("#settings/ConnectorSettings")};if(!t||!n)return null;const l={initial:{opacity:0,height:0,y:"-28px"},animate:{opacity:1,y:0,height:"56px",transition:c?Te:{opacity:{delay:.2},default:ln}},exit:{opacity:0,y:"-28px",height:0,transition:c?Te:{opacity:{delay:0},default:ln}}};return e.jsxs(U.div,{variants:l,initial:"initial",animate:"animate",exit:"exit",className:"relative w-full",children:[e.jsx("div",{className:"absolute inset-x-[15px] top-0 h-0 border-t border-token-border-xlight"}),e.jsx("div",{className:B("z-0 w-full p-3","bg-token-main-surface-primary dark:bg-[#303030]"),children:e.jsxs("div",{className:"flex items-center gap-4",children:[!s&&e.jsx("span",{className:"text-sm font-medium text-token-text-primary",children:e.jsx(P,{id:"dyMo44",defaultMessage:"Sources"})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(Xs,{label:e.jsx(P,{id:"G03bJa",defaultMessage:"Web"}),selected:n.has(Ue.Web),onClick:()=>a(Ue.Web),Icon:ql,iconColor:"text-blue-1000",isVanguard:s}),e.jsx(Xs,{label:e.jsx(P,{id:"XQpEHU",defaultMessage:"Github"}),selected:n.has(Ue.GitHub)&&i,onClick:()=>i?a(Ue.GitHub):d(),Icon:$l,isVanguard:s}),e.jsx(Xs,{label:e.jsx(P,{id:"m4j0Bv",defaultMessage:"Drive"}),selected:n.has(Ue.GoogleDrive)&&r,onClick:()=>r?a(Ue.GoogleDrive):d(),Icon:va,isVanguard:s})]})]})})]})},It=m.forwardRef(function({pressed:s,disabled:n,icon:a,label:o,ariaLabel:r,animatedLabel:c,showLabel:i,onClick:d,splitButtonDropdownContent:p,dropdownContent:u}){const[l,g]=m.useState(!1),f=ba(),h=!n&&s,x=o&&e.jsx("div",{className:"whitespace-nowrap pl-1 pr-1 [display:--force-hide-label]",children:o}),k=e.jsxs("button",{className:B("flex h-full min-w-8 items-center justify-center p-2",{"pr-1.5":!!p}),"aria-pressed":s,"aria-label":r,disabled:n,onTransitionEnd:()=>g(!1),onClick:_=>{u||(g(!0),d(_))},children:[a,!c&&i?x:null,c&&e.jsx(fe,{initial:!1,children:i&&e.jsx(U.span,{initial:{x:-10,width:0,opacity:0},animate:{x:0,width:"fit-content",opacity:1},exit:{x:-10,width:0,opacity:0},transition:{ease:"easeOut",duration:f?0:.15},children:x})})]}),y=p||u?e.jsx(e.Fragment,{children:e.jsx(js,{children:e.jsx(ei,{className:"p-0",$as:ks,side:"bottom",align:"start",collisionPadding:10,sideOffset:8,children:u??p})})}):null,C=e.jsxs("div",{className:B("inline-flex h-9 rounded-full border text-[13px] font-medium radix-state-open:bg-black/10",{"duration-75 motion-safe:transition-all":l,"text-token-text-secondary":!s,"border-transparent bg-[#DAEEFF] text-blue-1000 can-hover:hover:bg-[#BDDCF4] dark:bg-[#2A4A6D] dark:text-[#48AAFF] dark:can-hover:hover:bg-[#1A416A]":!!h,"border-token-border-light focus-visible:outline-black can-hover:hover:bg-token-main-surface-secondary dark:focus-visible:outline-white dark:can-hover:hover:bg-gray-700":!h,"opacity-30":n}),children:[u?e.jsx(mt,{asChild:!0,children:k}):k,!u&&p?e.jsx(mt,{asChild:!0,children:e.jsx("button",{className:"border-l border-token-border-light p-2",style:{borderColor:h?"#0285FF0D":void 0},disabled:n,children:e.jsx(wa,{className:"h-[18px] w-[18px]"})})}):null]});return p||u?e.jsxs(Cs,{children:[e.jsx(hn,{asChild:!0,children:C}),y]}):C}),wp={p:t=>{const{node:s,children:n,...a}=t;return e.jsx("p",{...a,className:"text-start !text-sm !leading-6 text-white",children:n})},a:t=>{const{node:s,children:n,...a}=t;return e.jsx("a",{...a,className:"!text-sm !leading-6 !text-white !underline",children:n})}};function _p(t){const s=fn(),n=me(t);return!n.isLoading&&n.eligible&&!s}function Ap(t,s){const n=Yl(),a=Kl(),o=Rt(s);return _p(t)&&!n&&!o&&!a}function Mp(t,s){const n=me(t.announcementKey);return e.jsx(ws,{announcementKey:t.announcementKey,side:"top",show:!0,theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:t.nuxTitle,onDismiss:n.markAsViewed,sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",description:e.jsx(Jl,{componentOverrides:wp,children:t.nuxDescription}),children:e.jsx("div",{children:s})})}var Je=(t=>(t.Hover="hover",t.Enable="enable",t.Disable="disable",t))(Je||{});const Ni=new Map([[R.Think,{hover:[D.composerThinkButtonHovered,"composer_think_button_hovered"],enable:[D.composerThinkButtonEnabled,"composer_think_button_enabled"],disable:[D.composerThinkButtonDisabled,"composer_think_button_disabled"]}],[R.Research,{hover:[D.composerResearchButtonHovered,"composer_research_button_hovered"],enable:[D.composerResearchButtonEnabled,"composer_research_button_enabled"],disable:[D.composerResearchButtonDisabled,"composer_research_button_disabled"]}]]);function Pp({systemHint:t,label:s,logo:n,isDisabled:a=!1,composerController:o,analyticsMetadata:r,onClick:c,showLabel:i=!1,splitButtonDropdownContent:d,dropdownContent:p}){const{name:u,systemHint:l}=t,g=l,{setThreadSystemHintMode:f,clearAllSystemHintModeTriggers:h}=We(),x=Rt(g),k=!!t.composerBarButtonInfo?.upsell,y=pt.useStore(),{value:C}=Ie("2454940646"),_=Bt(),E=[R.Search,R.Think].includes(g);m.useEffect(()=>{a&&_.has(g)&&f(g,!1,r)},[a,g,r,f,_,E]);const A=m.useCallback(H=>{H.stopPropagation(),H.preventDefault();let v=!0;C&&E&&(y.getState().persistedSystemHints.has(R.Search)||y.getState().persistedSystemHints.has(R.Think))&&(v=!1),v&&h(),f(g,!x,r),x||(o.removeSystemHints(),o.focus());const{enable:b,disable:F}=Ni.get(g)??{},[O,N]=(x?F:b)??[];O&&N&&w.logEventWithStatsig(O,N,r),c?.(H)},[r,C,h,o,g,E,x,c,f,y]),j=k?e.jsx("div",{className:"py-2",children:e.jsx(xn,{location:g,statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked",containerNoPadding:!0})}):null;return e.jsx(It,{pressed:x,disabled:a,icon:n,label:s,ariaLabel:u,animatedLabel:!i,showLabel:i||x,onClick:A,dropdownContent:p??j,splitButtonDropdownContent:d})}function Np({composerController:t,systemHint:s,composerBarButtonInfo:n,isDisabled:a,clientThreadId:o,showLabel:r,labelOverride:c,disabledReason:i,rateLimitProgress:d,dropdownContent:p,splitButtonDropdownContent:u,logoOverride:l}){const g={clientThreadId:o};return e.jsx(Ep,{composerBarButtonInfo:n,isDisabled:a,analyticsMetadata:g,systemHint:s.systemHint,disabledReason:i,rateLimitProgress:d,children:e.jsx(Pp,{isDisabled:a,systemHint:s,label:c??s.name,logo:l??e.jsx(Am,{svgString:s.logo,className:"h-[18px] w-[18px]"}),composerController:t,analyticsMetadata:g,showLabel:r,dropdownContent:p,splitButtonDropdownContent:u})})}function Ep({children:t,isDisabled:s,systemHint:n,composerBarButtonInfo:a,analyticsMetadata:o,disabledReason:r,rateLimitProgress:c}){const i=Ap(a.announcementKey,n),d=Mp(a,t),p=V();let u=null;return c&&c.remaining?u=e.jsx(Ei,{remaining:c.remaining,reset_date:c.reset_after,text:a.tooltipText}):a.tooltipText&&(u=e.jsx(zn,{text:a.tooltipText})),i?d:e.jsx("div",{children:e.jsx(ze,{sideOffset:0,label:s?r===et.HasAttachedFiles?p.formatMessage({id:"hhxO6y",defaultMessage:"Reason disabled for attachments"}):r===et.DeepResearchHighLoad?p.formatMessage({id:"UrDtrS",defaultMessage:"Deep research is temporarily unavailable"}):r===et.RateLimitReached?a.rateLimitReachedText:a.disabledText:u,side:"bottom",onOpenChange:l=>{if(l){const{hover:g}=Ni.get(n)??{},[f,h]=g??[];f&&h&&w.logEventWithStatsig(f,h,o)}},children:t})})}const zn=({text:t})=>e.jsx("span",{children:t}),Ei=({remaining:t,reset_date:s,text:n})=>{const{locale:a}=V(),o=Tm(s,a);return e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"block text-xs font-semibold text-token-text-tertiary",children:e.jsx(P,{id:"PromptTextarea.systemHintTooltip.remaining",defaultMessage:"{remaining} available until {resetDate}",values:{remaining:t,resetDate:o}})}),e.jsx(zn,{text:n})]})},Tp=()=>Bd().find(t=>t.feature_name===Em(R.Research))??null;function Rp({clientThreadId:t,showLabel:s=!1,isDisabled:n}){const a=Xl(t),o=_s(),r=Rt(R.Research),{setThreadSystemHintMode:c,clearAllSystemHintModeTriggers:i}=We(),d=!!ti(),{value:p}=Ae("1416952492"),u=p?et.DeepResearchHighLoad:d?et.RateLimitReached:void 0;return a?e.jsx("div",{style:{viewTransitionName:`var(--vt-composer-${R.Research}-action)`},children:e.jsx(Bp,{composerController:o,isThreadInSystemHintMode:r,setThreadSystemHintMode:c,clearAllSystemHintModeTriggers:i,clientThreadId:t,showLabel:s,isDisabled:n||!!u,disabledReason:u})},`system-hint-${R.Research}`):null}function Bp({composerController:t,isThreadInSystemHintMode:s,setThreadSystemHintMode:n,clearAllSystemHintModeTriggers:a,clientThreadId:o,showLabel:r=!1,isDisabled:c=!1,disabledReason:i}){const d=V(),p={clientThreadId:o},u=d.formatMessage({id:"ORxecl",defaultMessage:"Deep research"}),l=f=>{f===Je.Hover?w.logEventWithStatsig(D.composerResearchButtonHovered,"composer_research_button_hovered",p):f===Je.Enable?w.logEventWithStatsig(D.composerResearchButtonEnabled,"composer_research_button_enabled",p):f===Je.Disable&&w.logEventWithStatsig(D.composerResearchButtonDisabled,"composer_research_button_disabled",p)},g=f=>{f.stopPropagation(),f.preventDefault(),a(),n(R.Research,!s,p),s||(t.removeSystemHints(),t.focus()),l(s?Je.Disable:Je.Enable)};return e.jsx(Ip,{disabledReason:i,isDisabled:c,logEvent:l,children:e.jsx(It,{pressed:s,disabled:c,icon:e.jsx(Ql,{className:"h-[18px] w-[18px]"}),label:u,animatedLabel:!r,showLabel:r||s,onClick:g,ariaLabel:u})})}function Ip({children:t,isDisabled:s,disabledReason:n,logEvent:a}){const o=V(),r=ti(),c=Tp(),i=o.formatMessage({id:"LtcsGJ",defaultMessage:"Get detailed insights on any topic"});let d=null;c&&c.remaining?d=e.jsx(Ei,{remaining:c.remaining,reset_date:c.reset_after,text:i}):d=e.jsx(zn,{text:i});const p=n===et.DeepResearchHighLoad?o.formatMessage({id:"UrDtrS",defaultMessage:"Deep research is temporarily unavailable"}):n===et.RateLimitReached&&r?o.formatMessage({id:"T3aUKM",defaultMessage:"More available {time}"},{time:r.resets_after_text}):void 0;return e.jsx("div",{children:e.jsx(ze,{sideOffset:0,label:s?p:d,side:"bottom",onOpenChange:u=>{u&&a(Je.Hover)},children:t})})}function Dp({clientThreadId:t,gizmoId:s,composerController:n,isDisabled:a}){const o=tt(),{value:r,isLoading:c}=Ie("3780975974"),{layer:i}=_t("2149763392");let d=gt(t);const p=bn(s),u=i.get("show-in-main-composer",!1),l=o?.isFree(),g=d==null||d?.kind===Me.PrimaryAssistant||d?.kind===Me.GizmoInteraction&&p,{isUnauthenticated:f}=ye();return(f||l)&&(f||r||c)&&g&&!u?e.jsx("div",{style:{viewTransitionName:`var(--vt-composer-${R.Think}-action)`},children:e.jsx(Lp,{clientThreadId:t,composerController:n,isDisabled:a})},`system-hint-${R.Think}`):null}function Lp({clientThreadId:t,composerController:s,isDisabled:n}){const a=V(),o=!!Id();n=n||o;const r=a.formatMessage({id:"T+qu+0",defaultMessage:"Reason"}),{setThreadSystemHintMode:c,clearAllSystemHintModeTriggers:i}=We(),d=Rt(R.Think),p=pt.useStore(),u=Bt(),{isUnauthenticated:l}=ye();m.useEffect(()=>{n&&u.has(R.Think)&&c(R.Think,!1,{clientThreadId:t})},[n,u,c,t]);const g=x=>{if(x.stopPropagation(),x.preventDefault(),l)return;let k=!0;p.getState().persistedSystemHints.has(R.Search)&&(k=!1),k&&i(),c(R.Think,!d,{clientThreadId:t}),d||(s.removeSystemHints(),s.focus()),d?w.logEventWithStatsig(D.composerThinkButtonDisabled,"composer_think_button_disabled",{clientThreadId:t}):w.logEventWithStatsig(D.composerThinkButtonEnabled,"composer_think_button_enabled",{clientThreadId:t})},f=l?e.jsx(xn,{location:R.Think,statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked",containerNoPadding:!0}):void 0,h=e.jsx(It,{pressed:d,disabled:n,icon:e.jsx(Zl,{className:"h-[18px] w-[18px]"}),label:r,ariaLabel:r,animatedLabel:!0,showLabel:!0,onClick:g,dropdownContent:f});return e.jsx(ze,{sideOffset:0,label:n?a.formatMessage({id:"Z1UTb8",defaultMessage:"Reason is unavailable"}):a.formatMessage({id:"JoBzEW",defaultMessage:"Think before responding"}),side:"bottom",onOpenChange:x=>{x&&w.logEventWithStatsig(D.composerThinkButtonHovered,"composer_think_button_hovered",{clientThreadId:t})},children:h})}const Fp=["o1","o1-pro","gpt-4"];function Hp({account:t,clientBootstrapFlags:s,features:n,clientThreadId:a,currentModelConfig:o,composerController:r,isDisabled:c,gizmoId:i,hasFiles:d}){const{prospectiveModelId:p}=Et(a);let u=gt(a);const l=bn(i),{userIsInSearchHoldoutWithWebDisabled:g}=li(),f=o?.enabledTools?.includes(Fn.Search),h=u==null||u?.kind===Me.PrimaryAssistant||u?.kind===Me.GizmoInteraction&&l,{isUnauthenticated:x}=ye();return x&&s?.includes(fs.AnonSearchHoldout)||!x&&(t==null||t.isFree())&&(s?.includes(fs.FreeSearchHoldout)||g)||!x&&(t==null||t.isEnterprisey())&&!n?.includes(Dd.BrowsingAvailable)||!h?null:e.jsx("div",{style:{viewTransitionName:`var(--vt-composer-${R.Search}-action)`},children:e.jsx(Op,{clientThreadId:a,composerController:r,modelSupportsSearch:f??(x||t?.isFree()||!!p&&!Fp.includes(p)),isDisabled:c,disabledReason:f?d?us.HasAttachedFiles:void 0:us.ModelNotSupported,currentModelName:o?.title??""})},`system-hint-${R.Search}`)}function Op({clientThreadId:t,composerController:s,isDisabled:n,disabledReason:a,currentModelName:o,modelSupportsSearch:r}){const c=V(),i=Sm(),d=c.formatMessage({id:"TbHx8d",defaultMessage:"Search"}),{setThreadSystemHintMode:p,clearAllSystemHintModeTriggers:u}=We(),l=pt.useStore(),g=Bt();n=n||!r,m.useEffect(()=>{n&&g.has(R.Search)&&p(R.Search,!1,{clientThreadId:t})},[n,g,p,t]);const f=h=>{h.stopPropagation(),h.preventDefault();let x=!0;l.getState().persistedSystemHints.has(R.Think)&&(x=!1),x&&u(),p(R.Search,!i,{clientThreadId:t}),i||(s.removeSystemHints(),s.focus()),w.logEventWithStatsig(D.composerSearchButtonClicked,"composer_search_button_clicked",{clientThreadId:t}),i&&s.trimLeadingText(/^search\b/i)};return e.jsx(Gp,{analyticsMetadata:{clientThreadId:t},isThreadUsingSearchMode:i,isDisabled:n,disabledReason:a,currentModelName:o,children:e.jsx(It,{pressed:i,disabled:n??!1,icon:e.jsx(ec,{className:"h-[18px] w-[18px]"}),label:d,ariaLabel:d,animatedLabel:!0,showLabel:!0,onClick:f})})}function Up(){const t=yi(),s=fn(),n=me(le.hasSeenComposerSearchButtonTooltip);return!n.isLoading&&n.eligible&&!t&&!s}function Gp({children:t,analyticsMetadata:s,isThreadUsingSearchMode:n,isDisabled:a,disabledReason:o,currentModelName:r}){const c=Up()&&!n,i=me(le.hasSeenComposerSearchButtonTooltip);return c?e.jsx(ws,{announcementKey:le.hasSeenComposerSearchButtonTooltip,side:"right",show:!0,theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:e.jsx(P,{id:"Yjduqi",defaultMessage:"Search the web"}),onDismiss:i.markAsViewed,sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",description:e.jsx(P,{id:"W51Aei",defaultMessage:"Get fast answers with trusted sources. {learnMore}",values:{learnMore:e.jsx(tc,{href:"https://openai.com/index/introducing-chatgpt-search",className:"underline",children:e.jsx(P,{id:"stA7F4",defaultMessage:"Learn more"})})}}),children:e.jsx("div",{children:t})}):e.jsx("div",{children:e.jsx(ze,{sideOffset:0,label:a?o===us.ModelNotSupported?e.jsx(P,{id:"GZemJe",defaultMessage:"Search disabled for {modelName}",values:{modelName:`${r}`}}):o===us.HasAttachedFiles?e.jsx(P,{id:"Wd1fc2",defaultMessage:"Search disabled for attachments"}):e.jsx(P,{id:"GpDAWD",defaultMessage:"Search is unavailable"}):e.jsx(P,{id:"c+4o2s",defaultMessage:"Search the web"}),side:"bottom",onOpenChange:d=>{d&&w.logEventWithStatsig(D.composerSearchButtonHovered,"composer_search_button_hovered",s)},children:t})})}const zp=1;function Ti({value:t=zp,size:s,onStateChange:n}){return e.jsx("div",{className:"relative flex h-full w-full flex-col items-center justify-center",children:e.jsxs(U.div,{animate:{translateY:t>1&&s==="small"?-1:0},onAnimationStart:()=>n?.("animating"),onAnimationComplete:()=>n?.("idle"),className:B("relative",s==="small"?"h-5 w-5":"h-8 w-8"),children:[e.jsx(U.div,{style:{transformOrigin:"50% 100%",translateY:s==="large"?3:0},animate:{scale:t>1&&s==="small"?.85:1},className:"absolute left-0 top-0",children:e.jsx(sc,{className:B(s==="small"?"h-5 w-5":"h-8 w-8")})}),e.jsx(U.div,{initial:{scale:s==="small"?.9:1.1,opacity:0},animate:{scale:s==="large"?1.1:t>1?1:.9,opacity:t>1?1:0},style:{translateY:s==="large"?-1:0},className:"absolute left-0 top-0",children:e.jsx(nc,{className:B(s==="small"?"h-5 w-5":"h-8 w-8")})}),e.jsx(U.div,{initial:{scale:s==="small"?.9:1.1,opacity:0},animate:{scale:s==="large"?1.1:t>2?1:.9,opacity:t>2?1:0},style:{translateY:s==="large"?-1:0},className:"absolute left-0 top-0",children:e.jsx(oc,{className:B(s==="small"?"h-5 w-5":"h-8 w-8")})})]})})}function Wp(t){const{reasoningLevelTypes:s,reasoningLevelType:n}=t,{ReasoningLevels:a}=s;let o=1;return n===a.medium.type?o=2:n===a.high.type&&(o=3),e.jsx("div",{className:B("relative flex h-5 w-5 items-center justify-center",o>1&&"text-blue-1000"),children:e.jsx(Ti,{size:"small",value:o})})}const Vp=({isManualModelSelection:t,animatedLabel:s,reasoningLevelTypes:n,reasoningLevelType:a,modelName:o,onResetReasoningLevel:r,type:c})=>{const[i,d]=m.useState(!1),p=ba(),{reasoningLevel:u}=ac({reasoningLevelTypes:n,reasoningLevelType:a}),l=a!=="low"||t||!1;return e.jsxs("div",{className:B("inline-flex h-9 rounded-full border text-[13px] font-medium radix-state-open:bg-black/10",l?"border-transparent bg-[#DAEEFF] text-blue-1000 can-hover:hover:bg-[#BDDCF4] dark:bg-[#2A4A6D] dark:text-[#48AAFF] dark:can-hover:hover:bg-[#1A416A]":"border-token-border-light text-token-text-secondary focus-visible:outline-black can-hover:hover:bg-token-main-surface-secondary dark:focus-visible:outline-white dark:can-hover:hover:bg-gray-700",i&&"duration-75 motion-safe:transition-all"),children:[e.jsxs("div",{className:"flex h-full min-w-8 items-center justify-center p-2","aria-pressed":l,onTransitionEnd:()=>d(!1),children:[e.jsx(Wp,{reasoningLevelTypes:n,reasoningLevelType:a}),s&&e.jsx(fe,{initial:!1,children:e.jsx(U.span,{initial:{x:-10,width:0,opacity:0},animate:{x:0,width:"fit-content",opacity:1},exit:{x:-10,width:0,opacity:0},transition:{ease:"easeOut",duration:p?0:.15},children:e.jsx("div",{className:"whitespace-nowrap pl-1 pr-1 [display:--force-hide-label]",children:t?o:u?.shortLabel})})})]}),l?e.jsx("div",{className:"border-l border-token-border-light p-2",style:{borderColor:l?"#0285FF0D":void 0},onClick:g=>{g.stopPropagation(),g.preventDefault(),r()},children:e.jsx(Za,{"aria-label":"",className:"h-[16px] w-[16px]"})}):c==="think"?e.jsx("div",{className:"border-l border-token-border-light p-2",style:{borderColor:l?"#0285FF0D":void 0},children:e.jsx(wa,{className:"h-[18px] w-[18px]"})}):null]})},cn=({children:t,origin:s,...n})=>{const a=ys(),{isOpen:o,closePopover:r,layoutMode:c,popoverContentRef:i}=Sn();return m.useEffect(()=>{if(o)return ic(r,i)},[o,i,r]),e.jsx(js,{forceMount:!0,children:e.jsx(ks,{forceMount:!0,asChild:!0,align:"center",sideOffset:-35,onEscapeKeyDown:r,onClick:d=>{d.stopPropagation(),d.preventDefault()},onOpenAutoFocus:d=>{d.preventDefault()},...n,children:e.jsx("div",{ref:i,className:B(!o&&"pointer-events-none"),children:e.jsx(fe,{mode:c==="centered"?"popLayout":"sync",children:o&&e.jsx(U.div,{className:B("flex overflow-clip rounded-2xl border border-token-border-xlight bg-token-main-surface-primary shadow-2xl backdrop-blur-2xl dark:border-white/5 dark:bg-token-main-surface-secondary dark:shadow-[0px_24px_64px_rgba(0,0,0,0.32)]"),variants:{open:{scale:[.7,1],opacity:1,transition:a?Te:ds},closed:{opacity:0,scale:.8,transition:a?Te:{...ds,duration:.2}}},initial:"closed",animate:"open",exit:"closed",style:{transformOrigin:s||(c==="centered"?"top left":"bottom left")},children:t})})})})})},qp=({as:t="div",children:s,className:n,isSelected:a=!1,shape:o="rectangle",spacing:r="normal",...c})=>{const i=t==="div"?U.div:U.button;return e.jsx(i,{className:B("relative -ml-1 flex min-h-8 cursor-pointer select-none flex-row items-center justify-center gap-1 whitespace-nowrap rounded-3xl border border-transparent py-1 font-medium *:pointer-events-none","hover:border-black/0 can-hover:hover:bg-black/5 motion-safe:transition-colors dark:can-hover:hover:bg-white/5","[font-size:var(--pill-font-size,14px)]",r==="compact"&&o==="round"&&"px-2",r==="compact"&&o==="rectangle"&&"px-2.5",r==="normal"&&o==="rectangle"&&"px-3.5",a?"bg-black/[0.045] can-hover:hover:!bg-black/[0.075] dark:bg-white/5 dark:text-token-composer-blue-text dark:can-hover:hover:!bg-white/10":"[color:var(--pill-color,var(--text-secondary))] hover:border-black/0 can-hover:hover:bg-black/5 motion-safe:transition-colors dark:can-hover:hover:bg-white/5",n),...c,children:s})},Ri=({children:t,className:s,isSelected:n=!1,onClick:a,...o})=>{const{isOpen:r,openPopover:c,popoverTriggerRef:i}=Sn(),d=m.useCallback(u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),c())},[c]),p=m.useCallback(u=>{a?.(u),!u.defaultPrevented&&c()},[a,c]);return e.jsx(mt,{asChild:!0,children:e.jsx(qp,{animate:r?"inactive":"active",as:"div",role:"button",className:B("group motion-safe:[transition:border-color_0.1s_ease-in-out]",s),isSelected:n,"data-reasoning-popover-action":!0,onClick:p,onKeyDown:d,ref:i,tabIndex:0,...o,children:t})})};function $p(t=!1){const[s,n]=m.useState(t),[a,o]=m.useState(!1);return{isOpen:s,isStartingToOpen:a,setIsOpen:n,setIsStartingToOpen:o}}function ut({layoutMode:t,initialOpen:s=!1,forceOpen:n=!1,restoreFocus:a,children:o,onClose:r}){const{isOpen:c,isStartingToOpen:i,setIsOpen:d,setIsStartingToOpen:p}=$p(s||n),u=n||c,l=m.useRef(null),g=m.useRef(null),f=m.useCallback(()=>{u||(d(!0),rc(),requestAnimationFrame(()=>{p(!0),lc({root:l.current,autoFocus:!0})}))},[d,p,u]),h=m.useCallback(()=>{!i&&!u||(d(!1),p(!1),requestAnimationFrame(()=>{const y=new Event("focus");a?.(y),y.defaultPrevented||g.current?.focus()}),r?.())},[r,d,p,i,u,a]),x=y=>{y?f():h()},k={Trigger:{type:mt,instance:null},Content:{type:cn,instance:null}};return m.Children.forEach(o,y=>{if(m.isValidElement(y))if(y.type===Ri||y.type===mt){if(k.Trigger.instance)throw new Error("Only one trigger is allowed");k.Trigger.instance=y}else y.type===cn&&(k.Content.instance=y)}),e.jsx(cc,{value:{closePopover:h,isOpen:u,isStartingToOpen:i,layoutMode:t,openPopover:f,popoverContentRef:l,popoverTriggerRef:g},children:e.jsxs(Cs,{open:u,onOpenChange:x,children:[k.Trigger.instance,k.Content.instance]})})}ut.BaseTrigger=mt;ut.Trigger=Ri;ut.Content=cn;const Yp={modelPickerOpen:{maxHeight:375,width:300},modelPickerClosed:{maxHeight:245,width:245}},Kp=({clientThreadId:t,reasoningLevelTypes:s,reasoningLevelType:n,onReasoningLevelChanged:a,shouldShowModelPicker:o,isManualModelSelection:r,currentModelId:c,onModelSelection:i,resetReasoningLevel:d})=>{const p=V(),{isStartingToOpen:u,layoutMode:l,closePopover:g}=Sn(),{reasoningLevelList:f,reasoningLevelsByValue:h}=s,x=f.find(v=>v.type===n),k=m.useRef(!1),y=m.useRef(!1),C=m.useRef(null),_=m.useRef(!1),E=m.useRef(!1),[A,j]=m.useState(r),I=wt(v=>v.threads[t]?.isManualModelSelection),H=e.jsxs("button",{onClick:v=>{v.preventDefault(),j(!A),I&&d()},className:"mt-2 flex cursor-pointer items-center gap-0.5 rounded-lg py-1.5 pl-3 pr-1.5 font-medium hover:bg-token-main-surface-tertiary",children:[e.jsx("div",{className:"text-xs text-token-text-secondary",id:"view-all-models-toggle",children:p.formatMessage({id:"Ds350e",defaultMessage:"Choose a model"})}),e.jsx(si,{className:"h-4 w-4 text-token-text-tertiary"})]});return e.jsxs(U.div,{className:B("max-h-[max(calc(var(--radix-popover-content-available-height)-64px), 245px)] flex snap-y snap-proximity overflow-y-auto scroll-smooth [scrollbar-gutter:stable]",l==="centered"&&"origin-center flex-col",l==="bottom"&&"flex-col-reverse"),animate:A?"modelPickerOpen":"modelPickerClosed",transition:ls,variants:Yp,children:[!A&&e.jsxs(e.Fragment,{children:[e.jsxs(U.div,{initial:{scaleX:"80%"},animate:{scaleX:"100%"},exit:{scaleX:"80%"},transition:{type:"spring",visualDuration:.3,bounce:.45},className:B("relative mx-4 flex flex-col items-center rounded-3xl bg-token-border-xlight",l==="bottom"?"mb-4":"mt-4"),children:[e.jsx("datalist",{id:"juice-level-markers",className:"pointer-events-none absolute inset-0 z-[-1] flex items-center justify-between px-3.5",children:f.map((v,b)=>e.jsx("option",{value:v.value,className:B("aspect-square h-1.5 overflow-hidden rounded-full bg-black/10 text-transparent [min-block-size:6px] dark:bg-white/10",b===0&&"translate-x-1.5",b===f.length-1&&"-translate-x-1.5"),label:v.label},v.type))}),e.jsx("input",{type:"range",id:"juce-level",name:"juice-level",className:B(uc.rangeSelector,"h-8 w-full cursor-pointer touch-pan-y appearance-none rounded-2xl bg-transparent px-1"),style:{"--slider-thumb-translate-x":u?"0px":x.type==="medium"?0:x.type==="low"?"45px":"-45px"},min:"0",step:"1",tabIndex:0,max:"2",value:x.value,onKeyDown:v=>{(v.key==="Escape"||v.key===" "||v.key==="Enter")&&(E.current?_.current=!0:g())},onClick:()=>{Date.now()-(C.current??0)>200&&(y.current=!0)},onPointerDown:()=>{y.current=!1,C.current=Date.now()},onPointerUp:()=>{k.current&&(E.current?_.current=!0:requestAnimationFrame(()=>{y.current&&g()}))},onChange:v=>{const b=v.target.value,F=h.get(parseInt(b));F&&(a(F.type),k.current=!0)},list:"juice-level-markers"})]}),e.jsx("div",{children:e.jsxs("div",{className:"text-md my-4 flex flex-col items-center justify-center text-black dark:text-white",children:[e.jsx("div",{className:"relative flex h-10 w-10 items-center justify-center overflow-clip",children:e.jsx(Ti,{value:x.value+1,size:"large",onStateChange:v=>{v==="idle"?(E.current=!1,_.current&&(_.current=!1)):v==="animating"&&(E.current=!0)}})}),e.jsx("label",{htmlFor:"juice-level-label",className:"my-1.5 font-semibold tracking-[-0.32px] [font-size:16px]",children:x.label}),e.jsx("div",{className:"mb-2 max-w-[215px] text-balance px-2 text-center text-xs font-normal text-token-text-secondary",children:x.description}),o&&H]})})]}),e.jsx(fe,{children:A&&o&&e.jsx(Jp,{clientThreadId:t,setIsModelPickerOpen:j,isModelPickerOpen:A,currentModelId:c,onModelSelection:i,closePopover:g})})]})},Jp=({clientThreadId:t,currentModelId:s,onModelSelection:n,closePopover:a,setIsModelPickerOpen:o})=>{const r=V(),{data:c}=Hn(),i=dc({clientThreadId:t}),{hasInternalModels:d}=mc();return e.jsxs(U.div,{initial:{clipPath:"inset(0 100% 0 0)",opacity:0},animate:{clipPath:"inset(0 0% 0 0)",opacity:1},exit:{clipPath:"inset(0 100% 0 0)",opacity:0},transition:ds,className:"flex flex-col",children:[e.jsxs("div",{className:"sticky left-0 top-0 z-10 flex w-full flex-row items-center justify-center overflow-clip border-b border-token-border-xlight bg-token-main-surface-primary px-3 py-3 dark:bg-token-main-surface-secondary",children:[e.jsx("button",{onClick:()=>{o(!1)},className:"flex items-center rounded-md p-1 hover:bg-token-main-surface-tertiary",children:e.jsx(pc,{className:"h-5 w-5 text-token-text-secondary"})}),e.jsx("div",{className:"flex-auto text-center text-sm font-medium",children:r.formatMessage({id:"j6WEI7",defaultMessage:"Choose a model"})}),e.jsx("div",{className:"w-5"})]}),e.jsxs("div",{className:"flex w-full flex-col py-2",children:[d&&e.jsxs(e.Fragment,{children:[e.jsx(gc,{modelsData:c,clientThreadId:t,triggerButton:e.jsx(hc,{className:"relative",children:e.jsxs("div",{className:"mb-1 flex items-center px-1",children:[e.jsx("div",{className:"text-sm",children:r.formatMessage({id:"lfH4U6",defaultMessage:"Internal Models"})}),e.jsx(si,{className:"icon-md absolute right-1 w-7 text-token-text-tertiary"})]})})}),e.jsx("div",{className:"mx-4 mt-2 h-px bg-token-border-xlight"})]}),c?.categories?.map(p=>{const u=p?.defaultModel,l=i[u]?.conversation?.[0];return e.jsx(fc,{model:p,modelSwitcherDeny:l,isSelected:u===s,onClick:()=>{n(u),a()}},u)})]})]})},Xp=({clientThreadId:t,layoutMode:s,currentModel:n,category:a,shouldShowModelPicker:o=!1,type:r,...c})=>{const i=wt(j=>j.threads[t]?.isManualModelSelection),d=m.useMemo(()=>{const j=n?.id??"";return _a.includes(j)?"low":Aa.includes(j)?"medium":Ma.includes(j)?"high":"low"},[n?.id]),p=xc(),u=dt(),l=tt(),g=wt(j=>j.setManualModelSelection),f=m.useCallback(j=>{g(t,!1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{const I=Qs[j];u({location:"PromptTextarea",modelId:I})})})},[t,g,u]),h=j=>{const I=n?.id??"";j&&(w.logEvent(D.modelSwitcherModelChanged,{from:I,to:j,source:"popover"}),At.logEvent("chatgpt_model_switcher_model_changed",j,{from:I,to:j,source:"popover"}),u({modelId:j,location:"Model switcher menu item"}),j!==bc&&l&&Wo(j),g(t,!0))},x=!Pa.includes(n?.id??""),k=i||x,C=(a?.label&&a?.label?.length<10?a?.label:a?.shortLabel)??n?.title??"",_=n?.id??"",E=()=>{f("low"),g(t,!1),Wo(Qs.low)},A=m.useCallback(()=>{const{reasoningLevelList:j}=p,H=(j.findIndex(v=>v.type===d)+1)%j.length;f(j[H].type)},[f,d,p]);return m.useEffect(()=>Ld(Mm,{cycleReasoningLevel:A}),[A]),e.jsxs(ut,{layoutMode:s,...c,children:[e.jsx(ut.BaseTrigger,{children:e.jsx(Vp,{isManualModelSelection:k,modelName:C,animatedLabel:!0,reasoningLevelTypes:p,reasoningLevelType:d,onResetReasoningLevel:E,type:r})}),e.jsx(ut.Content,{origin:s==="centered"?"top left":"bottom left",align:"start",children:e.jsx(Kp,{clientThreadId:t,reasoningLevelTypes:p,reasoningLevelType:d,onReasoningLevelChanged:f,modelName:C,shouldShowModelPicker:o,isManualModelSelection:k,currentModelId:_,onModelSelection:h,resetReasoningLevel:E})})]})},Qp=5,Zp=m.memo(function(s){return eg(s),tg(s),sg(),null});function eg(t){const{store:s}=we(),n=s.useSetSharedProps();nn(()=>{n(t)},[t,n])}function tg(t){const{clientThreadId:s,canContinue:n}=t,{store:a}=we(),o=m.useRef({top:a.useContentAreaApi(kt.HeaderTop),bottom:a.useContentAreaApi(kt.HeaderBottom)}).current,r=Sc(s),{shouldShowBannerSignup:c,shouldShowBannerTermsDisclaimer:i}=ng(s),d=Gm(s),p=vc(t),u=Sd(t),l=yi(),g=fn(),f=yc(),h=vd(t),x=zm(s),k=Cc(),y=jc(t),C=kc(s),_=wc(s),E=_c(),{eligible:A}=me(Rc),j=Ac(),I=Mc(),H=Pc(),v=Nc(),b=Ym(s),F=ce(s,N=>N?.modelId),O=gt(s);nn(()=>{F&&O?.kind===Me.GizmoInteraction&&O.gizmo&&Bc(F,O.gizmo)?o.top.set(T.ProjectConversationTaskNoFileAccess):y.eligible?o.top.set(T.AdvancedVoiceOnMobileAnnouncement):k?o.top.set(T.ParagenControls):i?o.top.set(T.BannerTermsDisclaimer):d?o.top.set(T.BannersRateLimit):v?o.top.set(T.BannerPlusUpsell):b?o.top.set(T.ContextualAnswersAdminUpsell):C?o.top.set(T.JawboneAnnouncement):_?o.top.set(T.JawboneMaxActiveAnnouncement):p.eligible?o.top.set(T.BannerSidekickAnnouncement):l?o.top.set(T.MemoryInSearchAnnouncement):g?o.top.set(T.MoonshineAnnouncement):f?o.top.set(T.CustomizeChatGPTAnnouncement):u?o.top.set(T.SearchBrowserExtensionAnnouncement):h?o.top.set(T.SearchBrowserExtensionReactiveAnnouncement):E?o.top.set(T.PromoRedemptionAnnouncement):A?o.top.set(T.OperatorAnnouncement):H?o.top.set(T.ReferralProgramUpsellAnnouncement):n?o.top.set(T.PromptTextareaAction):c?o.top.set(T.BannerSignup):x?o.top.set(T.BannerMemoryFull):j?o.top.set(T.ReferrerRedemptionAvailableAnnouncement):I?o.top.set(T.RefereeRedemptionAvailableAnnouncement):o.top.set(null)},[o,n,i,c,d,p,x,k,y]),nn(()=>{r&&o.bottom.set(ya.DallePromptControls)},[o,r])}function sg(){const{store:t}=we();m.useEffect(()=>()=>{t.reset()},[t])}function ng(t){const{isUnauthenticated:s}=ye(),{layer:n}=Fd("3637408529"),{layer:a}=_t("3637408529"),o=a.get("no_auth_banner_signup_rate_limit",Qp),r=n.get("should_show_no_auth_signup_banner",!0),c=Ec(l=>l.bannerDisclaimerClientThreadId),i=Tc(),d={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1},[p,u]=ce(t,l=>[Q.getConversationTurns(l).filter(g=>g.role===Ln.User).length,og(Q.getCurrentNode(l)?.message)]);return t&&(d.shouldShowBannerTermsDisclaimer=u&&s&&p===1&&!i&&(c==null||c===t),d.shouldShowBannerSignup=r&&u&&s&&p>0&&p%o===0),d}function og(t){return t?.author.role===Ln.Assistant&&Hd(t)}const un=R.PictureV2;function ag({clientThreadId:t,composerController:s,currentModelConfig:n}){const{value:a}=Ie("2868048419"),r=null!=null,i=gt(t)?.kind===Me.PrimaryAssistant,{isUnauthenticated:d}=ye(),p=!d,u=n?.enabledTools?.includes(Fn.ImageGen),{activeSystemHints:l}=ht(t),g=l.find(x=>x.systemHint===R.PictureV2);return!(p&&a&&!r&&i&&u)||!g?null:e.jsx("div",{style:{viewTransitionName:`var(--vt-composer-${un}-action)`},children:e.jsx(ig,{clientThreadId:t,composerController:s,systemHint:g})},`system-hint-${un}`)}function ig({clientThreadId:t,composerController:s,systemHint:n}){const a=hi(s),o=Un(s,t),r=a===un,c=d=>{d.stopPropagation(),d.preventDefault(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{o({hint:n,enable:!r}),s.focus()})}),s.setAutocompletions(fi),r?w.logEventWithStatsig(D.composerThinkButtonDisabled,"composer_create_image_button_disabled",{clientThreadId:t}):w.logEventWithStatsig(D.composerThinkButtonEnabled,"composer_create_image_button_enabled",{clientThreadId:t})},i=e.jsx(It,{pressed:r,icon:e.jsx(Ic,{className:"h-[18px] w-[18px]"}),label:n.name,ariaLabel:n.name,animatedLabel:!0,showLabel:!0,onClick:c,disabled:!1});return e.jsx(ze,{sideOffset:0,label:n.description,side:"bottom",onOpenChange:d=>{d&&w.logEventWithStatsig(D.composerCreateImageButtonHovered,"composer_create_image_button_hovered",{clientThreadId:t})},children:i})}function rg({usage:t}){const s={work:{icon:Hc,color:"#35AE47"},school:{icon:Oc,color:"#E937D1"},personalTasks:{icon:Uc,color:"#EA8444"},funAndEntertainment:{icon:Gc,color:"#6C71FF"},justCurious:{icon:zc,color:"#FFCC00"}},n=s[t].icon,a=s[t].color;return e.jsx(n,{className:"icon-md",style:{color:a}})}function uh({clientThreadId:t}){const s=V(),n=pi({clientThreadId:t});return m.useEffect(()=>{At.logEvent("chatgpt_convo_onboarding_usage_chips_shown")},[]),e.jsx(fe,{mode:"wait",children:e.jsx(U.div,{className:"-mx-6 mt-2 flex flex-wrap gap-2 px-6",initial:{opacity:0},animate:{opacity:1,transition:{delay:.2,ease:"easeInOut"}},exit:{opacity:0,transition:{ease:"easeInOut"}},children:["school","work","personalTasks","funAndEntertainment","justCurious"].map(a=>e.jsxs("button",{className:"inline-flex h-[42px] items-center justify-start gap-2 rounded-[25px] border border-token-border-light bg-token-main-surface-primary px-4 py-3 hover:bg-token-main-surface-secondary",onClick:o=>{n({sourceEvent:o,stepPrompt:s.formatMessage(Mt[`${a}Prompt`]),messageMetadata:{onboarding:{main_usages:[{usage:a}]},is_starter_prompt:!0,suggestion_type:rt.Starter}}),At.logEvent("chatgpt_convo_onboarding_usage_chip_clicked",null,{usage:a})},children:[e.jsx("div",{"data-svg-wrapper":!0,className:"relative",children:e.jsx(rg,{usage:a})}),e.jsx("div",{className:"font-['SF Pro'] text-[13px] font-normal leading-[18px] text-token-text-primary opacity-90",children:s.formatMessage(Mt[a])})]},a))})})}function dh({clientThreadId:t,examples:s}){const n=pi({clientThreadId:t}),a=[Dc,Lc,Fc],o=V();return m.useEffect(()=>{At.logEvent("chatgpt_convo_onboarding_examples_shown")},[]),e.jsx(fe,{mode:"wait",children:e.jsxs("div",{children:[e.jsx(U.p,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,ease:"easeInOut"},className:"text-base text-token-text-primary",children:o.formatMessage(Mt.tryAnExample)}),e.jsx("ul",{className:"-mx-6 flex list-none flex-nowrap gap-6 overflow-auto px-6 py-4",children:s.map((r,c)=>e.jsx(U.li,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:(c+1)*.2,duration:.3},children:e.jsxs("button",{className:"inline-flex h-60 w-[222px] flex-col items-center justify-start overflow-hidden rounded-2xl bg-token-main-surface-primary outline outline-token-border-xlight transition-all duration-300 hover:shadow-lg hover:shadow-token-border-light",onClick:i=>{n({sourceEvent:i,stepPrompt:r.example,messageMetadata:{onboarding:{triggered_tools:[r.feature]},is_starter_prompt:!0,suggestion_type:rt.Starter}}),At.logEvent("chatgpt_convo_onboarding_example_clicked",null,{tool:r.feature})},children:[e.jsx("img",{src:a[c%a.length].src,className:"h-[160px] w-full object-cover",alt:o.formatMessage({id:"chatgpt.new-onboarding.example-prompt",defaultMessage:"Example prompt"})}),e.jsx("div",{className:"inline-flex h-20 w-full gap-1 p-4",children:e.jsx("div",{className:"line-clamp-2 shrink grow basis-0 text-start text-base leading-normal text-token-text-primary",title:r.title,children:r.title})})]})},r.feature))})]})})}function lg({clientThreadId:t,children:s}){const{isEligible:n,markAsViewed:a}=gi(t),o=V();return m.useEffect(()=>{n&&Zs.showAnnouncementTooltipExclusively(le.hasSeenFilePickerNuxTooltip,!0)},[n]),n?e.jsx(ws,{announcementKey:le.hasSeenFilePickerNuxTooltip,show:!0,side:"top",align:"start",theme:"bright",dismissOnOutsideClick:!0,badge:"none",title:o.formatMessage(Mt.tryUploadingAFile),description:o.formatMessage(Mt.uploadFileExample),onDismiss:a,sideOffset:0,children:s}):s}const Bi=({clientThreadId:t,rateLimitPopup:s,children:n,disabled:a,highlightTooltip:o=!1,disabledReason:r,currentModelName:c})=>{const i=V(),d=ce(t,Q.getIsNewConversation),p=tt(),u=h=>{s!=null&&h&&w.logPopoverHover({type:"rate_limit",location:"file_upload",plan_type:p?.planType??"unknown"})},l=mn(Be.signUpButtonText),{isEligible:g}=gi(t),f=!!s;return e.jsx(e.Fragment,{children:f?e.jsx("div",{className:"h-8",children:e.jsxs(Od,{delayDuration:150,onOpenChange:u,children:[e.jsx(Ud,{asChild:!0,children:n}),e.jsx(Gd,{children:e.jsx(ei,{$as:zd,side:"left",sideOffset:0,align:"start",alignOffset:-12,className:"max-w-[320px]",children:e.jsx(cg,{isNewConversation:d,rateLimitPopup:s,signUpButtonText:l})})})]})}):!a&&g?e.jsx(lg,{clientThreadId:t,children:n}):e.jsx(ze,{sideOffset:0,label:a?r===Re.ModelNotSupported?i.formatMessage({id:"pEB4vw",defaultMessage:"Attachments disabled for {modelName}"},{modelName:`${c}`}):r===Re.ThinkModeInUse?i.formatMessage({id:"NRk4QL",defaultMessage:"Attachments disabled for Reason mode"}):r===Re.SearchModeInUse?i.formatMessage({id:"YlO80p",defaultMessage:"Attachments disabled for Search mode"}):i.formatMessage({id:"9Wgi7B",defaultMessage:"Attach files is unavailable"}):i.formatMessage({id:"wkpQmi",defaultMessage:"Upload files and more"}),className:"flex",open:o?!0:void 0,side:"bottom",children:n})})},cg=({isNewConversation:t=!1,rateLimitPopup:s,signUpButtonText:n})=>{const a=tt(),o=Pt(),r=xs(),c=bs(),i=Nt();if(s==null)return null;const{call_to_action:d,description:p}=s,u=p||e.jsx(P,{...ua.defaultDescription}),l=d?.includes(ee.GET_PLUS),g=d?.includes(ee.AUTHENTICATE),f=g&&i;return e.jsxs("div",{className:"p-2 text-sm text-token-text-primary",children:[e.jsx("div",{className:"mb-3",children:u}),l?e.jsx(Ge,{size:"small",color:"secondary",onClick:()=>{lt(o,"Rate limited file upload popover"),w.logRateLimitGetPlusButtonClicked({type:"file_upload",location:"popover",plan_type:a?.planType??"unknown",is_hard_block:!1,is_new_conversation:t,hard_block_reason:""})},children:e.jsx(P,{...ua.getPlus})}):null,g?e.jsx(Ge,{size:"small",color:"primary",onClick:()=>{r({authType:c?"login":"signup",callback:h=>{c?w.logLogInButtonClicked({location:"File picker rate limit tooltip",provider:h}):w.logSignUpButtonClicked({location:"File picker rate limit tooltip",provider:h})}})},children:c?e.jsx(P,{...Be.logInButtonText}):e.jsx(P,{...n})}):null,f?e.jsx(Ge,{size:"small",color:"secondary",className:"ml-2",onClick:()=>{r({authType:c?"signup":"login",callback:h=>{c?w.logSignUpButtonClicked({location:"File picker rate limit tooltip",provider:h}):w.logLogInButtonClicked({location:"File picker rate limit tooltip",provider:h})}})},children:c?e.jsx(P,{...n}):e.jsx(P,{...Be.logInButtonText})}):null]})},ua=ve({defaultDescription:{id:"U5qAWP",defaultMessage:"You've reached your daily upload limit. Get ChatGPT Plus to unlock more."},getPlus:{id:"TeyLcp",defaultMessage:"Get Plus"}});function Ii({clientThreadId:t,getInputProps:s,openFileDialog:n,uploadType:a,icon:o,isDisabled:r=!1,isSmall:c=!1,showLabel:i=!1,showUpsell:d=!1,hideBorder:p=!1,highlightTooltip:u=!1,disabledReason:l,currentModelName:g}){const f=V(),h=As();r=(r||!!h)&&!d;const x=e.jsxs(Na,{disabled:r,$showLabel:i,$hideBorder:p,$isSmall:c,onClick:C=>{if(C.preventDefault(),d){w.logNoAuthAttachButtonClicked({location:"No auth upsell"});return}w.logEvent(D.openFileViewer,{intent:a.toString()}),n()},"aria-label":r?l===Re.ModelNotSupported?f.formatMessage({id:"pEB4vw",defaultMessage:"Attachments disabled for {modelName}"},{modelName:`${g}`}):l===Re.ThinkModeInUse?f.formatMessage({id:"NRk4QL",defaultMessage:"Attachments disabled for Reason mode"}):l===Re.SearchModeInUse?f.formatMessage({id:"YlO80p",defaultMessage:"Attachments disabled for Search mode"}):f.formatMessage({id:"PromptFilePicker.attachFilesUnavailable",defaultMessage:"Attach files is unavailable"}):f.formatMessage({id:"PromptFilePicker.attachFiles",defaultMessage:"Upload files and more"}),children:[o,i&&e.jsx(Ea,{})]}),k=e.jsx("input",{disabled:r,...s({className:"hidden"})}),y=e.jsxs("div",{className:"flex",children:[x,k]});return d?e.jsx(ze,{sideOffset:0,label:e.jsx(P,{id:"wkpQmi",defaultMessage:"Upload files and more"}),side:"bottom",open:u||void 0,children:e.jsx(Wd,{triggerButton:y,sideOffset:0,alignOffset:0,children:e.jsx(xn,{location:"attach",statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked"})})}):e.jsx(Bi,{disabled:r,clientThreadId:t,rateLimitPopup:h,highlightTooltip:u,children:y})}function ug({code:t,message:s}){switch(t){case Vo.FileTooLarge:return da.errorFileTooLarge;case Vo.TooManyFiles:return w.logEvent(D.uploadedMaxFilesError),da.errorTooManyFiles;default:return s}}const da=ve({attachImages:{id:"PromptFilePicker.attachImages",defaultMessage:"Attach images"},attachFiles:{id:"PromptFilePicker.attachFiles",defaultMessage:"Upload files and more"},errorFileTooLarge:{id:"PromptFilePicker.errorFileTooLarge",defaultMessage:"Your file is too large. The maximum file size is {size}MB."},errorTooManyFiles:{id:"PromptFilePicker.errorTooManyFiles",defaultMessage:"You may only upload {maxNum} files at a time."},defaultFileUploadRateLimited:{id:"U5qAWP",defaultMessage:"You've reached your daily upload limit. Get ChatGPT Plus to unlock more."},getPlusButton:{id:"TeyLcp",defaultMessage:"Get Plus"}}),ma=ve({dragInstructions:{id:"FileDropZone.dragInstructions",defaultMessage:"Add anything"},dragAllAccepted:{id:"FileDropZone.dragAllAccepted",defaultMessage:"Drop any file here to add it to the conversation"}});function dg(t){if(!t.accept||Object.keys(t.accept).length===0)return[];const s=[];return Object.values(t.accept).forEach(n=>s.push(...n)),s.sort()}function mh(t){const{className:s,children:n,clientThreadId:a,currentModelConfig:o,noKeyboard:r}=t,c=V(),i=Tt(),d=gt(a),p=Bt(),u=ms(o,d,p),l=u!==Qe.None,g=en(j=>j.files),f=(u===Qe.Multimodal?vn:yn)-g.length,h=f<=0,{getGizmoId:x}=Cn(),{handleFileAccepted:k}=Vn(c,u,kn(o,d),"drag",x,jn(o,d)?.attachments),y=As(),C=wn(_n(o,d)),{getRootProps:_,isDragActive:E}=An({maxFiles:f,disabled:!l||h||y!=null,noClick:!0,noKeyboard:r,onDropAccepted:k,onDropRejected:j=>Wn(j,c,i,u),multiple:!0,maxSize:Mn,...C}),A=dg(C);return e.jsxs("div",{..._({className:s}),children:[n,E&&e.jsxs(mg,{children:[e.jsx(Wc,{}),e.jsx("h3",{children:e.jsx(P,{...ma.dragInstructions})}),e.jsx("h4",{className:"w-2/3 text-center",children:A.length>0?A.join(", "):e.jsx(P,{...ma.dragAllAccepted})})]})]})}function Wn(t,s,n,a){const{errors:o}=t[0];o.forEach(r=>{const c=ug(r);typeof c=="string"?n.danger(c,{hasCloseButton:!0}):n.danger(s.formatMessage(c,{size:Vc,maxNum:a===Qe.Multimodal?vn:yn}),{hasCloseButton:!0})})}function Vn(t,s,n,a,o,r){const c=ni(),i=oi(c).flags,d=Tt(),p=Pn(),{isUnauthenticated:u}=ye(),l=i?.includes(fs.NoAuthEnableFileUploads);return{handleFileAccepted:m.useCallback(async(f,h)=>{w.logEvent(D.uploadFile,{client:"web",eventSource:a,intent:s.toString()});const x=o!=null?await o():void 0;f.length>0&&f.forEach(k=>{cs.uploadFile(p,qc(k),k,s,n,t,d,{gizmoId:x,...l&&{isUnauthenticated:u}},r)})},[a,s,o,p,n,t,d,r,l,u])}}const mg=Dn.div`absolute z-50 inset-0 flex gap-2 flex-col justify-center items-center after:contents-[""] after:absolute after:opacity-80 after:z-[-1] after:bg-token-main-surface-primary after:inset-0`;function pg({composerController:t,clientThreadId:s,onHintSelected:n}){const a=ai(s),[o]=ce(s,N=>[N?.modelId]),{data:r}=Hn(),c=o??$c(void 0).id,i=Ta(r?.models,c),{setThreadSystemHintMode:d,clearAllSystemHintModeTriggers:p}=We(),{viewableSystemHints:u,persistedSystemHints:l}=pt.useState(({availableHints:N,persistedSystemHints:M})=>({viewableSystemHints:N,persistedSystemHints:M})),[g,f]=m.useState([]),[h,x]=m.useState(void 0),[k,y]=m.useState(0);m.useEffect(()=>{if(!h)f([]);else{const N=h.text.toLocaleLowerCase();f(u.filter(M=>{const z=M.name.toLocaleLowerCase().startsWith(N),te=M.systemHint.toLocaleLowerCase().startsWith(N);let q=!1;return M.regexMatches&&M.regexMatches.length>0&&(q=M.regexMatches.some(oe=>oe.replace(/[\^\$\(\)]/g,"").toLocaleLowerCase().startsWith(N))),z||te||q}).filter(M=>M.requiredFeatures.every(z=>i?.enabledTools?.includes(z))))}},[h]),m.useEffect(()=>{t.view.dispatch(yd(t.view.state.tr,{onHintMatch(N){x(M=>Vd(M,N)?M:N)}}))},[t]);const C=!u.length||!g.length||!h;m.useEffect(()=>{C&&y(0)},[C]);const _=g.length,E=m.useCallback(N=>{y(M=>(N(M)%_+_)%_)},[_]),A=m.useCallback(()=>{y(-1)},[]),j=g[k],I=m.useCallback(()=>{h?.range&&t.delete(h.range.from,h.range.to)},[h,t]),H=({hintToSave:N=j,expectPerfectMatch:M})=>{if(!h||!j||M&&N.name.toLowerCase()!==h.text.toLowerCase())return!1;w.logEvent(D.systemHintSelected,{system_hint:N.systemHint,conversation_id:a??sn});const z=h.range.from===1?N.name:h.text+N.name.slice(h.text.length),te={clientThreadId:s};ns(t.view),l.size>0&&p();const q=!!N.composerBarButtonInfo,oe=N.systemHint===R.Search;return q||oe?(d(N.systemHint,!0,te,oe?ii.CONVERSATION_COMPOSER_SLASH_SEARCH:void 0),I(),t.removeSystemHints(),!0):(t.addSystemHint(N.systemHint,z,h.range.from,h.range.to),!0)},v=m.useRef(H);v.current=H;const b=m.useRef(E);b.current=E;const F=m.useRef(h);F.current=h;const O=t.view;return m.useEffect(()=>(C||Cd(O,N=>{if(N==="up")b.current(M=>M-1);else if(N==="down")b.current(M=>M+1);else if(N==="cancel")ns(O),jd(O);else if(N==="submit")if(n)I(),n(j.systemHint);else return ns(O),v.current({expectPerfectMatch:!1});else if(N==="checkMatch")return v.current({expectPerfectMatch:!0})}),()=>ns(O)),[C,O,j,n,I]),m.useEffect(()=>{C||w.logEvent(D.systemHintListOpened,{conversation_id:a??sn})},[C]),{suggestorClosed:C,systemHintSuggestions:g,hintMatch:h,selectedIndex:k,resetSelectedIndex:A,setSelectedIndex:y,saveHint:H}}function gg({composerController:t,clientThreadId:s}){const{selectedIndex:n,systemHintSuggestions:a,suggestorClosed:o,setSelectedIndex:r,saveHint:c}=pg({composerController:t,clientThreadId:s});return o?null:e.jsx(qd,{className:"max-w-60",onMouseDown:i=>{i.preventDefault()},children:a.map((i,d)=>e.jsx("div",{onMouseOver:()=>r(d),onClick:()=>{c({hintToSave:i,expectPerfectMatch:!1}),t.focus()},children:e.jsx($d,{autoFocus:!1,className:"rounded-lg px-1 py-2",$spoofHovered:d===n,children:e.jsx(Di,{title:i.name,description:i.description,logo:i.logo})})},i.systemHint))})}function Di({title:t,description:s,logo:n,checked:a,badge:o}){const r=V();return e.jsxs("div",{className:"group inline-flex w-full items-center justify-start gap-2 pl-1.5 pr-3",children:[e.jsx("div",{className:"flex h-7 w-7 items-center justify-center gap-2.5",children:e.jsx(mi,{svgString:n,className:"icon-lg text-token-text-secondary"})}),e.jsxs("div",{className:"shrink grow basis-0",children:[e.jsxs("p",{className:"text-sm font-normal leading-tight text-token-text-primary",children:[t,o&&e.jsx("span",{className:"ml-2 rounded-full bg-blue-400 px-2 py-0.5 text-xs text-white","aria-label":r.formatMessage({id:"I75WNJ",defaultMessage:"Create image updated"}),children:e.jsx(P,{id:"uUmZQi",defaultMessage:"Updated"})})]}),!!s&&e.jsx("p",{className:"text-[13px] font-normal leading-[18px] text-token-text-secondary",children:s})]}),a&&e.jsx(ri,{className:B("icon-md text-token-text-primary",{"group-hover:hidden":!a})})]})}function pa({composerController:t,clientThreadId:s}){return t instanceof Tn?e.jsx(gg,{composerController:t,clientThreadId:s}):null}function Li({children:t,className:s,showBackground:n}){return e.jsxs("div",{className:"relative",children:[t,n&&e.jsx(U.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:B("pointer-events-none absolute inset-0 rounded-full",s)})]})}function hg({clientThreadId:t,icon:s,setOpen:n,open:a,isDisabled:o=!1,showLabel:r=!1,highlightTooltip:c=!1,hideBorder:i=!1,isSmall:d=!1,disabledReason:p,currentModelName:u,visualTreatment:l}){const g=As(),f=V();return o=o||!!g,e.jsxs(e.Fragment,{children:[e.jsx(X.Trigger,{className:"m-0 h-0 w-0 border-none bg-transparent p-0"}),e.jsx(Bi,{clientThreadId:t,rateLimitPopup:g,highlightTooltip:c,disabled:o,disabledReason:p,currentModelName:u,children:e.jsxs(Na,{disabled:o,"aria-disabled":o,"aria-label":o?f.formatMessage({id:"NTwThg",defaultMessage:"Attach files is unavailable"}):f.formatMessage({id:"ixBxc3",defaultMessage:"Upload files and more"}),onClick:h=>{h.preventDefault(),n(!0)},$open:a,$showLabel:r,$hideBorder:i,$isSmall:d,$visualTreatment:l,children:[s,r&&e.jsx(Ea,{})]})})]})}function fg({title:t,description:s,icon:n,checked:a}){return e.jsxs("div",{className:"group inline-flex w-full items-center justify-start gap-3 text-token-content-primary",children:[n&&e.jsx("div",{className:"flex items-center justify-center gap-2.5",children:e.jsx(mi,{svgString:n,className:"icon-md"})}),e.jsxs("div",{className:"shrink grow basis-0",children:[e.jsx("p",{className:"text-sm font-normal leading-tight",children:t}),!!s&&e.jsx("p",{className:"text-xs font-normal text-token-content-secondary",children:s})]}),a?e.jsx(ri,{className:B("icon-md text-token-text-primary",{"group-hover:hidden":!a})}):null]})}function xg({onOauthRedirect:t,connectors:s,isNested:n}){const a=V();return e.jsxs(X.Sub,{children:[e.jsx(X.SubMenuTrigger,{icon:Yc,className:B(n&&"mx-0 rounded-xl p-1.5 px-2 py-2.5"),children:e.jsx(P,{...bg.oneDriveSubmenuName})}),e.jsx(X.Portal,{children:e.jsx(X.SubContent,{className:B(n&&"flex flex-col justify-start gap-2 p-1.5"),children:s.map(o=>o?e.jsx(X.Item,{onClick:()=>t(o),className:B(n&&"mx-0 rounded-xl p-1.5 px-2 py-2.5"),children:n?e.jsx(fg,{title:qo(o.type,a),description:o.type===Se.O365_BUSINESS?e.jsx(P,{...$o.includesSharePoint}):null}):e.jsxs("div",{className:"flex flex-col",children:[qo(o.type,a),o.type===Se.O365_BUSINESS&&e.jsx("div",{className:"text-s text-token-text-tertiary",children:e.jsx(P,{...$o.includesSharePoint})})]})},o.id):null)})})]})}const bg=ve({oneDriveSubmenuName:{id:"ContextConnectorPickerOneDriveSubmenu.oneDriveSubmenuName",defaultMessage:"Connect to Microsoft OneDrive"}});function Sg(){const{connectorConfig:t}=Ra(),s=Nn(),n=En(),[a,o]=ps(Ba([...t.values()],u=>!!u.access_token),u=>!!u.access_token),[r,c]=ps(o,u=>u.type===Se.O365_PERSONAL||u.type===Se.O365_BUSINESS),i=!s&&!n&&a.length>0,d=!s&&!n&&!i&&r.length>1;return{unconnectedConnectors:n?[]:d?c:o,showUnconnectedInSubmenu:i,showOneDriveInSubmenu:d}}function vg({clientThreadId:t,icon:s,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:a,attachmentsProductFeature:o,onOauthRedirect:r,uploadType:c,getInputProps:i,openFileDialog:d,isDisabled:p=!1,isNested:u=!1,highlightTooltip:l=!1,showLabel:g,isSmall:f=!1,hideBorder:h=!1,disabledReason:x,currentModelName:k,visualTreatment:y="vanguard",showMenuForNoAuth:C=!1}){const _=Yd().locale,E=V(),A=Tt(),j=Pn(),I=Nn(),{connectorConfig:H,isLoading:v}=Ra(),b=me(le.ContextConnectors),{getGizmoId:F}=Cn(),O=xs(),[N,M]=m.useState();m.useEffect(()=>{F?F().then(L=>M(L)):M(void 0)},[F]);const z=m.useRef(null),[te,q]=m.useState(!1),oe=m.useRef(!1),pe=m.useCallback(()=>{const L=z.current?.files;Array.from(L??[]).forEach(Ne=>Ct.uploadFile(j,Ne,a,E,A,o))},[j,a,E,A,o]),[$,J]=m.useState(null),ae=m.useCallback(()=>J(null),[J]),ue=m.useCallback((L,Ne)=>Ct.uploadPickedFile(j,L,Ne,a,n,o,N,E,A),[j,a,n,o,N,E,A]),{openMenu:de,confirmMenuOpened:K}=Kc();m.useEffect(()=>{de&&(q(!0),K())},[de,K,q]);const re=m.useCallback(L=>{Ct.doContextConnectorOauthRedirect(location.pathname+location.search+location.hash,L,r,sa.Picker),r()},[r]),Ce=m.useCallback(L=>{Ct.uploadPickedFile(j,L,Se.GDRIVE,a,n,o,N,E,A)},[j,a,n,o,N,E,A]),_e=m.useCallback(async L=>{const{access_token:Ne}=L;if(!Ne){re(L);return}switch(Ct.logAttemptIfAccessTokenIsExpired(L,sa.Picker),L.type){case Se.GDRIVE:Jc(_,L.type,Ne,Ft=>Ft.forEach(Ce));break;case Se.O365_PERSONAL:case Se.O365_BUSINESS:J(L.type);break}},[Ce,re,J,_]),se=()=>{w.logEvent(D.openFileViewer,{intent:c.toString()}),d()},G=L=>{if(!L&&oe.current&&!v)se();else if(L&&st&&!v&&!C){se();return}q(L),L&&(b.eligible&&b.markAsViewed(),w.logEventWithStatsig(D.composerOpenContextConnectorPicker,"chatgpt_composer_open_context_connector_picker"),oe.current=!0,setTimeout(()=>{oe.current=!1},250))},[Pe,Ve]=ps(Ba([...H.values()],L=>!!L.access_token),L=>!!L.access_token);yg(Pe,_e);const[Dt]=ps(Ve,L=>L.type===Se.O365_PERSONAL||L.type===Se.O365_BUSINESS),{unconnectedConnectors:qe,showUnconnectedInSubmenu:Lt,showOneDriveInSubmenu:Ms}=Sg(),{desktopConnectors:ie}=Xc(a),st=!Pe.length&&!qe.length&&!ie.length,je=e.jsxs(e.Fragment,{children:[Lt&&qe.length>0&&e.jsx(Qc,{connectorEntries:qe,onOauthRedirect:L=>re(L),isNested:u}),!Lt&&qe.map(L=>e.jsx(Yo,{entry:L,onClick:()=>_e(L),isNested:u},L.id)),Ms&&e.jsx(xg,{connectors:Dt,onOauthRedirect:re,isNested:u}),v&&e.jsx(X.Item,{icon:e.jsx(Xa,{className:"text-token-text-secondary"})}),(qe.length>0||v)&&!u&&e.jsx(X.Separator,{}),Pe.map(L=>e.jsx(Yo,{entry:L,onClick:()=>_e(L),isNested:u},L.id)),ie.map(L=>e.jsx(Zc,{entry:L,isNested:u},L.key)),e.jsx(eu,{modelSupportedImageMimeTypes:a}),C?e.jsx(Cg,{onClickUploadImages:se,redirectToAuth:()=>O({authType:"login"})}):e.jsx(X.Item,{className:B(u&&"mx-0 rounded-xl p-1.5 px-2 py-2.5"),onClick:se,icon:tu,children:e.jsx(P,{...I?Xe.uploadFileMobile:Xe.uploadFile})},"upload")]}),Ps=u?e.jsx("div",{className:"relative flex flex-col",children:je}):e.jsxs("div",{className:"flex flex-col",children:[e.jsx(su,{type:$,onClose:ae,uploadPickedFile:ue}),e.jsx("input",{onChange:pe,...i({className:"hidden"})}),e.jsxs(X.Root,{open:te,onOpenChange:G,children:[e.jsx(hg,{clientThreadId:t,icon:s,setOpen:G,open:te,isDisabled:p,highlightTooltip:l,showLabel:g,hideBorder:h,isSmall:f,disabledReason:x,currentModelName:k,visualTreatment:y}),e.jsx(X.Portal,{children:e.jsx(X.Content,{alignOffset:-16,side:"top",children:je})})]}),e.jsx(nu,{hasConnectors:!v&&!st})]});return{dropdownItems:je,mainComponent:Ps}}function yg(t,s){const{connector:n,clearParam:a}=ou(),o=t.find(r=>r.type===n&&!!r.access_token);m.useEffect(()=>{o&&(s(o),a())},[o,s,a])}function Fi(t){const{mainComponent:s}=vg(t);return s}function Cg({onClickUploadImages:t,redirectToAuth:s}){return e.jsxs(e.Fragment,{children:[e.jsx(X.Item,{icon:Ia,onClick:s,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx(P,{...Xe.connectApps}),e.jsx("span",{className:"text-[13px] text-token-text-secondary",children:e.jsx(P,{...Xe.loginRequired})})]})},"connect-apps-no-auth"),e.jsx(X.Item,{icon:au,onClick:s,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx(P,{...Xe.uploadDocuments}),e.jsx("span",{className:"text-[13px] text-token-text-secondary",children:e.jsx(P,{...Xe.loginRequired})})]})},"upload-documents-no-auth"),e.jsx(X.Item,{icon:iu,onClick:t,children:e.jsx(P,{...Xe.uploadImages})},"upload-images-no-auth")]})}const Xe=ve({attachFiles:{id:"ContextConnectorPicker.attachFiles",defaultMessage:"Upload files and more"},uploadFile:{id:"LocalFileDropdownItem.uploadFile",defaultMessage:"Upload from computer"},uploadFileMobile:{id:"LocalFileDropdownItem.uploadFileMobile",defaultMessage:"Upload file"},connectApps:{id:"Rna6u2",defaultMessage:"Connect apps"},uploadDocuments:{id:"0BxpM7",defaultMessage:"Documents"},uploadImages:{id:"rdMuNJ",defaultMessage:"Images"},loginRequired:{id:"/1XNys",defaultMessage:"Login required"}});function jg({clientThreadId:t,uploadType:s,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:a,attachmentsProductFeature:o,getInputProps:r,openFileDialog:c,onOauthRedirect:i,historyDisabled:d,isNested:p,isDisabled:u,highlightTooltip:l,disabledReason:g,currentModelName:f,showLabel:h,showUpsell:x,hideBorder:k,isSmall:y,showMenuForNoAuth:C}){const _=En(),{gdriveStatus:E,o365Status:A}=Da(),{isUnauthenticated:j}=ye(),I="h-[18px] w-[18px]",H=d?"text-white":l?"text-brand-blue-800":"",b=!x&&(C||E!=="false"||A!=="false"||_)?e.jsx(Fi,{hideBorder:k,isSmall:y,clientThreadId:t,icon:j?e.jsx(gs,{"aria-label":"",className:B(I,H)}):e.jsx(ka,{"aria-label":"",className:B(I,H)}),showLabel:j&&h,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:a,attachmentsProductFeature:o,onOauthRedirect:i,uploadType:s,openFileDialog:c,isNested:p,getInputProps:r,isDisabled:u,highlightTooltip:l,disabledReason:g,currentModelName:f,showMenuForNoAuth:C}):e.jsx(Ii,{isSmall:y,hideBorder:k,clientThreadId:t,uploadType:s,openFileDialog:c,getInputProps:r,showLabel:h,showUpsell:x,icon:e.jsx(gs,{"aria-label":"",className:B(I,H)}),isDisabled:u,highlightTooltip:l,disabledReason:g,currentModelName:f});return p?b:e.jsx("div",{className:"relative",children:e.jsx(Li,{showBackground:l,className:"bg-brand-blue-800/20",children:b})})}const ga=.0025,kg=m.forwardRef(function({type:s,placeholder:n,replyRegions:a,state:o,renderFiles:r,leftSideActions:c,topRightAction:i,onSubmit:d,setIsComposerOverflowing:p,inputState:u,composerController:l,clientThreadId:g,gizmoId:f,disableReason:h,controlsDisabled:x,setControlsDisabled:k,matchaData:y},C){const _=ru(),[E,A]=m.useState(void 0);let j=null;const{isLoading:I}=_;I||(j=_.modelId);const[H,v]=m.useState(300),b=lu($=>{$.contentRect&&v($.contentRect.width)});m.useEffect(()=>{I||cu()||l.focus()},[j,l,I]);const{value:F}=Ie("3780975974"),{state:O,shouldShowResearchText:N}=ft(g),{getShowUpsellReason:M}=La(),z=F||M(),te=$=>{wg({target:$.target,rootId:"composer-background",additonalInteractiveIds:["reply-regions"]})||l.focus()};function q($){if(!(l instanceof Tn))return;const J=l.getSelectionStart();k?.(!1),requestAnimationFrame(()=>{const{state:ae,dispatch:ue}=l.view;ue(ae.tr.insertText($,J,J)),requestAnimationFrame(()=>{l.setSelection(J+$.length)}),l.usedDictation=!0})}const oe=m.useCallback(()=>e.jsx(Fa,{useStartButtonText:O==="clarify"||!1,inputState:u,state:o,onSubmit:d,composerController:l,clientThreadId:g,gizmoId:f,disableReason:h}),[u,o,d,l,g,f,h,y,O]),pe=Ai(g);return e.jsxs(Ha,{id:"composer-background",ref:C,className:B("flex w-full cursor-text flex-col overflow-clip rounded-t-3xl border-t border-token-border-light duration-150 ease-in-out contain-inline-size motion-safe:transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow,bottom] dark:border-none dark:shadow-none",s!=="temporary"&&"shadow-[0_9px_9px_0px_rgba(0,0,0,0.01),_0_2px_5px_0px_rgba(0,0,0,0.06)] has-[:focus]:shadow-[0_2px_12px_0px_rgba(0,0,0,0.04),_0_9px_9px_0px_rgba(0,0,0,0.01),_0_2px_5px_0px_rgba(0,0,0,0.06)]",s!=="temporary"&&"bg-token-main-surface-primary dark:bg-[#303030]",s==="temporary"&&"dark bg-[#303030]","rounded-b-3xl border-b"),onClick:te,style:{viewTransitionName:"var(--vt-composer)"},children:[e.jsxs("div",{className:"px-3 py-1",children:[e.jsx(fe,{initial:!1,children:a.length>0&&e.jsx(U.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,transition:{duration:.06}},transition:{ease:"easeOut",duration:.1},id:"reply-regions",children:e.jsx("div",{className:"-mx-2",children:e.jsx(Oa,{replyRegions:a})})})}),e.jsxs(e.Fragment,{children:[r,e.jsx(fe,{initial:!1,children:e.jsx(_i,{enabled:N,composerController:l,visualTreatment:"legacy",children:e.jsxs("div",{className:"flex min-h-[44px] items-start pl-1",ref:b,children:[e.jsx("div",{className:"min-w-0 max-w-full flex-1",children:x?E?e.jsx(uu,{waveform:E,containerWidth:H,scaleFactor:10,initialValue:ga}):null:e.jsx(Va,{composerController:l,placeholder:n})}),e.jsx("div",{className:"w-[32px] pt-1",children:i})]})})}),e.jsxs("div",{className:"mb-2 mt-1 flex items-center justify-between sm:mt-5",ref:$=>{if(!z||!("ResizeObserver"in window))return;let J=new AbortController,ae=window.innerWidth;const ue=du({axis:"width",debounce:!0,target:$,onChange:()=>{if(!$)return;$.scrollWidth>$.clientWidth?p?.(!0):Math.abs(ae-window.innerWidth)>40&&(p?.(!1),ae=window.innerWidth)}});return()=>{ue?.(),J.abort()}},children:[e.jsx("div",{className:"flex gap-x-1.5 text-token-text-primary",children:c}),e.jsx("div",{className:"flex gap-x-1.5",children:x?e.jsx(mu,{initialValue:ga,onSuccess:q,onWaveformDataUpdate:A,onExit:()=>{k?.(!1)}}):e.jsxs(e.Fragment,{children:[e.jsx(pu,{size:"small",onExit:()=>{k?.(!0)}}),oe()]})})]})]})]}),e.jsx(fe,{children:pe&&e.jsx(Pi,{clientThreadId:g})})]})});function wg({target:t,rootId:s,additonalInteractiveIds:n}){let a=t;for(;a&&a!=null;){if(a.tagName==="BUTTON"||a.tagName==="INPUT"||a.tagName==="TEXTAREA"||a.isContentEditable||n.includes(a.id))return!0;if(a.id===s)return!1;a=a.parentElement}return!1}const _g=["o3-mini","o3-mini-high","o1-pro"],Ag=({composerController:t,disabled:s,clientThreadId:n,hideThinkButton:a})=>{const{prospectiveModelId:o}=Et(n),{activeSystemHints:r,isLoading:c}=ht(n),{value:i}=Ie("2868048419"),d=r.filter(x=>!x.composerBarButtonInfo&&x.systemHint!==R.Search&&(!i||x.systemHint!==R.PictureV2)&&(!a||x.systemHint!==R.Think)),p=hi(t),u=Un(t,n),l=o&&_g.includes(o);if(d.length===0&&!c||l)return null;const g={clientThreadId:n};function f(){w.logEventWithStatsig(D.composerSystemHintButtonHovered,"composer_system_hint_button_hovered",g)}function h(){w.logEventWithStatsig(D.composerSystemHintButtonClicked,"composer_system_hint_button_clicked",g)}return e.jsx(Mg,{systemHints:d,selectedHint:p,disabled:s,onHover:f,onOpen:h,onSelect:u})},Mg=({systemHints:t,selectedHint:s,disabled:n,onHover:a,onOpen:o,onSelect:r})=>{const c=V(),[i,d]=m.useState(!1),p=t.find(l=>l.systemHint==="contextual_answers")?.name,u=t.length===0?e.jsxs("div",{className:"mx-2 flex min-h-[40px] flex-col justify-center gap-2",children:[e.jsx("div",{className:"loading-results-shimmer h-9 w-full rounded-md bg-token-main-surface-secondary"}),e.jsx("div",{className:"loading-results-shimmer h-9 w-full rounded-md bg-token-main-surface-secondary"})]}):e.jsx(e.Fragment,{children:t.map(l=>e.jsx(X.Item,{className:"px-1 py-2",onClick:()=>r?.({hint:l,enable:l.systemHint!==s}),children:e.jsx(Di,{title:l.name,description:l.description,logo:l.logo,checked:l.systemHint===s,badge:l.systemHint===R.PictureV2})},l.systemHint))});return e.jsxs(X.Root,{open:i,onOpenChange:l=>{d(l),l&&o?.()},children:[e.jsx(Pg,{disabled:!!n,contextualAnswersHintNameIfPresent:p,children:e.jsx(Kd,{className:B(gu.toolsButton,"flex h-9 min-w-9 items-center justify-center rounded-full border border-token-border-light p-1 text-xs font-semibold text-token-text-secondary focus-visible:outline-black disabled:opacity-30 radix-state-open:bg-black/10 can-hover:hover:bg-token-main-surface-secondary dark:focus-visible:outline-white dark:can-hover:hover:bg-gray-700"),"data-opened":Ng(i),"aria-label":c.formatMessage({id:"oDAnGy",defaultMessage:"Use a tool"}),disabled:n,onPointerOver:a,onClick:l=>{l.preventDefault()},onFocusCapture:l=>{l.stopPropagation()},children:e.jsx(hu,{className:"pointer-events-none h-5 w-5"})})}),e.jsx(X.Portal,{children:e.jsx(X.Content,{alignOffset:-16,onCloseAutoFocus:l=>{l.preventDefault()},children:u})})]})},Pg=({disabled:t,children:s,contextualAnswersHintNameIfPresent:n})=>{const a=me(le.hasSeenComposerSystemHintButtonTooltip),o=me(le.hasSeenCaSystemHint),r=!t&&!a.isLoading&&a.eligible,c=!t&&!a.isLoading&&n&&!o.isLoading&&o.eligible,i=r?{announcementKey:le.hasSeenComposerSystemHintButtonTooltip,title:e.jsx(P,{id:"tTydhk",defaultMessage:"All your tools, in one handy place"}),onDismiss:a.markAsViewed,description:e.jsx(P,{id:"S+BFNe",defaultMessage:"Create a canvas, generate a picture, and more."})}:c?{announcementKey:le.hasSeenCaSystemHint,title:e.jsx(P,{id:"uaC1JM",defaultMessage:"Not finding internal information?"}),onDismiss:o.markAsViewed,description:e.jsx(P,{id:"TL/S+W",defaultMessage:"If ChatGPT didn't search your files automatically, type {hintName} or select it from the menu.",values:{hintName:e.jsx("span",{className:"whitespace-nowrap font-bold",children:'"/'+n+'"'})}})}:void 0;return i?e.jsx(ws,{show:!0,side:"bottom",theme:"bright",dismissOnOutsideClick:!0,badge:"new",sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",...i,children:s}):e.jsx(ze,{side:"top",sideOffset:0,label:t?e.jsx(P,{id:"uw9x80",defaultMessage:"Tools unavailable"}):e.jsx(P,{id:"mrYNGk",defaultMessage:"View tools"}),children:s})};function Ng(t){return t?"":null}const Eg=({composerController:t,systemHint:s,clientThreadId:n,connectionStatuses:a})=>{const o=Nt(),r=s.systemHint,c=Rt(r);if(!s.composerBarButtonInfo)return null;const i=a.every(d=>d.user_connection_details.activation_status==="inactive"&&d.user_connection_details.auth_status==="not_connected");return e.jsx(Np,{composerController:t,systemHint:s,composerBarButtonInfo:s.composerBarButtonInfo,clientThreadId:n,isDisabled:!1,showLabel:o,dropdownContent:i?e.jsx(ha,{}):void 0,splitButtonDropdownContent:!i&&c?e.jsx(ha,{}):void 0})},ha=()=>{const{connectionInstanceData:t,isLoading:s}=gn(),n=m.useMemo(()=>[...t?.connection_statuses??[]].sort(fu),[t]);return s?e.jsx("div",{className:"w-full min-w-[calc(100vw-1.5rem)] max-w-[calc(100vw-1.5rem)] p-3 md:min-w-[22rem]",children:e.jsx(Pm,{lines:4,size:"lg"})}):e.jsx(fe,{children:e.jsxs("div",{className:"w-full min-w-[calc(100vw-1.5rem)] max-w-[calc(100vw-1.5rem)] p-3 md:min-w-[22rem]",children:[e.jsx("div",{className:"px-2 py-2 text-sm font-medium text-token-text-tertiary",children:e.jsx(P,{id:"gkeRrW",defaultMessage:"Internal knowledge"})}),n.map(a=>e.jsx("div",{className:"px-2 py-3",children:e.jsx(xu,{title:a.connection_display_info.display_name,description:bu(a.user_connection_details.activation_status),icon:e.jsx("img",{src:a.connection_display_info.icon_url??"",alt:a.connection_display_info.display_name,className:"icon-lg"}),statusIndicator:e.jsx(Su,{connection:a})})},a.user_connection_details.connection_instance_id)),e.jsx("div",{className:"border-token-border-primary mb-2 mt-2 border-b"}),e.jsx(Ge,{color:"ghost",className:"w-full rounded-xl px-2 py-3",contentsFullWidth:!0,as:"link",to:"#settings/ConnectorSettings",children:e.jsxs("div",{className:"flex w-full flex-row items-center justify-start gap-4 text-start",children:[e.jsx("div",{className:"icon-lg",children:e.jsx(Ia,{})}),e.jsx("p",{className:"flex-1 text-sm font-medium text-token-text-primary",children:e.jsx(P,{id:"GPfRq5",defaultMessage:"Manage connectors"})})]})})]})})},Tg=({serverThreadId:t,getIsDisabled:s,composerController:n,onReset:a,onInfer:o})=>{const[r,c]=m.useState(!1),{isAutoSwitcherEnabled:i,inferenceDebounceTime:d}=Ua(),p=Jd(),u=m.useRef(null),l=Ga(({enableInferredJuice:C})=>C),g=i||l,f=m.useCallback(C=>{s()||!g||na.postAnonAware("/conversation/infer/prepare",{conversation_id:C??null,is_history_and_training_disabled:p}).then(_=>{u.current=_.conduit_token})},[s,g,p]);m.useEffect(()=>{f(t)},[t,f]);const h=m.useRef(o);h.current=o;const x=m.useRef(0),k=m.useRef(0),y=m.useCallback(hs(C=>{if(s())return;const _=++x.current,E=Date.now();c(E),na.postAnonAware("/conversation/infer",{prompt:C,conversation_id:t??null,is_history_and_training_disabled:p},{additionalHeaders:{"x-conduit-token":u.current??""}}).then(A=>{if(s()||k.current>_)return;k.current=_;const{juice:j}=A;h.current(j)}).finally(()=>{c(A=>A&&E<A?A:!1)})},d),[s]);return m.useEffect(()=>{if(!(!g||!(n instanceof Tn)))return n.subscribe("change",()=>{const{content:C}=n.getContentToSend();C?y(C):(u.current=null,a(),f(t),c(!1),++x.current,k.current=x.current)})},[g,s,n,y,o,a,t,p,f]),r!==!1},fa=48,xa=32,Rg=({clientThreadId:t,isTemporaryChat:s,placeholder:n,composerController:a,children:o,isExpandedByDefault:r=!1,onSubmit:c})=>{let i=null,d=null,p=[],u=[],l=null,g=[],f=null;m.Children.forEach(o,v=>{if(m.isValidElement(v))if(v.type===Ig){if(l!=null)throw new Error("PromptTextareaComposer only accepts a single app stack");l=v}else if(v.type===Hi){if(i!=null)throw new Error("PromptTextareaComposer only accepts a single submit button");i=v}else if(v.type===Fg){if(d!=null)throw new Error("PromptTextareaComposer only accepts a single header action");d=v}else v.type===Dg||v.type===Oi?p.push(v):v.type===Lg?u.push(v):v.type===dn?g.push(v):v.type===Ui&&(f=v)});const[h,x]=m.useState(r),{shouldShowResearchText:k}=ft(t),y=m.useRef(!1),C=ys(),_=m.useSyncExternalStore(v=>{const b=a.subscribe("focus",v),F=a.subscribe("blur",v);return()=>{F(),b()}},()=>a.isFocused(),()=>!1);m.useEffect(()=>{if(!y.current)return a.subscribe("input",()=>{y.current=!0})},[a]),m.useEffect(()=>{r&&x(!0),_&&!h&&x(!0)},[_,h,r]);const E=v=>{const b=F=>{r||y.current||v?.contains(F.target)||x(!1)};return document.addEventListener("click",b),()=>{document.removeEventListener("click",b)}},A=v=>{v.preventDefault(),c(v)},j=v=>{v.preventDefault(),a.focus()},I=p.length>0,H=u.length>0;return e.jsxs("form",{ref:E,className:"w-full",onSubmit:A,onPointerDown:j,"data-type":"unified-composer",children:[e.jsxs(Bg,{isTemporaryChat:s,clientThreadId:t,children:[e.jsxs(U.div,{transition:C?Te:ls,className:"relative flex w-full flex-auto flex-col",children:[g.length>0&&e.jsx("div",{className:"mb-4 flex flex-col gap-2",children:g}),e.jsxs("div",{className:"relative ml-1.5 grid grid-cols-[auto_minmax(0,1fr)]",children:[e.jsx("div",{className:"items-top flex justify-center",children:e.jsx(U.div,{initial:{opacity:h?1:0},animate:{opacity:h?1:0},exit:{opacity:0},transition:C?Te:ds,children:d})}),e.jsx(U.div,{initial:{marginBottom:-20,translateX:h?0:xa},onPointerDown:v=>v.stopPropagation(),animate:{translateX:h?0:xa},style:{translateY:-7},transition:C?Te:ls,className:"relative flex-auto bg-transparent pl-2 pt-0.5",children:e.jsx(_i,{enabled:k,composerController:a,visualTreatment:"vanguard",children:e.jsx(Va,{composerController:a,placeholder:n,vanguard:!0})})})]}),e.jsx("div",{className:"justify-content-end relative ml-2 flex w-full flex-auto flex-col",children:e.jsx("div",{className:"flex-auto"})}),e.jsx(U.div,{initial:{height:h&&I?fa:0},animate:{height:h&&I?fa:0},transition:C?Te:ls})]}),(I||!!i)&&e.jsx("div",{className:"bg-primary-surface-primary absolute bottom-[9px] left-[17px] right-0 z-[2] flex items-center",children:e.jsxs("div",{children:[I&&h&&e.jsx("div",{className:"flex items-center gap-2 max-xs:gap-1",children:p}),e.jsxs("div",{className:"absolute bottom-1 right-3 flex items-center gap-2",children:[H&&e.jsx("div",{className:"relative ml-1",children:u}),i]})]})}),e.jsx("div",{className:"absolute left-4 top-3 ml-[1px] flex items-center pb-px",children:e.jsx(fe,{children:!h&&l})})]}),e.jsxs(Cs,{open:!!f,children:[e.jsx(hn,{className:"w-full"}),e.jsx(js,{children:e.jsx(ks,{side:"bottom",align:"start",sideOffset:12,onOpenAutoFocus:v=>v.preventDefault(),children:f})})]})]})},Bg=({children:t,isTemporaryChat:s,clientThreadId:n})=>{const a=Ai(n);return e.jsxs(Ha,{className:B("flex w-full cursor-text flex-col items-center justify-center rounded-[28px] border border-token-border-xlight contain-inline-size","overflow-clip shadow-sm dark:!shadow-none sm:shadow-lg",s?"dark bg-[#303030]":"bg-token-main-surface-primary dark:bg-[#303030]"),children:[e.jsx("div",{className:"relative flex w-full items-end py-3 pl-3",children:t}),e.jsx(fe,{children:a&&e.jsx(Pi,{clientThreadId:n,isVanguard:!0})})]})},Ig=({children:t})=>e.jsx(U.div,{onPointerDown:s=>{s.stopPropagation(),s.preventDefault()},children:t}),Hi=({children:t})=>e.jsx("div",{className:"ml-auto",onPointerDown:s=>s.stopPropagation(),children:t}),Oi=({children:t})=>t?e.jsx(e.Fragment,{children:t}):null,Dg=({children:t})=>e.jsx("div",{onPointerDown:s=>s.stopPropagation(),children:t}),Lg=({children:t})=>e.jsx("div",{onPointerDown:s=>s.stopPropagation(),children:t}),Ui=({children:t})=>e.jsx("div",{onPointerDown:s=>s.stopPropagation(),children:t}),Fg=({children:t})=>e.jsx("div",{onPointerDown:s=>s.stopPropagation(),children:t}),dn=({children:t,width:s="full"})=>e.jsx("div",{className:B(s==="fit"?"w-fit":"w-full"),onPointerDown:n=>n.stopPropagation(),children:t});function Hg({clientThreadId:t,uploadType:s,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:a,attachmentsProductFeature:o,getInputProps:r,openFileDialog:c,onOauthRedirect:i,historyDisabled:d,isNested:p,isDisabled:u,highlightTooltip:l,disabledReason:g,currentModelName:f,showLabel:h,showUpsell:x,hideBorder:k,isSmall:y,visualTreatment:C}){const _=En(),{gdriveStatus:E,o365Status:A}=Da(),j="h-[20px] w-[20px]",I=d?"text-white":l?"text-brand-blue-800":"",H=x?e.jsx(gs,{"aria-label":"",className:B(j,I)}):e.jsx(gs,{"aria-label":"",className:B(j,I)}),v=(E!=="false"||A!=="false"||_||C==="vanguard")&&!x,b=Xd(),F=C==="vanguard"&&!b,O=v?e.jsx(Fi,{hideBorder:k,isSmall:y,clientThreadId:t,icon:H,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:a,attachmentsProductFeature:o,onOauthRedirect:i,uploadType:s,openFileDialog:c,isNested:p,getInputProps:r,isDisabled:F?!1:u,highlightTooltip:l,disabledReason:g,currentModelName:f,visualTreatment:C}):e.jsx(Ii,{isSmall:y,hideBorder:k,clientThreadId:t,uploadType:s,openFileDialog:c,getInputProps:r,showLabel:h,showUpsell:x,icon:H,isDisabled:u,highlightTooltip:l,disabledReason:g,currentModelName:f});return p?O:e.jsx("div",{className:"relative",children:e.jsx(Li,{showBackground:l,className:"bg-brand-blue-800/20",children:O})})}const Og=({clientThreadId:t,currentModel:s,uploadType:n,modelSupportedImageMimeTypes:a,modelAcceptedMimeTypes:o,modelProductFeatures:r,getEditorGizmoId:c,onOauthRedirect:i,disabledReason:d,isTemporaryChat:p,isDisabled:u,highlightTooltip:l,showLabel:g,showUpsell:f,numRemainingFiles:h,visualTreatment:x})=>{const k=V(),y=Tt(),{handleFileAccepted:C}=Vn(k,n,a,"mouse",c,r?.attachments),{getInputProps:_,open:E}=An({disabled:u,noClick:!0,onDropAccepted:C,onDropRejected:A=>Wn(A,k,y,n),multiple:!0,maxSize:Mn,maxFiles:h,...wn(o)});return e.jsx(Hg,{isSmall:!0,hideBorder:!0,isDisabled:u,highlightTooltip:l,onOauthRedirect:i,visualTreatment:x,attachmentsProductFeature:r?.attachments,clientThreadId:t,uploadType:n,modelAcceptedMimeTypes:o,modelSupportedImageMimeTypes:a,getInputProps:_,openFileDialog:E,historyDisabled:p,showLabel:g,showUpsell:f,disabledReason:d,currentModelName:s?.title??""})},Ug=({clientThreadId:t,serverThreadId:s,composerController:n,pendingFiles:a,isUploadDisabled:o,highlightUploadTooltip:r,hasFiles:c,conversationMode:i,placeholder:d,isTemporaryChat:p,layoutMode:u,state:l,inputState:g,disableReason:f,gizmoId:h,currentModel:x,category:k,replyRegions:y,uploadButtonDisabledReason:C,keepExpanded:_=!1,getEditorGizmoId:E,onOauthRedirect:A,onSubmit:j,visualTreatment:I,legacyFooterActions:H,legacySuggestionsPopoverContent:v})=>{const[b,F]=Ko(!1);We();const O=pt.useState(({persistedSystemHints:G})=>G),N=Array.from(O)[0],{state:M}=ft(t),[z=null,te,q]=m.useMemo(()=>[jn(x,i),kn(x,i),_n(x,i)],[x,i]);ht(t);const oe=pt.useState(({availableHints:G})=>G),pe=dt(!1),$=wt(G=>G.setManualModelSelection),J=wt(G=>G.threads[t]?.isManualModelSelection),ae=m.useMemo(()=>{const G=x?.id??"";return _a.includes(G)?"low":Aa.includes(G)?"medium":Ma.includes(G)?"high":"low"},[x?.id]),[ue,de]=Ko(ae);m.useEffect(()=>{de(ae)},[ae,de]);const K=(G,Pe=!1)=>{Pe||F(!0),!(G===ue()&&Pa.includes(x?.id??""))&&(de(G),$(t,!1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{const Ve=Qs[G];pe({location:"PromptTextarea",modelId:Ve})})}))};me(le.ModelPickerMoved),Tg({serverThreadId:s,composerController:n,getIsDisabled:m.useCallback(()=>!!(b()||I==="vanguard"&&(J||N)),[J,N,b,I]),onReset:()=>{F(!1),J||K("low",!0)},onInfer:G=>{K(G,!0)}});const re=za(G=>G.selectedApps),Ce=Wa()&&re.length>0,_e=c||Ce,se=_||!!N||y&&y.length>0||_e||oe.length<3;return ms(x,i,O),e.jsxs(Rg,{clientThreadId:t,isTemporaryChat:p,placeholder:d,composerController:n,isExpandedByDefault:se,onSubmit:j,children:[y&&y.length>0&&e.jsx(dn,{width:"full",children:e.jsx(Oa,{replyRegions:y})}),_e&&e.jsx(dn,{width:"fit",children:e.jsx(tn,{files:a,selectedApps:re,className:"-ml-1.5 flex flex-nowrap gap-2 overflow-x-auto p-1.5"})}),[...H?.map((G,Pe)=>e.jsx(Oi,{children:G},`legacy-footer-action-${Pe}`))??[],e.jsx(Ui,{children:v},"legacy-suggestions-popover")],e.jsx(Hi,{children:e.jsx(Fa,{isSmall:!0,inputState:g,state:l,onSubmit:j,composerController:n,clientThreadId:t,gizmoId:h,disableReason:f,useStartButtonText:M==="clarify"})})]})},Gg=Rn(()=>Bn(()=>import("./jwwhrtj6dkdymig3.js"),__vite__mapDeps([10,1,11,3,4,2,5,8,12,13,14])).then(t=>t.ImageGenComposer)),zg=1,Wg=3e3;function Vg({onCreateNewCompletion:t,onContinueGenerating:s,account:n,currentModelId:a,currentModelConfig:o,modelCategories:r,areModelsLoading:c,clientThreadId:i,isNewThread:d,isCompletionInProgress:p,className:u,disabled:l=!1,disabledReason:g,canPause:f=!1,canContinue:h=!1,isInteractableSharedThread:x,composerContainerRef:k,onComposerInput:y,onComposerChange:C,onAutocompleteSelect:_,headerClassName:E,hideHeader:A,onTaggingDropdownOpen:j,onTaggingDropdownClose:I}){Jo.markStart("PromptTextarea"),Jo.markRendered("PromptTextarea");const H=ni(),v=m.useRef(null),b=_s(),F=vu(),O=n?.isFree(),N=n?.isTeam(),{isUnauthenticated:M}=ye(),z=V(),te=Tt(),q=Pn(),oe=yu.useStore(),[pe,$]=ce(i,S=>[Q.getCurrentLeafId(S),Q.getRequestId(S)]),[J]=Gr(),{gizmoEditorData:ae,mode:ue,getGizmoId:de}=Cn(),K=Qd(),re=Nt(),Ce=Zd(),_e=Cu(),se=ai(i),G=!!Qa(),Pe=ju.useIsEnabled(i),Ve=!!In(),{setThreadSystemHintMode:Dt,clearSystemHintModeTrigger:qe,getSystemHintModeTrigger:Lt,clearAllSystemHintModeTriggers:Ms}=We(),ie=Bt(),{state:st}=ft(i),je=ie.has(R.Search),Ps=ie.has(R.Think),L=ie.has(R.PictureV2),Ne=ie.has(R.Research),{activeSystemHints:Ft}=ht(i),Gi=Ft.length>0,qn=Ft.find(S=>S.systemHint===R.ContextualAnswers),$n=ku(),{connectionInstanceData:Ns,isLoading:zi}=gn({skip:!$n}),{selectedSources:Yn}=Mi(i),[xt,Kn]=m.useState(!1),Es=m.useRef(0),Ts=m.useRef(!1),Jn=r?.find(S=>S.defaultModel===a),Xn=null;let Y=gt(i),$e=Y&&"gizmo"in Y?Y.gizmo:void 0;const Rs=bn($e?.gizmo.id),Wi=Jm(),Vi=wu(),Ht=_u(),[xe,Ot]=m.useState(null);xe!==null&&(Y={gizmo:xe,gizmo_id:xe.gizmo.id,kind:Me.GizmoInteraction},$e=xe);const bt=ms(o,Y,ie),qi=As(),Qn=oi(H).flags,Ut=Qn?.includes(fs.NoAuthEnableFileUploads),{isUXUpdatesEnabled:nt,reasoningSliderType:Zn}=Ua(),Bs=Zn!=="none",$i=nt&&ie.size===0,{prospectiveModelId:eo}=Et(i),Yi=O||c&&eo&&!Cm.includes(eo),to=!l&&(bt!==Qe.None||$i||Yi)&&(!M||Ut),De=kn(o,Y),Is=_n(o,Y);let ge=en(S=>S.files);const[Gt]=m.useState(()=>Au());ue==="magic"?ge=ge.filter(S=>S.gizmoId!=null):ge=ge.filter(S=>S.gizmoId==null);const so=Mu(),Le=ge.length>0||so,no=en(Ju.hasUploadInProgress),Ds=za(S=>S.selectedApps),oo=Wa()&&Ds.length>0,Ki=Le||oo,Ji=Pu(i),Ls=b.useState(S=>{const W=vm(S);return typeof o?.maxTokens=="number"&&W>o.maxTokens}),ao=b.useState(S=>!S.isEmpty()),zt=!Ls&&!no&&(ao||Le),io=(bt===Qe.Multimodal?vn:yn)-ge.length,ro=io<=0,ot=zt&&!l&&!Ve&&(!p||Ht),[lo,Xi]=m.useState(!1),{value:Qi,isLoading:Zi}=Ie("3780975974"),{targetedContent:co,setTargetedContent:Wt}=Nu(),ke=co?.isFocusedViewContent&&!_e?void 0:co,{rebaseSystemMessageContent:uo}=Ga(),mo=Y==null||Y?.kind===Me.PrimaryAssistant||Y?.kind===Me.GizmoInteraction&&Rs,{getUpsellLabelType:er,getUpsellShowsAttach:tr,getShowUpsellReason:sr}=La(),Fs=Gi&&mo,[nr,or]=m.useState(!1),ar=!M&&mo&&(!N||!zi),[Fe,po]=m.useState(!1);m.useEffect(()=>{if(!F?.id)return;const S=aa.getAndReset(F.id,se);S&&b.setText(S.inputText)},[F?.id,se,b]),m.useEffect(()=>{const S=J.get("prompt")??"";b.getCurrentText().length===0&&S.length>0&&b.setText(S)},[b,J]),m.useEffect(()=>{lo!==ot&&(Xi(ot),ot&&em(!0).then(S=>{Eu.startEnforcement(S),tm.startEnforcement(S)}))},[ot,lo,Y?.kind,K]);const Vt=jn(o,Y),{handleFileAccepted:ir}=Vn(z,ms(o,Y,ie),De,"mouse",de,Vt?.attachments),{getInputProps:rr,open:lr}=An({disabled:l||!to||ro,noClick:!0,onDropAccepted:ir,onDropRejected:S=>Wn(S,z,te,bt),multiple:!0,maxSize:Mn,maxFiles:io,...wn(M?De:Is)}),go=oa(Gt),{value:cr}=Ie("1988730211"),ho=m.useCallback(()=>{b.eraseContent(),go.clearMessages(),b.resize(zg),b.usedDictation=!1;for(const S of ge)cs.remove(q,S.tempId,"none");Tu.markAllAsSent()},[b,go,ge,q]),ur=m.useContext(Ru).type===Bu.ImageGen,dr=Ae("1064007944")?.value,qt=async(S,W)=>{if(S.preventDefault(),ur&&Xu.close(),l||!zt&&!W||!Y||Ze(i)?.isLoading!==!1)return;if(Ht&&Ye==="streaming"){const ne=Q.getCurrentNode(Ze(i)).message,qs=am(ne).length;w.logEventWithStatsig(D.conversationStreamInterrupted,"chatgpt_web_conversation_stream_interrupted",{client_thread_id:i,interrupted_message_length:qs})}const be=$&&im($);if(Ht&&be&&!be.turnTracker.isStreamOpen)return;Kn(!0),Wi?.(),Vi();const he=b.getContentToSend(),Ke=jm(he.content),yt=Qu({namespace:Zu.CompletionRequest,opts:{expectedTimingLogs:[{name:"prompt_submitted",expectedInMs:3e3}],debug:!1}});yt.reset();const{content:zs,attachments:Do}=ed(q,Ke,o,Y,ie),Lo=[];if(oo){const ne=await td(Ds);ne&&Lo.push(rm(ne))}const Fo=[];uo&&Fo.push(lm(uo));const Ws={...Y};"gizmo"in Ws&&delete Ws.gizmo;let ts=b.getSystemHints();ie.size>0&&(ts=Array.from(ie));const Ho=Lt(R.Search),Fr=je?Ho??ii.CONVERSATION_COMPOSER_WEB_ICON:void 0,Oo=sd(),Uo=nd(),Hr=b.usedDictation,Or=cm(zs,{...Do.length>0&&{attachments:Do},...xe&&{gizmo_id:xe.gizmo.id},...Yn&&{caterpillar_selected_sources:Array.from(Yn.values())},...ts.length>0&&{system_hints:ts},...!!he.metadata&&{serialization_metadata:he.metadata},...Oo.length>0&&{canvas:{user_created_textdocs:Oo.map(ne=>({user_created_temp_textdoc_id:ne.tempTextdocId,type:ne.type,title:ne.title,content:ne.content,create_source:ne.create_source,remix_shared_textdoc_id:ne.remixSharedTextdocId}))}},...Object.keys(Uo).length>0&&{__internal:{search_settings:Uo}},dictation:Hr});let Ee={sourceEvent:S,completionMetadata:{conversationMode:Ws,systemHints:ts,searchSource:Fr},promptMessage:Or,prependMessages:Lo,appendMessages:Fo,profiler:yt};const Vs={};if(Ee=od(Ee),cr&&Ee.completionMetadata?.systemHints){let ne=!1;Ee.completionMetadata.systemHints=Ee.completionMetadata.systemHints.filter(qs=>qs===R.Search?(ne=!0,!1):!0),ne&&(Vs.forceUseSearch=!0)}Pe&&(Vs.enableMessageFollowups=!0),Ee.extraStreamParams=Vs,ke?.createNewCompletionParams&&(Ee=await ke.createNewCompletionParams(Ee)),yt.logTiming("request_params_ready"),t(Ee),ke?.onCreateCompletion?.({serverThreadId:se,currentLeafId:pe}),ke?.shouldPersistAcrossMessages!==!0&&Wt(void 0),Zs.hideThreadHeader();for(const ne of ge)ne.status===ad.Ready&&oe.addFile(ne);ho(),Kn(!1),je&&Ho&&qe(R.Search),nt&&!Ne&&!je&&!(L&&dr)&&Ms()},mr=m.useRef(qt);m.useEffect(()=>{mr.current=qt});const pr=S=>{Wt(S.targetedReply),S.targetedReply&&(b.focus(),w.logEventWithStatsig(D.targetedReplyButtonClicked,"chatgpt_targeted_reply_button_clicked",{conversationId:se,sourceMessageId:S.messageId}))},fo=m.useCallback(()=>{ke?.onCleared?.({serverThreadId:se,currentLeafId:pe}),Wt(void 0),b.focus()},[pe,se,ke,Wt,b]),xo={Enter:{validator:S=>{const W=S.isComposing||S.keyCode===229;return!(Yt&&Ts.current)&&(S.metaKey||(re||um)&&!S.shiftKey&&!W)},handler:S=>{if(!ot){Ls&&te.danger("The message you submitted was too long, please submit something shorter.",{hasCloseButton:!0});return}S.preventDefault(),qt(S)}},Escape:{validator:S=>!S.isComposing,handler:S=>{f&&p&&(Xo(i),w.logEvent(D.pauseCompletion,{threadId:os(i),currentLeafId:Q.getCurrentNode(Ze(i)).message.id,eventSource:"keyboard"})),S.target.value===""&&fo()}}},St=m.useRef(xo);St.current=xo;const $t=Iu(o?.tags,Y?.kind),{showTaggingDropdown:Hs,isFocused:gr,autocompletions:He,matchaData:hr}=oa(b.store),Yt=gr&&He.length>0,at=$t&&Hs&&!Rs,bo=b.isReady();m.useEffect(()=>b.subscribe("keydown",S=>{b.acceptLegacyKeydown()&&St.current[S.key].validator(S)&&St.current[S.key].handler(S);const be=b.getCurrentText();if(S.key==="@"){const he=b.getSelectionStart(),Ke=be.substring(0,he);(!Ke||/\s$/.test(Ke)||he===0)&&setTimeout(()=>b.setShowTaggingDropdown(!0),10)}else Hs&&b.setShowTaggingDropdown(!1);S.key==="Escape"&&(Ot(null),b.setAutocompletions([])),je&&S.key==="Escape"&&Dt(R.Search,!1,{clientThreadId:i})}),[b,bo,Hs,ie,je,Dt,i]),m.useEffect(()=>{const S=Object.fromEntries(Object.keys(St.current).map(W=>[W,he=>{const Ke=St.current[W];if(!Ke||b.acceptLegacyKeydown())return!1;const{validator:yt,handler:zs}=Ke;return yt(he)?(zs(he),!0):!1}]));b.registerKeyHandlers(S)},[b,bo]),m.useEffect(()=>b.subscribe("paste",S=>{Du({filePickerStore:q,event:S,intl:z,toaster:te,clientThreadId:i,conversationMode:Y,currentModelConfig:o,getEditorGizmoId:de,modelSupportedImageMimeTypes:De,persistedSystemHints:ie})}),[z,i,Y,o,de,De,b,te,q,ie]);const So=S=>{G||Ot(S),b.trimLeadingText("@"),on(),b.setShowTaggingDropdown(!1)},fr=Lu(i,Gt,De,Vt?.attachments),xr=m.useCallback(S=>{S.preventDefault(),Xo(i),w.logEvent(D.pauseCompletion,{threadId:os(i),currentLeafId:Q.getCurrentNode(Ze(i)).message.id,eventSource:"mouse"}),on()},[i]),Kt=m.useCallback(()=>{aa.set(F?.id,se,b.getCurrentText())},[se,F?.id,b]);m.useEffect(()=>{ae||!xt&&!Fu()&&b.focus()},[xt,b]),m.useEffect(()=>{if(De.length>0)for(const W of ge)ym(W.fileSpec?.mimeType,Is)||cs.remove(q,W.tempId,"none");else cs.reset(q)},[a,q]),m.useEffect(()=>{(!$t&&xe||G)&&Ot(null)},[$t,xe,G]);const{layer:br}=_t("4031588851"),{layer:vo}=_t("3637408529"),Sr=vo.get("is_in_composer_text_exp",!1),vr=vo.get("composer_text","MESSAGE_CHATGPT"),yr=br.get("composer_text","MESSAGE_CHATGPT"),Cr=Sr?vr:yr,[Jt,jr]=(()=>{switch(g){case"workspaceDisallowsGizmo":return[Z.disallowedByWorkspacePlaceholder,!0];case"noModelsAvailable":return[Z.noModelsAvailablePlaceholder,!0];case"requiresPluginsToBeInstalled":return[Z.requiresPluginsToBeInstalled,!0];case"loadingPlugins":return[Z.loading,!0];case"noTestGizmoId":return[Z.noTestGizmoId,!0];default:{if(x)return[Z.placeholderWithName,!1];if(ke?.placeholderTextOverride!=null)return[ke.placeholderTextOverride,!1];if(st==="initial"||st==="recurrent")return[Z.deepResearchPlaceholder,!1];if(st==="clarify")return[Z.researchSuggestionInitial,!1];switch(Cr){case"BLANK":return[null,!1];case"ASK_ANYTHING":return[Z.placeholderAskAnythingVariant,!1];case"ASK_CHATGPT_ANYTHING":return[Z.placeholderAskNameAnythingVariant,!1];default:return[Z.placeholderWithName,!1]}}}})(),Os=Rs?d?z.formatMessage(Hu.newChatInProject):Jt?z.formatMessage(Jt,{name:"ChatGPT"}):"​":Jt?z.formatMessage(Jt,{name:ae!=null?ue==="magic"?Ou:ae.name||"GPT":$e?.gizmo.display.name??"ChatGPT"}):"​";m.useEffect(()=>b.subscribe("input",()=>{Uu.getState().isThreadHeaderVisible&&Zs.hideThreadHeader()}),[b]),m.useEffect(()=>b.subscribe("input",()=>{Es.current=performance.now(),y?.()}),[b,y]),m.useEffect(()=>{if(C)return b.subscribe("change",()=>{C()})},[b,C]);const kr=Qi||Zi||sr(),yo=Gu()&&!!He.find(S=>!!S.requires_file_upload),wr={clientThreadId:i,uploadType:bt,modelAcceptedMimeTypes:Is,modelSupportedImageMimeTypes:De,attachmentsProductFeature:Vt?.attachments,getInputProps:rr,openFileDialog:lr,historyDisabled:Ce,onOauthRedirect:Kt,highlightTooltip:yo&&!Le},Xt=[],Co=[],jo=!l&&!ro&&(to||qi!=null)&&!je,ko=tr(),_r=!M||ko||Ut,wo=bt===Qe.None?Re.ModelNotSupported:Ps?Re.ThinkModeInUse:je?Re.SearchModeInUse:void 0;if(_r){const S=e.jsx("div",{style:{viewTransitionName:"var(--vt-composer-attach-file-action)"},children:e.jsx(jg,{...wr,showLabel:er()==="all",showUpsell:ko&&!Ut,showMenuForNoAuth:Ut,isDisabled:!jo||Fe,disabledReason:wo,currentModelName:o?.title??""})},"file-upload-button");Xt.push(S),Co.push(S)}const Oe=[],_o=Nn();let Qt="bottom";_o?Qt="bottom":d&&(Qt="centered"),Oe.push(e.jsx(Hp,{account:n,clientBootstrapFlags:Qn,features:K,currentModelConfig:o,hasFiles:Le,isDisabled:Fe||Le,clientThreadId:i,composerController:b},"search")),Bs&&Oe.push(e.jsx("div",{className:"ml-1 flex [--pill-color:var(--text-secondary)] [--pill-font-size:13px]",onPointerDown:S=>S.stopPropagation(),children:e.jsx(Xp,{clientThreadId:i,layoutMode:Qt,currentModel:o,category:Jn,type:Zn,shouldShowModelPicker:!0})},"reasoning-level"));const{value:Ar}=Ae("1830177352");Bs||(Oe.push(e.jsx(Dp,{clientThreadId:i,gizmoId:$e?.gizmo.id,composerController:b,isDisabled:Fe},"reason")),Ar&&Oe.push(e.jsx(Rp,{clientThreadId:i,showLabel:kr,isDisabled:Fe},"deep-research")),Oe.push(e.jsx(ag,{clientThreadId:i,composerController:b,isDisabled:Fe,currentModelConfig:o},"shiba"))),qn&&Ns&&Ns.connection_statuses.length>0&&Oe.push(e.jsx("div",{style:{viewTransitionName:"var(--vt-composer-search-action)"},children:e.jsx(Eg,{composerController:b,systemHint:qn,clientThreadId:i,connectionStatuses:Ns.connection_statuses})},"contextual-answers")),ar&&Oe.push(e.jsx("div",{style:{viewTransitionName:"var(--vt-composer-system-hint-action)"},children:e.jsx(Ag,{composerController:b,clientThreadId:i,disabled:Fe,hideThinkButton:Bs})},"system-hint-button")),Xt.push(...Oe);const Us=jr?"disabled":"default",Ao=p&&f,Mr=sm(),Pr=!ot||xt||Mr||!1,Gs=km(no,ao,Ls,Ji),Ye=Ao?"streaming":Pr?"disabled":"idle",vt=m.useRef(null),it=m.useRef(null),{value:Nr}=Ae("222560275"),Er=Nr||a&&!a.startsWith("o1")&&!a.startsWith("o3");m.useEffect(()=>{const S=()=>{vt.current!=null&&dm.addAction("composer_state_disabled",{threadId:os(i),disabledReason:vt.current})};if(zt&&Ye==="disabled"){let W="unknown";l?W=g??"component_disabled_unknown":p?W="completion_in_progress":Ve?W="thread_hard_blocked":xt&&(W="starting_new_completion_request"),vt.current!==W&&(it.current&&clearTimeout(it.current),it.current=setTimeout(S,Wg)),vt.current=W}else vt.current=null;return()=>{it.current&&(clearTimeout(it.current),it.current=null)}},[i,zt,Ye,l,g,p,Ve,xt]);const Zt=[];if(ke?.label&&Zt.push({type:ke.type,value:ke.label,onRemoveRegion:fo}),xe!==null){const S=!!xe.gizmo.tags?.includes(vs.FirstParty);Zt.push({type:"mention",value:xe.gizmo.display.name,icon:e.jsx(di,{isFirstParty:S,src:xe.gizmo.display.profile_picture_url,className:"icon-md"}),onRemoveRegion:()=>{Ot(null),b.focus()}})}m.useEffect(()=>{(!He||He.length===0||!Yt)&&(Ts.current=!1)},[He,Yt]);const Tr=(S,W,be)=>{Ts.current=S>=0,W&&b.setText(be?`${be.title}${be.body}`:"")},Mo=Yt&&He&&He.length>0&&!at&&!Ne&&!b.hasMultipleLines()&&b.canShowAutocompletion();m.useEffect(()=>{at?j?.():I?.()},[at,j,I]);const es=S=>{if(Es.current>0){const W=performance.now()-Es.current;id.hist(rd.DEFAULT,"final_user_input_to_submit_ms",[],W)}Ye==="streaming"&&(!Ht||b.isEmpty())?xr(S):qt(S)},Rr=zu(o,Fn.Canvas),{value:Br}=Ie("61299031"),Ir=Wu(),Dr=Rr&&Br&&!Ir&&!so&&!_o;m.useEffect(()=>{},[Xn,b]),m.useEffect(()=>{const S=os(i);if(!S)return;const W=n?.normalizedAccountUserId;if(!W)return;const be=hs(()=>{const he=b.getContentToSend().content;he===""?nm(S):om(S,he,W)},1e3);return b.subscribe("change",be)},[n,i,b,se]);const Po=e.jsx(Zp,{canUseInlineTagging:$t,isDisabled:l,clientThreadId:i,currentLeafId:pe,currentRequestId:$,canContinue:h,composerController:b,isNewThread:d,onCreateNewCompletion:t,onContinueGenerating:s,onResetState:ho,conversationMode:Y,isShowingAutocomplete:!!Mo}),No=!Ao&&Y!=null&&Er&&Vu.includes(Y.kind)&&e.jsx(qu,{clientThreadId:i,onTargetedReply:pr}),Eo=Mo&&e.jsx("div",{className:B("absolute left-0 z-[-1] box-border w-full pl-0 max-lg:bottom-full lg:top-full",nt?"bg-transparent":"bg-token-main-surface-primary"),children:e.jsx(_m,{suggestions:He,composerController:b,onSelect:_,onChange:Tr})}),To=e.jsx(ld,{composerController:b,parsedDocumentHandler:fr}),Ro=!A&&e.jsx(Ci,{className:E}),Bo=e.jsx($u,{modelSupportedImageMimeTypes:De,uploadType:Qe.Multimodal,attachmentsProductFeature:Vt?.attachments}),Lr=e.jsxs(e.Fragment,{children:[at&&e.jsx(ca,{onClick:S=>So(S),onClose:()=>{b.setShowTaggingDropdown(!1),b.focus()}}),Fs&&e.jsx(pa,{composerController:b,clientThreadId:i})]}),{isImageGenEditor:Io}=Yu();return!$n&&Xn==null&&!Io?e.jsxs(Qo.Provider,{value:Gt,children:[e.jsx(Zo,{onOauthRedirect:Kt,children:e.jsxs("div",{className:`relative z-[1] flex max-w-full flex-1 flex-col ${nt?"":"h-full"}`,children:[Ro,e.jsx(Ug,{visualTreatment:nt?"vanguard":"legacy",hasFiles:Le,pendingFiles:ge,isUploadDisabled:!jo,clientThreadId:i,serverThreadId:se,getEditorGizmoId:de,highlightUploadTooltip:yo&&!Le,disableReason:Gs,uploadButtonDisabledReason:wo,currentModel:o,category:Jn,layoutMode:Qt,conversationMode:Y,onOauthRedirect:Kt,state:Ye,inputState:Us,gizmoId:$e?.gizmo.id,isTemporaryChat:Ce,placeholder:Os,composerController:b,onSubmit:es,replyRegions:Zt,keepExpanded:d||!nt,legacyFooterActions:Xt,legacySuggestionsPopoverContent:Lr}),Eo]})}),To,Po,No,Bo]}):e.jsxs(Qo.Provider,{value:Gt,children:[e.jsx(Zo,{onOauthRedirect:Kt,children:e.jsx("form",{className:u,onSubmit:es,children:e.jsxs("div",{className:"relative z-[1] flex h-full max-w-full flex-1 flex-col",children:[Ro,e.jsxs("div",{ref:k,className:"group relative z-[1] flex w-full items-center",style:{"--force-hide-label":nr?"none":"block"},children:[e.jsxs(Cs,{open:at||Fs,children:[e.jsx(hn,{className:"w-full",children:Io?e.jsx(Gg,{type:Ce?"temporary":"default",ref:v,placeholder:Os,inputState:Us,composerController:b,leftSideActions:Co,state:Ye,onSubmit:es,renderFiles:Le&&e.jsxs(e.Fragment,{children:[ue==="magic"&&e.jsx("div",{className:"m-2 mb-0 rounded-lg bg-token-main-surface-secondary p-2 text-xs text-token-text-secondary",children:e.jsx(P,{...Z.gizmoKnowledgeWarning})}),e.jsx(tn,{files:ge,className:"-ml-1.5 flex flex-nowrap gap-2 overflow-x-auto p-1.5"})]}),clientThreadId:i,gizmoId:$e?.gizmo.id,disableReason:Gs,modelId:a,controlsDisabled:Fe,setControlsDisabled:po}):e.jsx(kg,{type:Ce?"temporary":"default",ref:v,replyRegions:Zt,placeholder:Os,inputState:Us,setIsComposerOverflowing:or,composerController:b,matchaData:hr,leftSideActions:Xt,topRightAction:Dr&&e.jsx(Ku,{composerRef:v,composerController:b,clientThreadId:i}),state:Ye,onSubmit:es,renderFiles:Ki&&e.jsxs(e.Fragment,{children:[ue==="magic"&&e.jsx("div",{className:"m-2 mb-0 rounded-lg bg-token-main-surface-secondary p-2 text-xs text-token-text-secondary",children:e.jsx(P,{...Z.gizmoKnowledgeWarning})}),e.jsx(tn,{files:ge,selectedApps:Ds,className:"-ml-1.5 flex flex-nowrap gap-2 overflow-x-auto p-1.5"})]}),clientThreadId:i,gizmoId:$e?.gizmo.id,disableReason:Gs,modelId:a,controlsDisabled:Fe,setControlsDisabled:po})}),e.jsx(js,{children:e.jsxs(ks,{side:"bottom",align:"start",sideOffset:12,onOpenAutoFocus:S=>S.preventDefault(),children:[at&&e.jsx(ca,{onClick:S=>So(S),onClose:()=>{b.setShowTaggingDropdown(!1),b.focus()}}),Fs&&e.jsx(pa,{composerController:b,clientThreadId:i})]})})]}),Eo]}),To,Bo]})})}),Po,No]})}const ph=({clientThreadId:t,isNewThread:s,isGizmoThread:n,isProjectThread:a,isModelLoaded:o,currentModelId:r,onRequestCompletion:c,composerContainerRef:i,shouldUseUnifiedComposer:d,isVanguardUxEnabled:p})=>{const u=_s(),l=m.useContext(mm),g=pm(l),f=cd();ud(u);const h=e.jsxs(e.Fragment,{children:[e.jsx(gp,{clientThreadId:t}),e.jsx($s,{verticalMargin:"none",isStaticSharedThread:f,verticalPadding:g?"last-standard":"none",horizontalPadding:"standard",children:e.jsx(Ys,{children:e.jsx(qg,{composerContainerRef:i,clientThreadId:t,currentModelId:r,isNewThread:s,hideHeader:s,onRequestCompletion:c,onAutocompleteSelect:u.onAutocompleteSelect})})})]});return d?e.jsxs(e.Fragment,{children:[e.jsx(U.div,{layout:!0,transition:{type:"spring",bounce:.1,duration:.5},children:h}),s&&e.jsx("div",{className:B("[display:var(--display-hidden-until-loaded,block)]",p?"min-h-[100px]":"md:absolute md:bottom-6 md:left-0 md:w-full"),children:e.jsx($s,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"standard",children:e.jsx(Ys,{children:e.jsx(Ci,{className:"block flex-1"})})})}),s&&!n&&!a&&!p&&e.jsx($s,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"standard",children:e.jsx(Ys,{children:e.jsx(mp,{clientThreadId:t,currentModelId:r,isModelLoaded:o})})})]}):h};function qg({clientThreadId:t,currentModelId:s,isNewThread:n,onRequestCompletion:a,composerContainerRef:o,onComposerInput:r,onComposerChange:c,onAutocompleteSelect:i,headerClassName:d,hideHeader:p,onTaggingDropdownClose:u,onTaggingDropdownOpen:l}){const{data:g,isLoading:f}=Hn(),[h,x,k,y]=ce(t,K=>{const re=Q.getCurrentNode(K);return[re.message.clientMetadata?.errType!=null&&re.message.clientMetadata.errType!=="info",gm(Q.getCurrentNode(K).message),K?.mode,K?.continuingFromSharedConversationId!=null]}),C=tt(),_=hm({clientThreadId:t}),{isOpen:E,onClose:A}=dd({type:"just-hit-rate-limit"}),{value:j}=Ie("1988730211"),I=On(),H=m.useCallback(K=>{w.logEvent(D.continueCompletion);const re=Array.from(I),{systemHints:Ce,extraStreamParams:_e}=j?md(re):{systemHints:re,extraStreamParams:{}};a({sourceEvent:K,completionType:fm.Continue,extraStreamParams:_e,completionMetadata:{conversationMode:Ze(t)?.mode,systemHints:Ce}})},[I,j,a,t]),b=m.useCallback(K=>{a(K)},[t,a,null,C?.normalizedAccountUserId]),F=pd(),O=m.useCallback(hs(()=>Wr(t,s),5e3,{leading:!0,trailing:!0}),[t,s]),N=m.useCallback(hs(()=>Vr(t),5e3,{leading:!0,trailing:!0}),[t]),M=m.useCallback(()=>{c?.(),F&&O();const K=xm("3257646228");!F&&K&&N()},[O,N,F,c]);m.useEffect(()=>{_||(O.cancel(),N.cancel())},[_,O,N]);const z=m.useMemo(()=>_?!1:!h&&x,[h,x,_]),te=_,q=Ja(t),oe=ja(q).data,pe=bm(),$=oe?.gizmo.tags?.includes(vs.WorkspaceDisabled)&&!pe?"workspaceDisallowsGizmo":g?.models.size===0?"noModelsAvailable":k?.kind===Me.GizmoTest&&k.gizmo_id==null?"noTestGizmoId":null,J=zr(),ae=gd(),ue=J.action==="moderate",{value:de}=Ae("1860647109");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center empty:hidden",children:ae&&ue&&de?e.jsx(hd,{}):null}),E?e.jsx(fd,{onClose:A}):null,e.jsx(Vg,{composerContainerRef:o,clientThreadId:t,onCreateNewCompletion:b,onContinueGenerating:H,currentModelId:s,account:C,modelCategories:g?.categories,currentModelConfig:Ta(g?.models,s),areModelsLoading:f,isNewThread:n,isCompletionInProgress:_,className:"w-full",canContinue:z,disabled:!!$,disabledReason:$??void 0,canPause:te,isInteractableSharedThread:y,onComposerInput:r,onComposerChange:M,onAutocompleteSelect:i,headerClassName:d,hideHeader:p,onTaggingDropdownClose:u,onTaggingDropdownOpen:l},t)]})}export{mg as D,mh as F,lh as I,ch as M,dh as O,qg as P,ph as T,Ci as a,mp as b,uh as c,dg as g,Wn as h,rh as u};
//# sourceMappingURL=kukctmibghbbqwq7.js.map
