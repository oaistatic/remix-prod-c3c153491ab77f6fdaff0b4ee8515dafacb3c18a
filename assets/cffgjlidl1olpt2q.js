const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/cj7utnmpqv3er3xm.js","assets/fs6h2trisr1juto6.js","assets/njq6ygky3ttysgdk.js","assets/root-cl538jor.css","assets/mj9703lmt9qipzgc.js","assets/jva3s9kefqoq05e1.js","assets/d7a6rc8fexfzu7dt.js","assets/conversation-small-m9kq0y4e.css","assets/lzozr48eypicocb2.js","assets/jhoqcbqmt1jrh2rh.js","assets/eq34zwf9q18c17ro.js","assets/dpwzd04w8cjus29t.js","assets/i6ze5suolzahci5v.js","assets/en8ogvlmn3lccz09.js","assets/jyg6m0czwgwjnl3i.js","assets/ijutvl794yycgs5p.js","assets/csg4i0wk6hi0jvkd.js","assets/lj0prj6na7gf1jpf.js","assets/n9whwsbg0rx5cs8k.js","assets/lohldfnm882k4f6q.js","assets/ctdkjhicvcmudkqr.js","assets/ms40jzicf31mvoix.js","assets/fiydxnpdsx8rzlpw.js","assets/bsxrqnfqv5abpjom.js","assets/bhsw6t55h66bayr8.js","assets/7xan75dui0uj586g.js","assets/hyj1ewu0eyfbsrce.js","assets/ll7i5gk77hsq89z0.js","assets/c1p22j8o7hm9vv5x.js","assets/il50daha0kb70ufn.js","assets/loh8e64j4csffv26.js","assets/mz766tu1yyo45fp0.js","assets/gy64pge8qevmvg7e.js","assets/nnks6z5apisamygz.js","assets/m3ph5kqqbcm52gd5.js","assets/ipkwqpr5cr94roq5.js","assets/tqebddvnlsjnw3aa.js","assets/jfi01owl9mian83i.js","assets/omlauz9an8wu57gp.js","assets/ab09ljgxzdctrygc.js","assets/mbebmpz9wmc7vznv.js","assets/e8xv89i2w2jwxlj7.js","assets/64hudxlbh9qkzkbr.js","assets/fzrn137102spawew.js","assets/e9lafxuzyeh4418f.js","assets/ktvbjknz372ja7i7.js","assets/ora9zmv2zdoi2bvo.js","assets/btjgsqbipn1ns9gv.js","assets/ot41yq4ptkktbpbq.js","assets/btkfu0lwj7996ioj.js","assets/miqolxcdfcownhv5.js"])))=>i.map(i=>d[i]);
import{d as I,cA as Rs,dA as an,j as Ee,aG as ke,R as nn,A as on,aF as ue,Z as We,dE as Nt,W as ot,bJ as Ps,a0 as At,ai as rn,C as ts,h as ss,gc as ln,I as ut,bG as cn,eq as It,bQ as oe,bR as le,aq as Fs,cL as Ds,bT as Us,P as $,a as z,bH as ye,gm as Ls,a3 as J,n as as,F as H,D as Ve,B as L,aT as Fe,aV as Rt,l as De,E as lt,g5 as dn,aZ as Hs,a4 as Pt,y as X,c5 as Ft,cH as me,dC as un,c3 as ae,ek as mn,da as gn,eA as hn,S as ne,aD as Gs,bC as pn,gM as fn,c0 as Os,V as Bs,T as xn,d6 as vn,ei as bn,am as Dt,c7 as yn,fM as Sn,fB as _n,aP as jn,a9 as Cn,a1 as zs,dM as Ws,M as Mn,bS as Tn,c6 as wn,X as kn,J as En,ef as ns,eX as Nn,gh as An,bM as In,gN as Vs,aM as Rn,bz as Pn,gO as Fn,bL as Dn}from"./njq6ygky3ttysgdk.js";import{e as Se,a5 as Q,r as o,j as e,v as Un,d as Ut,a7 as Ue,M as O,ao as Ln,al as Hn,ai as os,R as qs,b as Gn}from"./fs6h2trisr1juto6.js";import{u as On}from"./lj0prj6na7gf1jpf.js";import{c as Bn,u as mt,C as $s,m as zn,j as Wn,l as Vn}from"./ijutvl794yycgs5p.js";import{a2 as qe,m6 as q,eA as se,g9 as rs,d as Qs,g4 as be,ln as qn,m7 as $n,m8 as Qn,bk as gt,G as Ks,m9 as is,ki as we,ma as Kn,mb as Xn,mc as Yn,md as Lt,me as Zn,mf as yt,mg as Jn,mh as eo,bd as Xs,el as ls,em as cs,H as Ht,cM as to,a6 as Ys,u as so,N as Zs,mi as ao,o as Js,P as no,mj as oo,mk as ro,m3 as io,gM as lo,ml as co,R as uo,S as ds,gn as mo,a8 as go,V as ho,mm as po,e3 as fo,hQ as Tt,de as xo,mn as ea,mo as us,mp as vo,mq as bo,kK as yo,kN as So,mr as _o,ms as jo,mt as tt,jm as ta,mu as Co,gO as Mo,gP as To,M as sa,ez as rt,en as wo,dE as ko,mv as Eo,mw as No,lt as Ao,mx as Io,my as Ro,mz as Po,mA as st,kw as aa,ah as Fo,mB as Do,mC as Uo,mD as na,mE as oa,gT as it,gV as Lo,gW as ra,gX as Ho,gY as ia,mF as Go,U as ct,hb as Oo,mG as Bo,mH as zo,r as Wo,cI as la,cJ as ca,eP as Vo,cU as qo,mI as $o,jG as Qo,cV as da,b$ as ua,gN as Ko,mJ as Xo,eD as Yo,mK as Zo,mL as Jo,mM as er,mN as tr,kA as sr,h2 as ar,cu as nr,mO as or,mP as rr,cW as ir,mQ as lr,mR as cr,mS as dr,kj as dt,mT as wt,dI as ur,mU as mr,mV as ma,h4 as gr,fr as hr,fB as pr,fA as fr,mW as xr,g3 as vr,mX as ga,lR as br,lS as yr,lQ as Sr,mY as _r,mZ as jr,m_ as Cr,m$ as Mr,n0 as Tr,Z as wr,jA as kr,jB as Er,c0 as Nr,iV as Ar,n1 as Ir,n2 as St,eG as Rr,x as Pr,n3 as Fr,e4 as Dr,n4 as Ur,n5 as Lr,n6 as Hr,n7 as Gr,n8 as Or,dM as Br,v as zr,kB as Wr,n9 as Vr,na as qr,nb as $r,nc as Qr,nd as Kr,ne as Xr,l$ as Yr,nf as Zr,fZ as Jr}from"./d7a6rc8fexfzu7dt.js";import{a as ei}from"./i6ze5suolzahci5v.js";import{u as ha,c as ti,a as si,d as ms,e as ai,P as ni}from"./csg4i0wk6hi0jvkd.js";import{a as gs,P as oi,b as ri,M as ii,c as li,O as ci,F as di,T as ui}from"./kukctmibghbbqwq7.js";import{a as mi,u as gi}from"./jyg6m0czwgwjnl3i.js";import"./npeck75bz46c490i.js";import{c as hi,u as pi}from"./fu6bathgya5b9rdr.js";import{a as fi,G as xi}from"./en8ogvlmn3lccz09.js";import{C as kt,F as vi}from"./m97sb2fnwj0a6vyo.js";import{u as bi}from"./gunpso70jnmarvod.js";import{g as yi}from"./cm0hdcditutj2jz2.js";const Si=19,_i=4,ji=8,Ci=2,Mi=({as:t="div",logo:s,size:n="default",label:a,isBadge:r,isNew:i,isLauncher:l,selected:c=!1,...g})=>{const u=Se(),h=n==="large"?Si:ji,x=n==="large"?_i:Ci,p=t==="div"?Q.div:Q.button,[d,m]=o.useState(!1),v=()=>{l&&m(!0)},b=()=>{l&&m(!1)};return e.jsxs(p,{className:I(`flex cursor-pointer flex-col items-center gap-3 w-${h}`,r?"scale-[0.9]":"","opacity-80 can-hover:group-hover:opacity-100",l&&"py-4"),onMouseEnter:v,onMouseLeave:b,...g,children:[e.jsxs("div",{className:I("relative rounded-full transition-all duration-[0.25s] motion-safe:transition-all",d&&l&&"scale-[0.95] shadow-2xl",l&&"scale-[0.9] border border-token-border-light shadow-2xl",l&&c&&"shadow-none",r&&"border border-token-border-light shadow-[0px_4px_6px_rgba(0,0,0,0.04)]","can-hover:group-hover:motion-safe:scale-[0.95] can-hover:group-hover:motion-safe:drop-shadow-[0px_24px_26px_rgba(0,0,0,0.24)]"),children:[e.jsx("div",{className:I(`w-${h} h-${h} flex aspect-square items-center justify-center rounded-full border [color:var(--tint-color,#0285FF)] p-${x}`,c?"border-[#0285FF14] bg-token-composer-blue-bg dark:bg-[#0285FF40]":"border-transparent bg-white",r?"dark:bg-token-main-surface-primary":"dark:bg-token-main-surface-secondary"),children:e.jsx("div",{className:I("transition-all duration-[0.25s] motion-safe:transition-all",d&&l&&!c&&"drop-shadow-[0_6px_4px_rgba(0,0,0,0.2)]",d&&l&&"scale-[1.075]"),children:s})}),i&&e.jsx("div",{className:"absolute -left-1 -top-1 z-10 rounded-full bg-blue-500 px-2 py-1 text-[10px] font-bold text-token-text-primary",children:u.formatMessage({id:"kEZrwC",defaultMessage:"New"})})]}),a&&e.jsx("div",{className:I("text-center text-[12px] leading-[17px]",c&&"text-blue-1000",!l&&"w-20"),children:a})]})},Ti=4,wi=3,ki=async({text:t,numCompletions:s,isUnauthenticated:n,isThreadUsingSearchMode:a=!1,autocompleteMode:r,activeSystemHint:i})=>{try{return(n?await We.generateAutocompletionsAnon(t,s,a,i):await We.generateAutocompletions(t,s,a,i)).completions.map(c=>({id:Un(),type:se.Autocomplete,title:c.slice(0,t.length),body:c.slice(t.length),oneliner:c,prompt:c,source:r}))}catch{return[]}},Ei=({clientThreadId:t,composerController:s})=>{const n=Rs(s.store,P=>P.showTaggingDropdown),a=ha(),r=Array.from(a)[0],i=o.useRef(void 0),[l,c]=o.useState([]);o.useState([]),o.useRef(0);const{isUXUpdatesEnabled:g}=qe(),u=g?wi:Ti,[h,x]=o.useState(),p=o.useCallback(P=>{c(R=>{const D=typeof P=="function"?P(R):P;return an(D,R)?R:D})},[]),{trendingSuggestions:d,fetchTrendingSuggestions:m}=Ni(u),{isUnauthenticated:v}=Ee(),b=ti(),k=o.useCallback(P=>{const R=s.getCurrentText();return R&&_t(P).startsWith(R.toLocaleLowerCase())},[s]),w=o.useCallback(P=>{const R=s.getCurrentText(),D=P.title+P.body;return k(P)?{...P,title:R,body:D.slice(R.length)}:{...P,title:D,body:""}},[s,k]),E=o.useCallback((P=!1)=>{p(R=>!R.some(k)&&R.length>0?[]:P?R:R.map(w))},[k,w,p]),f=Se(),S=o.useMemo(()=>({[q.Canvas]:[{type:se.Starter,title:f.formatMessage({id:"GMvniX",defaultMessage:"Help me write a birthday message for a friend"}),prompt:f.formatMessage({id:"JInqHw",defaultMessage:"Help me write a birthday message for a friend"}),body:"",theme:q.Canvas},{type:se.Starter,title:f.formatMessage({id:"Xwp6O+",defaultMessage:"Help me write a short story"}),prompt:f.formatMessage({id:"e2j3PL",defaultMessage:"Help me write a short story set in a post-apocalyptic Tokyo, focused on a character who’s discovering a long-lost secret"}),body:"",theme:q.Canvas},{type:se.Starter,title:f.formatMessage({id:"ARQf7p",defaultMessage:"Help me write a basic outline for an essay"}),prompt:f.formatMessage({id:"K0WcGA",defaultMessage:"Help me write a basic outline for an essay"}),body:"",theme:q.Canvas},{type:se.Starter,title:f.formatMessage({id:"z+JwEj",defaultMessage:"Create a business plan outline"}),prompt:f.formatMessage({id:"4c/Ux5",defaultMessage:"Create a detailed outline for a business plan for a new app that connects local artists with buyers. Include sections for market analysis, monetization, and user acquisition"}),body:"",theme:q.Canvas}],[q.Image]:[{type:se.Starter,title:f.formatMessage({id:"noA7wB",defaultMessage:"Design a modern logo"}),prompt:f.formatMessage({id:"k53BuX",defaultMessage:"Create a modern, minimalist logo for a tech startup called ‘Nexora’. It should use bold typography and a sleek geometric icon, suitable for both light and dark backgrounds"}),body:"",theme:q.Image},{type:se.Starter,title:f.formatMessage({id:"akHy6z",defaultMessage:"Create an invite for my birthday"}),prompt:f.formatMessage({id:"BXf15G",defaultMessage:"Please create an invite for my birthday to send to my friends. It’ll be an outdoor barbeque with music and delicious food with my closest friends and family"}),body:"",theme:q.Image},{type:se.Starter,title:f.formatMessage({id:"57SKj2",defaultMessage:"Create a cartoon illustration of my pet"}),prompt:f.formatMessage({id:"EtCE7V",defaultMessage:"Please create an illustration of my pet in 2D animation style. It’s taking a nap in its favorite spot by the fire"}),body:"",theme:q.Image},{type:se.Starter,title:f.formatMessage({id:"s5iqKS",defaultMessage:"Create a Renaissance-style painting"}),prompt:f.formatMessage({id:"mEPKGA",defaultMessage:"Please create a Renaissance-style painting of a Mars rover. Use techniques like chiaroscuro and a warm color palette"}),body:"",theme:q.Image}]}),[f]);o.useEffect(()=>{if(g)return;const P=l.some(R=>R.theme===q.Search);b&&s.getCurrentText()===""?d.length>0?p(d):m():P&&!b&&p(R=>R.filter(D=>D.theme!==q.Search))},[l,s,m,b,p,d,g]),o.useEffect(()=>{b&&s.getCurrentText()===""&&d.length>0&&rs(d,t)},[b,s,d,t]);const A=u-l.filter(k).length,C=Ii(b),{layer:j}=ke("4031588851"),y=j.get("autocomplete_min_char",4),G=j.get("autocomplete_fetch_interval",200),N=o.useRef(null),M=o.useCallback(Qs(async P=>{const R=s.getCurrentText();if(!R||R.length<y||R.length>80||s.hasMultipleLines()){p([]);return}if(!n&&!(N.current&&N.current.length>y&&R.startsWith(N.current)))try{const D=(await ki({text:R,numCompletions:P,isUnauthenticated:v,isThreadUsingSearchMode:b,autocompleteMode:C,activeSystemHint:r})).filter(k).map(w);p(Ne=>{const _e=Ne.filter(k),Le=D.filter(je=>{const B=_t(je);return!_e.some(Ae=>{const te=_t(Ae);if(B===te)return!0;const ge=/[\p{P}\p{S}]$/u,Ce=B.replace(ge,""),he=te.replace(ge,"");return Ce===te||B===he||Ce===he})}).slice(0,u-_e.length);return[..._e,...Le]}),D.length>0&&rs(D,t)}catch{}},C==="BING"?150:G),[s,C,w,G,r]);o.useEffect(()=>{!g||i.current===r||(i.current=r,s.getCurrentText()===""?(p(P=>P.filter(R=>R.theme!==q.Search&&R.theme!==q.Canvas&&R.theme!==q.Image)),r===be.Search?d.length>0?p(d):m():r===be.Canvas?p(S[q.Canvas].slice(0,u)):(r===be.Picture||r===be.PictureV2)&&p(S[q.Image].slice(0,u))):(p([]),s.getCurrentText().length>y&&M(u)))},[d,m,s,p,r,u,g,S,y,M]),qn(P=>P.files);const U=r===be.Research&&!1,Y=o.useCallback(()=>{E(),A>0&&M(A)},[M,E,A]);o.useEffect(()=>{n&&p([])},[n,p]);const Z=o.useMemo(()=>C==="HARDCODED"?E:Y,[C,Y,E]),W=!1,re=o.useCallback(()=>{Z()},[Z,W,U,p]),ee=o.useCallback(()=>{s instanceof Bn&&E(!0),s.getCurrentText().indexOf(`
`)>0&&(p([]),x(void 0))},[s,p,E,W,U]);return o.useEffect(()=>s.subscribe("input",()=>{re()}),[s,re]),o.useEffect(()=>s.subscribe("change",()=>{ee()}),[s,ee]),{autocompletions:l,matchaData:h}},Ni=t=>{const[s,n]=o.useState([]),a=o.useCallback(async()=>{const i=(await nn.safePost("/conversation/experimental/generate_trending_suggestions",{requestBody:{num_items:t},authOption:on.SendIfAvailable})).suggestions.map((l,c)=>({type:se.Trending,title:hs(l),body:"",icon:e.jsx($n,{className:"h-full w-full"}),prompt:hs(l),id:`search-trending-${c}`,theme:q.Search}));n(i)},[t]);return{trendingSuggestions:s,fetchTrendingSuggestions:a}};function hs(t){return t.split(" ").map(Qn).join(" ")}const _t=t=>`${t.title}${t.body}`.toLocaleLowerCase();function Ai(){const{layer:t}=Nt("4031588851"),s=t.get("autocomplete_qualified_start_date","2099-09-13T00:00:00Z"),n=gt();return!!n&&n.created*1e3>=new Date(s).getTime()}function Ii(t){const{isUnauthenticated:s}=Ee(),n=ue("1468311859").value,a=ue("2053937752").value,r=ue("3664702598").value,i=ue("471233253").value,{layer:l}=ke("4031588851"),{layer:c}=ke("3533083032"),g=Ai(),u=!s&&n||s&&a,h=(!s&&r||s&&i)&&g;let x="HARDCODED";{const p=s?c:l;if(t){const d=p.get("search_autocomplete_mode","");u&&d&&(x=d)}else h&&(x=p.get("autocomplete_mode","HARDCODED"))}return x}const pa=({clientThreadId:t})=>{const s=mt(),{autocompletions:n,matchaData:a}=Ei({clientThreadId:t,composerController:s});return o.useEffect(()=>(s.store.setState({autocompletions:n,matchaData:a}),()=>{s.store.setState({autocompletions:[],matchaData:void 0})}),[n,s,a]),null};function fa({clientThreadId:t}){const s=mt(),n=Se(),a=Ks(),[r,i]=o.useState(),{updateSystemHint:l}=si(),c=ms.useState(({persistedSystemHints:x})=>x),g=ms.useState(({availableHints:x})=>x),u=Array.from(c)[0];if(a)return;const h=x=>{l(x,{clientThreadId:t}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{s?.focus()})})};return e.jsx("div",{className:is.vanguardAppLaunchersContainer,children:e.jsx(we,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"standard",children:e.jsx("ol",{className:I("absolute left-0 right-0 mt-12 hidden w-full select-none justify-center gap-10 md:flex",is.vanguardAppLaunchers),children:Kn.map(x=>{const p=x.logo,d=g.find(v=>v.systemHint===x.systemHint),m=d?.systemHint||x.systemHint;return e.jsxs("li",{children:[e.jsx(Mi,{as:"button",logo:e.jsx(p,{className:"h-9 w-9"}),label:n.formatMessage(x.label),size:"large",isLauncher:!0,onClick:()=>{if(d?.isPopulatedByDefault){i(m);return}h(u===m?null:m)},selected:u===m}),m===r&&e.jsx(Xn,{open:!0,systemHint:m,onOpenChange:()=>i(void 0)})]},m)})})})})}function Ri(t){const{clientThreadId:s}=t;return e.jsx($s,{clientThreadId:s,children:e.jsx(Fi,{...t})})}function Pi({clientThreadId:t,headlineOption:s,currentModelId:n,isModelLoaded:a,overrideMessage:r}){const i=Lt(),{getAndroidKeyboardLayout:l}=Xs(),c=mt(),{isFocused:g,autocompletions:u}=Rs(c.store),h=g&&u.length>0;return e.jsxs(Q.div,{initial:{opacity:0},animate:{opacity:h?0:1},exit:{opacity:0},transition:{duration:.1},className:I("mt-[var(--screen-optical-compact-offset-amount)] flex-shrink flex-col items-center justify-center overflow-hidden text-token-text-primary [display:var(--display-hidden-until-loaded,flex)]",l()?"h-full keyboard-open:h-[calc(100%-var(--screen-keyboard-height,0px)-var(--composer-height,100px))] motion-safe:[transition:height_0.3s_var(--easing-common)]":"h-full",h?"pointer-events-none":"",i?"@lg/thread:hidden":"lg:hidden"),children:[s==="CHATGPT_LOGO"?e.jsx(Ps,{className:"inline-block h-12 w-12"}):e.jsx(xa,{headlineOption:s,overrideMessage:r}),e.jsx(ii,{isModelLoaded:a,currentModelId:n,clientThreadId:t})]})}function Fi({clientThreadId:t,currentModelId:s,isModelLoaded:n,onRequestCompletion:a,chatgptHomepageDisclaimer:r,shouldUseUnifiedComposer:i=!1}){const l=mt(),c=ot(t),{isUnauthenticated:g}=Ee();Yn(l);const{layer:u}=ke("4031588851"),{layer:h}=Nt("3533083032"),x=g?h:u,p=mi(),d=Lt(),{isUXUpdatesEnabled:m}=qe(),v=m?"HOW_CAN_I_HELP":x.get("headline_option","HELP_WITH"),b=ha(),k=b.has(be.Research),w=Zn(Array.from(b)[0]),E=m&&w?w:k?de.deepResearchPlaceholder:void 0,f=e.jsxs(e.Fragment,{children:[e.jsx("div",{className:I("hidden text-center @lg/thread:block","mb-5",m&&"md:-mt-20",d?"@lg/thread:block":"lg:block"),children:v==="CHATGPT_LOGO"?e.jsx(Ps,{className:"inline-block h-12 w-12"}):e.jsx(xa,{headlineOption:v,overrideMessage:E})}),e.jsx(Pi,{headlineOption:v,overrideMessage:m?E:void 0,clientThreadId:t,isModelLoaded:n,currentModelId:s})]});return i?e.jsx("div",{className:I("flex grow items-center justify-center",d?"@lg/thread:items-end":"lg:items-end"),children:f}):e.jsx(Ue,{children:e.jsx(we,{isStaticSharedThread:!1,verticalPadding:"none",horizontalPadding:"standard",fullHeight:!0,children:e.jsxs(yt,{className:"relative",children:[f,!m&&e.jsx("div",{className:I(d?"@lg/thread:absolute @lg/thread:bottom-8 @lg/thread:left-0 @lg/thread:w-full":"[display:var(--display-hidden-until-loaded,block)] lg:absolute lg:bottom-8 lg:left-0 lg:w-full"),children:e.jsx(we,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"standard",children:e.jsx(yt,{className:"relative @lg/thread:pb-0",children:e.jsx(gs,{className:"block"})})})}),e.jsxs("div",{className:"w-full",children:[e.jsx(oi,{clientThreadId:t,isNewThread:c,currentModelId:s,onRequestCompletion:a,onAutocompleteSelect:l.onAutocompleteSelect,hideHeader:!0}),m&&e.jsx(we,{verticalMargin:"none",verticalPadding:"none",horizontalPadding:"none",children:e.jsx(yt,{className:I("relative @lg/thread:pb-0",m&&"min-h-[100px] xs:justify-start"),children:e.jsx(gs,{className:"block"})})}),c&&e.jsx(pa,{clientThreadId:t}),m&&e.jsx(fa,{clientThreadId:t})]}),p&&!m?e.jsx(ri,{isModelLoaded:n,currentModelId:s,clientThreadId:t}):null,r&&e.jsx("div",{className:I("w-full translate-y-4 px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden xs:translate-y-8 md:px-[60px]",d?"@lg/thread:absolute @lg/thread:bottom-0 @lg/thread:left-0":"lg:absolute lg:bottom-0 lg:left-0"),children:e.jsx("div",{className:I("min-h-4"),children:r})})]})})})}function Di({headlineOption:t,overrideMessage:s,isVanguardUxEnabled:n,prefersReducedMotion:a}){const r=Se(),{layer:i}=rn("1704793646"),l=i.get("name_char_limit",20),[c]=o.useState(()=>{const v=ts.getCookie(ss.GreetingName);return{cookieName:v,isReadyForPersonalized:!!v&&v.length<=l}}),{isUnauthenticated:g}=Ee(),u=gt(),x=ai(!g&&!!u)?.data;o.useEffect(()=>{if(u){const v=ln(x,u);v&&(ts.setCookie(ss.GreetingName,v),ls.count(cs.MOONSHINE,"splashScreenV2.greeting_cookie_name_set_web"))}},[x,u]);const p=c.isReadyForPersonalized?i.get("greeting_web",!1):!1;o.useEffect(()=>{p&&ls.count(cs.MOONSHINE,p?"splashScreenV2.greeting_shown_web":"splashScreenV2.greeting_not_shown_web")},[p]);let d;s?d=r.formatMessage(s):p?d=r.formatMessage(ps[t].withName,{name:c.cookieName}):d=r.formatMessage(ps[t].original);const m=n?e.jsx(Ue,{mode:"wait",initial:!1,children:e.jsx(Q.div,{initial:{opacity:.4,scale:.97},animate:{opacity:1,scale:1},exit:{opacity:.4,scale:.97},transition:{duration:a?1e-9:.1},children:d},d)}):d;return e.jsx(e.Fragment,{children:m})}function xa({headlineOption:t,overrideMessage:s}){const n=At(),{isUXUpdatesEnabled:a}=qe(),r=Jn();return e.jsx("div",{className:"relative inline-flex justify-center text-center text-2xl font-semibold leading-9",children:e.jsx("div",{style:{viewTransitionName:"var(--vt-splash-screen-headline)"},children:e.jsxs("div",{className:"grid min-h-[74px] grid-cols-1 items-center justify-end",children:[e.jsx("h1",{className:I("flex h-full items-end justify-center text-balance [grid-area:1/1] motion-safe:[transition:0.3s_transform_var(--spring-standard),0.5s_opacity_var(--spring-standard),0.5s_visibility_var(--spring-standard)]",!a&&"text-[28px] font-semibold leading-[34px] tracking-[0.38px]",n?"invisible -translate-y-full opacity-0":"translate-y-0 opacity-100",a&&"text-[28px] font-medium leading-[50px] tracking-[-0.42px] sm:text-[56px] md:-mt-16"),"aria-hidden":n,children:e.jsx(Di,{headlineOption:t,overrideMessage:s,isVanguardUxEnabled:a,prefersReducedMotion:r})}),e.jsx("div",{className:I("flex h-full flex-col items-center justify-end [grid-area:1/1] motion-safe:[transition:0.3s_transform_var(--spring-standard),0.5s_opacity_var(--spring-standard),0.5s_visibility_var(--spring-standard)]",n?"translate-y-0 opacity-100":"invisible translate-y-full opacity-0"),"aria-hidden":!n,children:e.jsx(eo,{})})]})})})}const de=Ut({whatCanIHelpWith:{id:"SplashScreenV2.whatCanIHelpWith",defaultMessage:"What can I help with?"},whatCanIHelpWithWithName:{id:"SplashScreenV2.whatCanIHelpWith.withName",defaultMessage:"What can I help with, {name}?"},whereShouldWeStart:{id:"SplashScreenV2.whereShouldWeStart",defaultMessage:"Where should we start?"},whereShouldWeStartWithName:{id:"SplashScreenV2.whereShouldWeStart.withName",defaultMessage:"Where should we start, {name}?"},askChatgptAnything:{id:"SplashScreenV2.askChatgptAnything",defaultMessage:"Ask ChatGPT anything"},askChatgptAnythingWithName:{id:"SplashScreenV2.askChatgptAnything.withName",defaultMessage:"Ask ChatGPT anything, {name}"},deepResearchPlaceholder:{id:"G1v9do",defaultMessage:"What are you researching?"},howCanIHelp:{id:"SplashScreenV2.howCanIHelp",defaultMessage:"How can I help?"},howCanIHelpWithName:{id:"SplashScreenV2.howCanIHelp.withName",defaultMessage:"How can I help, {name}?"}}),ps={HELP_WITH:{original:de.whatCanIHelpWith,withName:de.whatCanIHelpWithWithName},WHERE_TO_START:{original:de.whereShouldWeStart,withName:de.whereShouldWeStartWithName},ASK_CHATGPT:{original:de.askChatgptAnything,withName:de.askChatgptAnythingWithName},HOW_CAN_I_HELP:{original:de.howCanIHelp,withName:de.howCanIHelpWithName}},Ui=({clientThreadId:t})=>{const s=Ht(x=>x.activeStageSidebar),n=ut(t),a=to(cn.WorkspaceShareLinks),{isUnauthenticated:r}=Ee(),i=At(),l=It(t),c=Ys(l),g=so(),u=a&&n&&!r&&!i&&!c&&!g,h=!s;return e.jsx("div",{className:"flex items-center gap-2 pr-1 leading-[0]",children:e.jsx(zn,{showShareButton:u,showProfileDropdown:h,clientThreadId:t})})},Li=oe(()=>le(()=>import("./cj7utnmpqv3er3xm.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(t=>t.GizmoUsingAsOwnerNotice));function Hi({clientThreadId:t,isEmptyState:s}){const n=It(t),a=Zs(),r=ao(),{data:i}=Js(n),l=Fs(),c=no(),g=Se(),u=!1,{isUXUpdatesEnabled:h}=qe(),x=Ht(v=>v.isConversationScrolledFromTop),p=Ds(),d=!h||!!n;if(a)return null;const m=d?e.jsx(e.Fragment,{children:c?e.jsx(uo,{children:e.jsx(ds,{clientThreadId:t})}):e.jsx(ds,{clientThreadId:t})}):e.jsx(Us,{side:"bottom",theme:p?"default":"white",label:e.jsxs("div",{className:"flex h-full w-full flex-col overflow-hidden px-4 py-3",children:[e.jsx("div",{className:"flex w-full justify-center py-2",children:e.jsxs("div",{className:"flex w-56 flex-col gap-2 rounded-xl border border-token-border-light bg-token-main-surface-primary p-2 pt-1.5 shadow-lg",children:[e.jsx("div",{className:"flex w-full text-start text-[11px] font-normal tracking-tight text-token-text-tertiary",children:g.formatMessage({id:"kvZYws",defaultMessage:"Ask anything"})}),e.jsxs("div",{className:"flex w-full flex-row items-center gap-2",children:[e.jsx(oo,{className:"h-3 w-3 text-token-text-primary opacity-40"}),e.jsx(ro,{className:"h-3 w-3 text-token-text-primary opacity-40"}),e.jsxs("div",{className:"relative h-3 w-3",children:[e.jsx(io,{className:"h-3 w-3 text-token-text-primary"}),e.jsx("div",{className:"scale-200 absolute left-0 top-0 h-full w-full animate-ping rounded-full bg-blue-1000/50 duration-1000"})]}),e.jsx("div",{className:"flex-auto"}),e.jsx("div",{className:"rounded-full bg-token-main-surface-primary p-[1px] opacity-20 invert",children:e.jsx(lo,{className:"h-3 w-3 text-token-text-primary"})})]})]})}),e.jsxs("div",{className:"mt-4 flex max-w-80 flex-col gap-1 text-token-text-primary",children:[e.jsx("div",{className:"font-semibold",children:g.formatMessage({id:"ZQnsFt",defaultMessage:"The model picker has moved"})}),e.jsx("div",{className:"text-xs font-normal opacity-75",children:g.formatMessage({id:"EyZkkB",defaultMessage:"Adjust thinking or choose a model here"})})]})]}),onOpenChange:v=>{v&&$.logEvent(z.modelSwitcherMovedTooltipHover,{location:"thread_header"})},children:e.jsx("div",{className:"px-0.5 text-xl text-token-text-secondary",children:co})});return e.jsxs(e.Fragment,{children:[e.jsxs(mo,{className:I("pointer-events-none select-none *:pointer-events-auto motion-safe:transition max-md:hidden",s&&"absolute left-0 right-0",!n&&"@thread-xl/thread:absolute @thread-xl/thread:left-0 @thread-xl/thread:right-0 @thread-xl/thread:bg-transparent @thread-xl/thread:!shadow-none",u,x?"[box-shadow:var(--sharp-edge-top-shadow)]":"[box-shadow:var(--sharp-edge-top-shadow-placeholder)]"),children:[e.jsxs("div",{className:"absolute start-1/2 ltr:-translate-x-1/2 rtl:translate-x-1/2",children:[i!=null&&l?.isWorkspaceAccount()&&i.gizmo.tags?.includes(go.WorkspaceDisabled)&&e.jsx(Li,{gizmo:i}),e.jsx(ho,{gizmoId:n,clientThreadId:t})]}),e.jsxs("div",{className:"flex items-center gap-0 overflow-hidden",children:[e.jsx(Wn,{clientThreadId:t}),m]}),e.jsx(Ui,{clientThreadId:t})]}),r&&e.jsx(po,{})]})}const Gi="bg-token-main-surface-primary text-token-text-primary",Oi="openai",fs=["bg-blue-300 text-white"];function Bi(t){return fs[(t?.charCodeAt(0)??0)%fs.length]}const at=({children:t})=>e.jsx("div",{className:"pt-0",children:e.jsx("div",{className:I(o.isValidElement(t)&&t.type===Tt?"gizmo-bot-avatar":"gizmo-shadow-stroke","flex h-8 w-8 items-center justify-center overflow-hidden rounded-full"),children:t})});function Et(t){const{messages:s,isUserTurn:n,avatarClassName:a,gizmo:r}=t,i="medium",c=s[0]?.metadata?.shared_conversation_id,g=c!=null,u=gt(),{gizmoEditorData:h,mode:x}=fo();let p=e.jsx(at,{children:e.jsx(Tt,{className:a??Gi,iconName:Oi,size:i})});return r?p=e.jsx(at,{children:e.jsx(fi,{gizmoId:r.gizmo.id,className:"h-full w-full"})}):h!=null&&x==="test"&&(p=e.jsx(xi,{isFirstParty:!1,src:h.profilePictureUrl,className:"h-8 w-8 first:pt-[3px]"})),e.jsx("div",{className:void 0,children:n?g?e.jsx(at,{children:e.jsx(Tt,{className:Bi(c),iconName:"user",size:i})}):e.jsx(at,{children:e.jsx(xo,{user:u,size:i})}):p})}const xs=oe(()=>le(()=>import("./7xan75dui0uj586g.js"),__vite__mapDeps([25,2,1,3,6,7,26])).then(t=>t.MemoryActionResult));function vs(t,s,n){Fe(t,a=>{Rt.updateTree(a,r=>{r.updateNodeMetadata(s,{inlineComparisonRating:n})})})}const bs=({messages:t})=>{for(const{metadata:s}of t){const{augmented_paragen_prompt_label:n}=s??{};if(n)return n}};function zi(t){const s=o.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null}),n=o.useRef({left:null,right:null});return t.variantIds.length<2?e.jsx(va,{setPreferredFeedback:()=>{},leftVariantId:"left-placeholder",rightVariantId:"right-placeholder",leftTurn:null,rightTurn:null,originalTurn:null,hasActiveRequest:!0,visibilityStateRef:s,firstVisibleTokenTimestampsRef:n,...t}):e.jsx(Wi,{...t,visibilityStateRef:s,firstVisibleTokenTimestampsRef:n})}function Wi(t){const{clientThreadId:s,variantIds:n,turnIndex:a,firstVisibleTokenTimestampsRef:r}=t;if(n.length!==2)throw new Error("ConversationTurnSideBySideFeedback requires exactly two variant IDs");const i=Gt(),l=Ls(),c=Ds(),[g,u]=n,h=o.useMemo(()=>ea(g+u)()>=.5,[g,u]),[x,p]=h?[u,g]:[g,u],[d,m,v]=J(s,S=>{const A=as(S).tree.getLeafFromNode(x).id,C=as(S).tree.getLeafFromNode(p).id,j=H.getConversationTurns(S,A),y=H.getConversationTurns(S,C),G=a<j.length?j[a]:null,N=a<y.length?y[a]:null;return G||Ve.addError(`Paragen Left turn index ${a} out of bounds`,{turnIndex:a,turnCount:j.length,lastTurnRole:L(j)?.role,lastMessageAuthor:L(L(j)?.messages)?.author,lastMessageContentType:L(L(j)?.messages)?.content.content_type,lastMessageMetadata:L(L(j)?.messages)?.metadata,altTurnCount:y.length,altLastTurnRole:L(y)?.role,altLastMessageRole:L(L(y)?.messages)?.author.role}),N||Ve.addError(`Paragen Right turn index ${a} out of bounds`,{turnIndex:a,turnCount:y.length,lastTurnRole:L(y)?.role,lastMessageAuthor:L(L(y)?.messages)?.author,lastMessageContentType:L(L(y)?.messages)?.content.content_type,lastMessageMetadata:L(L(y)?.messages)?.metadata,altTurnCount:j.length,altLastTurnRole:L(j)?.role,altLastMessageRole:L(L(j)?.messages)?.author.role}),[A,G,N]}),[b,k]=h?[v,m]:[m,v],w=i?"skippable_parallel_2_in_stream:a:2.0":"skippable_parallel_2_in_stream:a:1.5";o.useEffect(()=>(us.setState({displayingSideBySideFeedback:!0}),()=>{us.setState({displayingSideBySideFeedback:!1})}),[]),vo();const E=o.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null}),f=o.useCallback((S,{shouldSubmitParagenFeedback:A=!0}={})=>{if(!m||!v||!b||!k)throw new Error("Expected both turns to exist");Fe(s,U=>{Rt.setCurrentBranch(U,S)});const C=S===x,j=S===g;b.messages.length>0&&vs(s,b.messages[b.messages.length-1].id,j?"original":"new"),k.messages.length>0&&vs(s,k.messages[k.messages.length-1].id,j?"original":"new");const y=De(s),G=[m,v].map((U,Y)=>({messageId:U.messages[U.messages.length-1].id,loadFirstTokenTime:Y===0?r.current.left:r.current.right,loadEndTime:L(U.messages)?.clientMetadata?.completionSampleFinishTime})),N=C?G[0].messageId:G[1].messageId,M=H.getParentPromptNode(lt(s),d);if(!M)throw new Error("Expected prompt for side by side feedback");const T={},F=M.message.clientMetadata?.variantsInStreamInfo==null&&M.message.metadata?.paragen_variants_info!=null;for(const U of G)T[U.messageId]=F?{load_first_token_time:t.conversationTurnMountTime,load_end_time:t.conversationTurnMountTime}:{load_first_token_time:U.loadFirstTokenTime,load_end_time:U.loadEndTime};A&&Ms({params:{conversation_id:y,displayed_message_ids:G.map(U=>U.messageId),message_metadatas:T,rating:"selected",selected_message_id:N,source_timestamp:Date.now(),ui_variant:i?2:1,user_prompt_message_id:M.message.id}})},[s,x,g,b,k,m,v,d,r,t.conversationTurnMountTime,i]);return o.useEffect(()=>dn(Hs,{requestCompletion:S=>{const A=De(s),C=H.getParentPromptNode(lt(s),d);if(!C)throw new Error("Expected prompt for side by side feedback");if(!m||!v)throw new Error("Expected both turns to exist");const j=[m,v].map((M,T)=>({messageId:M.messages[M.messages.length-1].id,loadFirstTokenTime:T===0?r.current.left:r.current.right,loadEndTime:L(M.messages)?.clientMetadata?.completionSampleFinishTime})),y={},G=C.message.clientMetadata?.variantsInStreamInfo==null&&C.message.metadata?.paragen_variants_info!=null;for(const M of j)y[M.messageId]=G?{load_first_token_time:t.conversationTurnMountTime,load_end_time:t.conversationTurnMountTime}:{load_first_token_time:M.loadFirstTokenTime,load_end_time:M.loadEndTime};const N=S.isForSkippingParagen;Ms({params:{conversation_id:A,displayed_message_ids:j.map(M=>M.messageId),message_metadatas:y,rating:N?"explicit_skipped":"skipped",selected_message_id:null,source_timestamp:Date.now(),ui_variant:N?3:i?2:1,user_prompt_message_id:C.message.id}}),N&&f(x,{shouldSubmitParagenFeedback:!1})}}),[m,v,d,s,t.conversationTurnMountTime,w,b?.messages,k?.messages,c,i,r,f,x]),e.jsx(va,{...t,setPreferredFeedback:f,leftVariantId:x,rightVariantId:p,leftTurn:m,rightTurn:v,hasActiveRequest:l,originalTurn:b,visibilityStateRef:E})}function va({setPreferredFeedback:t,leftVariantId:s,rightVariantId:n,leftTurn:a,rightTurn:r,hasActiveRequest:i,originalTurn:l,visibilityStateRef:c,...g}){const{defaultParagenLabel:u,shouldShowParagenLabels:h=!1}=bo(),x=(a&&bs(a))??u,p=(r&&bs(r))??u,d=o.useMemo(()=>a?.messages??[],[a?.messages]),m=o.useMemo(()=>r?.messages??[],[r?.messages]),{avatarClassName:v,firstVisibleTokenTimestampsRef:b}=g,k=o.useMemo(()=>a?.messageGroups??[],[a?.messageGroups]),w=o.useMemo(()=>r?.messageGroups??[],[r?.messageGroups]),E=yo(),f=lt(g.clientThreadId),S=L(a?.messages),A=L(r?.messages),C=Pt(H.getRequestId(f,S?.id??A?.id)),j=C&&!S?.end_turn,y=C&&!A?.end_turn,G=a?.role===X.User,N=r?.role===X.User,M=o.useRef(null),T=o.useRef(null),F=o.useRef(null),U=a!=null,Y=r!=null;!U&&b.current.left==null&&(b.current.left=Date.now()),!Y&&b.current.right==null&&(b.current.right=Date.now()),o.useEffect(()=>{if(M.current&&T.current&&F.current){const ee=Array(11).fill(0).map((R,D)=>D/10),P=new IntersectionObserver(R=>R.forEach(D=>{D.target===T.current?(c.current.left_visibility_initial==null&&(c.current.left_visibility_initial=D.intersectionRatio),c.current.left_visibility_max=Math.max(c.current.left_visibility_max??0,D.intersectionRatio)):D.target===F.current&&(c.current.right_visibility_initial==null&&(c.current.right_visibility_initial=D.intersectionRatio),c.current.right_visibility_max=Math.max(c.current.right_visibility_max??0,D.intersectionRatio))}),{root:M.current,threshold:ee});return P.observe(T.current),P.observe(F.current),()=>P.disconnect()}},[c]);const{data:Z}=So(void 0,!1,E),W=Gt(),re=e.jsx("div",{className:"text-pretty px-6 pb-5 pt-1 text-center text-sm text-token-text-secondary",children:e.jsx(O,{id:"TK934w",defaultMessage:"Which response do you prefer? Responses may take a moment to load."})});return e.jsxs("div",{className:"relative flex flex-col",children:[e.jsxs("div",{className:I("sticky top-[-1px] z-[1] text-pretty bg-token-main-surface-primary px-6 text-center text-lg",W?"md:top-header-height":"md:static"),"data-testid":"paragen-feedback-title",children:[e.jsx(O,{id:"KKeSJV",defaultMessage:"You're giving feedback on a new version of ChatGPT."}),W?re:null]}),W?null:re,e.jsx("div",{className:"relative -mb-2 snap-x snap-mandatory overflow-x-auto overflow-y-clip px-3 pb-4 md:px-5 lg:px-10",ref:M,children:e.jsx("div",{className:"min-w-fit",children:e.jsxs("div",{className:I("mx-auto flex max-w-6xl items-start",W&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",!W&&"gap-4 sm:gap-6"),children:[e.jsxs(ys,{horizontalScrollContainerRef:M,rootElementRef:T,onClick:()=>{t(s)},hasActiveRequest:i,isWaitingOnFirstUserVisibleToken:U,children:[e.jsxs(js,{children:[e.jsx(Et,{messages:d,isUserTurn:G,avatarClassName:v}),e.jsx(_s,{children:h?e.jsx("span",{className:"font-bold text-token-text-primary",children:x}):e.jsx(O,{...Ts.responseNumber,values:{responseIndex:1}})})]}),W&&U?e.jsx(Ss,{}):e.jsxs(e.Fragment,{children:[Z!=null&&!G&&e.jsx(xs,{clientThreadId:g.clientThreadId,messages:d,isParagen:!0}),e.jsx(kt,{...g,allMessages:d,groupedMessagesToRender:k,allGroupedMessages:k,isUserTurn:G,isFinalUserTurn:!1,isCompletionRequestInProgress:j,hasActiveRequest:i,shouldGrowContainer:!1,isParagen:!0}),e.jsx(Cs,{clientThreadId:g.clientThreadId,conversationTurnMountTime:g.conversationTurnMountTime,turn:a,originalTurn:l})]})]}),e.jsxs(ys,{horizontalScrollContainerRef:M,rootElementRef:F,onClick:()=>{t(n)},hasActiveRequest:i,isWaitingOnFirstUserVisibleToken:Y,children:[e.jsxs(js,{children:[e.jsx(Et,{messages:m,isUserTurn:N,avatarClassName:v}),e.jsx(_s,{children:h?e.jsx("span",{className:"font-bold text-token-text-primary",children:p}):e.jsx(O,{...Ts.responseNumber,values:{responseIndex:2}})})]}),W&&Y?e.jsx(Ss,{}):e.jsxs(e.Fragment,{children:[Z!=null&&!N&&e.jsx(xs,{clientThreadId:g.clientThreadId,messages:m,isParagen:!0}),e.jsx(kt,{...g,allMessages:m,groupedMessagesToRender:w,allGroupedMessages:w,isFinalUserTurn:!1,isUserTurn:N,isCompletionRequestInProgress:y,hasActiveRequest:i,shouldGrowContainer:!1,isParagen:!0}),e.jsx(Cs,{clientThreadId:g.clientThreadId,conversationTurnMountTime:g.conversationTurnMountTime,turn:r,originalTurn:l})]})]})]})})})]})}function ys({horizontalScrollContainerRef:t,rootElementRef:s,onClick:n,children:a,hasActiveRequest:r,isWaitingOnFirstUserVisibleToken:i}){const l=Gt(),{scrollX:c}=Ln({layoutEffect:!1,container:t,target:s}),g=_o(),u=jo(),h=o.useRef(null),x=o.useRef(null),p=o.useRef(null),[d,m]=o.useState(!1),[v,b]=o.useState(!1),[k,w]=o.useState(!1),[E,f]=o.useState(0);o.useEffect(()=>{if(!l)return;const N=new IntersectionObserver(M=>{for(const T of M)T.target===h.current?m(T.isIntersecting):T.target===p.current?w(T.isIntersecting):T.target===x.current&&b(T.isIntersecting)},{root:g?.current});return h.current&&x.current&&p.current&&(N.observe(h.current),N.observe(x.current),N.observe(p.current)),()=>{N.disconnect()}},[E,l,g]);const S=!k&&(v||d),A=Hn(c,N=>S?-1*N:0),C=os(0);o.useEffect(()=>{if(!l)return;const N=new ResizeObserver(M=>{tt(M.length===1,"entryList.length === 1");const T=M[0];tt(T.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),C.set(T.contentBoxSize[0].inlineSize)});return s.current&&N.observe(s.current),()=>{N.disconnect()}},[l,C,s]);const j=os(0);o.useEffect(()=>{if(!l)return;const N=new ResizeObserver(M=>{tt(M.length===1,"entryList.length === 1");const T=M[0];tt(T.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),j.set(T.contentBoxSize[0].blockSize+16),f(T.contentBoxSize[0].blockSize)});return u.current&&N.observe(u.current),()=>{N.disconnect()}},[l,j,u]);const y=e.jsx(Ft,{className:l?"px-5":"mt-4 self-start",onClick:n,"data-testid":"paragen-prefer-response-button",children:e.jsx(O,{id:"U2EAH6",defaultMessage:"I prefer this response"})}),G=i;return e.jsxs("div",{"data-paragen-root":!0,className:I("relative flex w-full min-w-[min(450px,80vw)] snap-center flex-col gap-1 text-left",l?"min-h-60 px-10 py-4":"rounded-2xl border border-token-main-surface-tertiary bg-white p-5 dark:bg-gray-700"),ref:s,children:[e.jsx("div",{className:I("absolute left-0 right-0 top-48 h-px","invisible"),ref:h}),e.jsx("div",{className:I("absolute bottom-0 left-0 right-0 top-48","invisible"),ref:x}),e.jsx("div",{className:I("absolute bottom-0 left-0 right-0 h-px","invisible"),ref:p}),a,l?e.jsx("div",{className:"flex-1"}):null,l?e.jsx("div",{className:"mt-4 min-h-10",children:G?null:e.jsx(Q.div,{style:{translateX:A,width:C,bottom:j},animate:{opacity:100},initial:{opacity:0},transition:{ease:"easeOut",duration:.2,delay:.5},className:I({fixed:S,"z-20 flex w-full justify-center":!0}),children:y})}):r?null:y]})}function Ss(){return e.jsxs("div",{className:"flex w-full flex-col gap-4 pb-5 pt-3",children:[e.jsx(Te,{className:"h-4 w-[75%]"}),e.jsx(Te,{className:"h-4 w-[50%]"}),e.jsx(Te,{className:"h-4 w-[80%]"}),e.jsx(Te,{className:"h-4 w-[55%]"}),e.jsx(Te,{className:"h-4 w-[66%]"}),e.jsx(Te,{className:"h-4 w-[64%]"}),e.jsx(Te,{className:"h-4 w-[48%]"})]})}function Gt(){const{layer:t}=ke("3119715334");return t.get("should-enable-hojicha",!1)}const _s=ye.div`text-sm text-token-text-secondary font-semibold`,js=ye.div`flex gap-4 items-center mb-1`,Te=ye.div`animate-pulse rounded-[4px] bg-token-main-surface-tertiary`;function Cs({clientThreadId:t,conversationTurnMountTime:s,turn:n,originalTurn:a}){const r=ta();if(!r.showParagenMetadata||!r.showDebugConversationTurns&&!r.forceParagen||n==null)return null;let i=n===a?"ORIGINAL":"NEW";const l=n.messages[n.messages.length-1],c=l?.metadata?.__internal;if(c){const{model_id:h,model_definition_slug:x,model_definition_virtual_model_id:p,alternative_model_selection_rule:d,augmented_paragen_prompt_group_id:m,augmented_paragen_prompt_id:v,augmented_paragen_prompt:b}=c;h&&(i+=`
Model ID: ${h}`),x&&(i+=`
Model Slug: ${x}`),p&&(i+=`
Virtual Model ID: ${p}`),d&&(i+=`
Alternative Model Rule: ${d}`),m&&(i+=`
Prompt Group ID: ${m}`),v&&(i+=`
Prompt ID: ${v}`),b&&(i+=`
Prompt: ${b}`)}i+=`
Message ID: ${l.id}`;const g=H.getParentPromptNode(lt(t),n.messages[0].id);if(!g)throw new Error("Expected prompt for side by side feedback");const u=g.message.clientMetadata?.variantsInStreamInfo==null&&g.message.metadata?.paragen_variants_info!=null;return i+=`
User prompt message ID: ${g.message.id}`,i+=`
Is Persisted Paragen? ${u}`,i+=`
Completion Sample Finish Time: ${u?`${s} (persisted)`:L(n.messages)?.clientMetadata?.completionSampleFinishTime}`,e.jsx("div",{className:"whitespace-pre-wrap text-sm text-red-500",children:i})}async function Ms({params:t}){await We.submitParagenSelectionV2(t)}const Ts=Ut({responseNumber:{id:"ConversationTurnTwoUpFeedback.responseNumber",defaultMessage:"Response {responseIndex, number}"}});function Vi({handleShowRetrievalResults:t,clientThreadId:s,turnIndex:n,responseComplete:a=!1}){const[r,i]=J(s,h=>[H.getTurnContentReferences(h,n),H.getConversationTurnAtIndex(h,n).messages]),l=o.useMemo(()=>({turnIndex:n,clientThreadId:s,responseComplete:a}),[s,a,n]),c=o.useRef(!1);o.useEffect(()=>{c.current||(c.current=!0,$.logEvent(z.fileSourcesFooterShown,l))},[l]);const g=o.useCallback(()=>{$.logEvent(z.fileSourcesFooterClicked,l),t()},[t,l]),u=o.useMemo(()=>{const h=new Set,x=[];function p(m){!m||h.has(m)||(h.add(m),x.push(m))}if(r.forEach(m=>{m.type==="file"?p(m.cloud_doc_url??m.extra?.cloud_doc_url):m.type==="file_navlist"&&m.items.forEach(v=>{p(v.cloud_doc_url)})}),a){for(const m of i)if(Co(m)){const v=Mo(m.content.result),b=m.metadata?.cloud_doc_urls??[],k=v.chunks;for(let w=0;w<k.length;w++){const E=k[w];if(!E.documentId)continue;if(w<b.length){p(b[w]);continue}const f=E.documentId.endsWith("--google")?E.documentId.split("--")[1]:void 0,S=E.metadata.cloud_doc_url??(f?`https://drive.google.com/file/d/${f}`:void 0);p(S?.toString())}break}}const d=[];for(let m=0;m<x.length;m++){const v=x[m],b=To(v);if(b&&d.push(b.Icon),d.length>=3)break}return d},[i,r,a]);return e.jsxs(e.Fragment,{children:[e.jsx(Q.div,{className:"absolute h-[60px]",initial:{opacity:0},animate:{opacity:1},children:e.jsxs("button",{className:I("not-prose group/footnote mb-2 mt-3 flex w-fit items-center gap-1.5 rounded-xl border border-token-border-light bg-token-main-surface-primary py-2 hover:bg-token-main-surface-secondary","pl-3 pr-2.5"),onClick:g,children:[e.jsx("div",{className:"flex items-center gap-0.5 text-sm font-medium",children:e.jsx(O,{id:"/48IOP",defaultMessage:"Sources"})}),u.length>0&&e.jsx("div",{className:"flex flex-row-reverse gap-1",children:u.reverse().map((h,x)=>e.jsx(Q.div,{className:I("flex items-center overflow-hidden rounded-full border-token-main-surface-primary bg-token-main-surface-primary","group-hover/footnote:border-token-main-surface-secondary","relative"),initial:{opacity:0},animate:{opacity:1},children:e.jsx(h,{className:"icon-md"})},x))})]})}),e.jsx("div",{className:"h-[60px]"})]})}function qi({clientThreadId:t,followups:s,analyticsMetadata:n}){const[a,r]=o.useState(null),i=sa.useIsEnabled(t);return e.jsxs(e.Fragment,{children:[e.jsx(Yi,{visible:a==="conversation"}),e.jsx(Zi,{visible:a==="global"}),i&&s.length>0&&e.jsx($i,{clientThreadId:t,followups:s,analyticsMetadata:n,setDisableMessage:r})]})}function $i({clientThreadId:t,followups:s,setDisableMessage:n,analyticsMetadata:a}){const r=gi(),i=o.useRef(!1),[l,c]=o.useState(-1),{value:g}=ue("2281969373");return o.useEffect(()=>{i.current||(i.current=!0,s.forEach((u,h)=>{$.logEventWithStatsig(z.messageFollowupAction,"chatgpt_message_followup_action",{...me(a),action:"show",position:h+1,followup_text:rt(u)})}))},[s,a]),e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"mb-1 flex items-center text-sm font-semibold",children:[e.jsx(O,{id:"3UFIQc",defaultMessage:"Follow up"}),!g&&e.jsx(Xi,{clientThreadId:t,setDisableMessage:n,analyticsMetadata:a})]}),e.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex w-full flex-col",children:s.slice(0,4).map((u,h)=>e.jsxs(Q.div,{initial:{opacity:0,translateY:4},animate:{opacity:1,translateY:0},transition:{delay:h*.03},exit:{opacity:0,translateY:4},onMouseEnter:()=>{c(h)},onMouseLeave:()=>{c(-1)},children:[h>0&&e.jsx(Qi,{$isSelected:l===h||l===h-1}),e.jsx(Ki,{followUp:u,onSelectingSuggestedReply:r,analyticsMetadata:a,position:h})]},h))})]})}const Qi=ye.div`
  h-[1px] opacity-45
  ${({$isSelected:t})=>t?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light"}
`;function Ki({followUp:t,onSelectingSuggestedReply:s,analyticsMetadata:n,position:a}){return e.jsxs(Q.button,{whileHover:"hover",className:"flex w-full cursor-pointer items-start justify-start gap-2 rounded-lg bg-token-main-surface-primary px-2 py-3 text-start hover:bg-token-main-surface-secondary",onClick:r=>{s(r,t,[],0),$.logEventWithStatsig(z.messageFollowupAction,"chatgpt_message_followup_action",{...me(n),action:"click",position:a+1,followup_text:rt(t)})},onMouseEnter:()=>{$.logEventWithStatsig(z.messageFollowupAction,"chatgpt_message_followup_action",{...me(n),action:"hover",position:a+1,followup_text:rt(t)})},children:[e.jsx(Q.div,{className:"flex items-center justify-center pt-0.5 opacity-70",variants:{hover:{x:4}},initial:{x:0},transition:{duration:.1},children:e.jsx(wo,{className:"h-[18px] w-[18px] text-token-text-secondary"})}),e.jsx("div",{className:"pr-2 text-left text-sm text-token-text-secondary",children:rt(t)})]})}function Xi({clientThreadId:t,setDisableMessage:s,analyticsMetadata:n}){const a=sa.useStore(),[r,i]=o.useState(!1);return e.jsxs(un,{size:"small",onOpenChange:l=>i(l),contentClassName:"min-w-[200px]",triggerButton:e.jsx("button",{className:"ml-2 flex h-6 w-6 items-center justify-center rounded-md text-token-text-tertiary hover:bg-token-main-surface-tertiary focus:outline-none focus:ring-0",children:e.jsx(ko,{className:I("h-4 w-4 opacity-0 group-hover:opacity-100",r&&"opacity-100")})}),children:[e.jsx(ae.Item,{onClick:()=>{a.setDisabledConversation(t,!0),s("conversation"),setTimeout(()=>s(null),3e3),$.logEventWithStatsig(z.messageFollowupSetting,"chatgpt_message_followup_setting",{...me(n),action:"disable_conversation"})},className:"text-token-text-primary",children:e.jsx(O,{id:"GZYofd",defaultMessage:"Hide for this chat"})}),e.jsx(ae.Item,{onClick:()=>{a.setDisabledGlobally(!0),s("global"),setTimeout(()=>s(null),5e3),$.logEventWithStatsig(z.messageFollowupSetting,"chatgpt_message_followup_setting",{...me(n),action:"disable_globally"})},className:"text-token-text-primary",children:e.jsx(O,{id:"dtAOq4",defaultMessage:"Hide everywhere"})})]})}const ba={initial:{opacity:1},animate:{opacity:1},exit:{opacity:0,transition:{duration:.2}}};function Yi({visible:t}){return e.jsx(Ue,{children:t&&e.jsx(Q.div,{...ba,className:"flex justify-center py-6 text-sm text-token-text-tertiary",children:e.jsx(O,{id:"ckTD9g",defaultMessage:"Follow ups are turned off for this conversation"})})})}function Zi({visible:t}){return e.jsx(Ue,{children:t&&e.jsxs(Q.div,{id:"disableForAllConvos",...ba,className:"flex flex-col items-center py-3 text-sm",children:[e.jsx("div",{children:e.jsx(O,{id:"5GDIBQ",defaultMessage:"Follow up have been turned off"})}),e.jsx("div",{className:"pt-1 text-token-text-tertiary",children:e.jsx(O,{id:"LYaBNe",defaultMessage:"You can re-enable them in settings"})})]})})}function Ji({modelSlug:t,animateModelLabelOnRender:s,isDropdownOpen:n,isRegenerateEnabled:a,isHovered:r,animateShortLabel:i}){const{data:l}=Gs(),[c,g]=o.useState("initial");o.useEffect(()=>{if(s){const p=setTimeout(()=>g("show"),500),d=setTimeout(()=>g("initial"),2e3);return()=>{clearTimeout(p),clearTimeout(d)}}g("initial")},[s]);const{shorterLabel:u}=l?.categories.find(({defaultModel:p})=>p===t)??{},h={initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"100%"},visible:{opacity:1,paddingLeft:2,width:"100%",transition:{delay:0,duration:0}}},x=n?"visible":r?"show":c;return e.jsxs(Q.div,{initial:"initial",animate:x,className:"flex items-center pb-0",children:[e.jsx(aa,{className:"icon-md"}),(a||i)&&e.jsx(Q.span,{className:"overflow-hidden text-clip whitespace-nowrap text-sm",variants:h,transition:{type:"tween",duration:.18},children:u}),a&&e.jsx(Fo,{className:"icon-sm"})]})}function jt(t,s){const{modelSwitcherDeny:n,subscriptionLevel:a}=t;return!!n&&n.reason===pn.RATE_LIMIT&&a===fn.PLUS&&!s}const nt="rounded-lg radix-disabled:pointer-events-auto radix-disabled:cursor-not-allowed";function el({className:t,clientThreadId:s,message:n,onModelSelect:a,canRegenerateResponse:r}){const[i,l]=o.useState(null),[c,g]=o.useState(!1),[u,h]=o.useState(!1),x=n.metadata?.model_slug,p=n.id,d=o.useRef(null),m=E=>{E||setTimeout(()=>{d.current&&d.current.blur()},10)};if(o.useEffect(()=>{m(c)},[c]),J(s,Do))return null;const b=Eo(s,n.id),k=n.metadata?.model_slug,w=Uo(b,k);return e.jsxs(ae.Root,{onOpenChange:E=>{r&&(g(E),m(E))},children:[r?e.jsx(Us,{sideOffset:0,label:e.jsx(O,{id:"wDs5sz",defaultMessage:"Switch model"}),children:e.jsx(mn,{ref:d,className:I("cursor-pointer",t),onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:e.jsx(Ji,{modelSlug:k,animateModelLabelOnRender:w,isDropdownOpen:c,isRegenerateEnabled:r,isHovered:u})})}):null,r&&e.jsx(ae.Portal,{children:e.jsxs(ae.Content,{className:"z-30 min-w-fit origin-top-right text-token-text-primary",side:"bottom",align:"start",children:[e.jsx(ae.Item,{disabled:!0,className:"pb-0 pt-2",children:e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(O,{id:"bFLh5u",defaultMessage:"Switch model"})})}),e.jsx(tl,{clientThreadId:s,messageId:p,message:n,onModelSelect:a,messageModelSlug:x,setHoveredOption:l,hoveredOption:i})]})})]})}function tl({clientThreadId:t,message:s,messageId:n,messageModelSlug:a,onModelSelect:r,setHoveredOption:i,hoveredOption:l}){const c=Se(),{data:g=null}=gn(),u=g&&hn(g),{modelOptions:h,messageModelEnabledTools:x}=No({clientThreadId:t,message:s}),p=x.includes(be.Search),d=o.useMemo(()=>h.find(f=>f.value===a),[h,a]),[m,v]=o.useMemo(()=>Ao(h,f=>f.subcategory),[h]),b=Io(s);o.useEffect(()=>{const f=h.some(S=>jt(S,u));$.logEvent(z.conversationOpenMessageModelSelector,{has_get_plus_button:f,is_new_regen_dropdown:!0})},[]);const k=o.useMemo(()=>{const f=new Map;return m.forEach(S=>{const A=S.subcategory;A&&(f.has(A)||f.set(A,[]),f.get(A)?.push(S))}),f},[m]),w=I("icon-sm","order-10 ml-auto text-token-text-tertiary icon-md"),E=[{key:"use-search",extraStreamParams:{forceUseSearch:!0},label:c.formatMessage(Ct.search),icon:e.jsx(Ro,{className:w}),condition:p&&!b,eventName:"chatgpt_regenerate_with_search_button_clicked"},{key:"use-no-search",extraStreamParams:{forceUseSearch:!1},label:c.formatMessage(Ct.nosearch),icon:e.jsx(Po,{className:w}),condition:p&&b,eventName:"chatgpt_regenerate_without_search_button_clicked"}];return e.jsxs(e.Fragment,{children:[v.map(f=>{const{value:S,...A}=f;return e.jsx(st,{value:S,onSelect:C=>{ne.logEvent("chatgpt_regenerate_switch_model_button_clicked",S,{requestedModelId:S,...me({clientThreadId:t,messageId:n})}),r({sourceEvent:C,requestedModelId:S})},includeRegenerate:!1,onMouseEnter:()=>i(S),onMouseLeave:()=>i(null),isHovered:l===S,messageModelSlug:a,includeCheck:!1,shouldShowUpsell:jt(f,u),className:nt,...A,icon:e.jsx("span",{className:w}),clientThreadId:t},S)}),[...k.entries()].map(([f,S])=>e.jsxs(ae.Sub,{children:[e.jsx(ae.SubMenuTrigger,{children:e.jsx("div",{className:"flex grow justify-between gap-2 overflow-hidden",children:f})}),e.jsx(ae.Portal,{children:e.jsx(ae.SubContent,{className:"min-w-fit",children:S.map(A=>{const{value:C,...j}=A;return e.jsx(st,{value:C,onSelect:y=>{ne.logEvent("chatgpt_regenerate_switch_model_button_clicked",C,{requestedModelId:C,...me({clientThreadId:t,messageId:n})}),r({sourceEvent:y,requestedModelId:C})},includeRegenerate:!1,onMouseEnter:()=>i(C),onMouseLeave:()=>i(null),isHovered:l===C,messageModelSlug:a,includeCheck:!1,className:nt,...j,icon:null,shouldShowUpsell:jt(A,u),clientThreadId:t},f+"-"+C)})})})]},f)),!!d&&e.jsxs(e.Fragment,{children:[e.jsx(ae.Separator,{}),e.jsx(st,{onSelect:f=>{ne.logEvent("chatgpt_regenerate_try_again_button_clicked",d.value,{requestedModelId:d.value,...me({clientThreadId:t,messageId:n})}),r({sourceEvent:f,requestedModelId:d.value})},includeRegenerate:!0,onMouseEnter:()=>i(d.value),onMouseLeave:()=>i(null),messageModelSlug:a,includeCheck:!1,className:nt,...d,label:c.formatMessage(Ct.tryAgain),subtitle:d.label,icon:e.jsx(aa,{className:w}),clientThreadId:t},d.value),E.filter(f=>f.condition).map(f=>e.jsx(st,{onSelect:S=>{ne.logEvent(f.eventName,d.value,{requestedModelId:d.value,...me({clientThreadId:t,messageId:n})}),r({sourceEvent:S,requestedModelId:d.value,extraStreamParams:f.extraStreamParams})},includeRegenerate:!1,onMouseEnter:()=>i(f.key),onMouseLeave:()=>i(null),isHovered:l===f.key,messageModelSlug:a,includeCheck:!1,className:nt,...d,label:f.label,subtitle:"",icon:f.icon,clientThreadId:t},f.key))]})]})}const Ct=Ut({tryAgain:{id:"VbsBGW",defaultMessage:"Try again"},search:{id:"eTV6j1",defaultMessage:"Search the web"},nosearch:{id:"IvLzUk",defaultMessage:"Without web search"}}),sl=o.memo(el),al=oe(()=>le(()=>import("./ll7i5gk77hsq89z0.js"),__vite__mapDeps([27,1,2,3,28,29,6,7,30,31,32])).then(t=>t.VoicePlayButton)),nl=oe(async()=>Promise.resolve(()=>null)),ol=({alwaysShow:t,isUserTurn:s,children:n})=>{const a=o.useRef(null);return o.useEffect(()=>{const r=a.current;r&&(t?requestAnimationFrame(()=>{r&&(r.style.maskPosition=t?"0% 0%":"")}):r.style.maskPosition="")},[t]),e.jsx("div",{className:I("flex",!t&&"absolute left-0 right-0 flex",s?"justify-end":"justify-start"),children:e.jsx("div",{ref:a,className:I("-me-1 -ms-2.5 flex select-none items-center p-1 touch:-me-2 touch:-ms-3.5",!s&&"-mt-1",t&&"duration-[1.5s]","focus-within:transition-none hover:transition-none",!(t||s)&&"duration-500 group-hover/turn-messages:delay-300",!s&&["pointer-events-none [mask-image:linear-gradient(to_right,black_33%,transparent_66%)] [mask-position:100%_0%] [mask-size:300%_100%] motion-safe:transition-[mask-position]","group-hover/turn-messages:pointer-events-auto group-hover/turn-messages:[mask-position:0_0]","group-focus-within/turn-messages:pointer-events-auto group-focus-within/turn-messages:[mask-position:0_0]","has-[[data-state=open]]:pointer-events-auto has-[[data-state=open]]:[mask-position:0_0]"],s&&["duration-300 group-hover/turn-messages:delay-300","pointer-events-none opacity-0 motion-safe:transition-opacity","group-hover/turn-messages:pointer-events-auto group-hover/turn-messages:opacity-100","group-focus-within/turn-messages:pointer-events-auto group-focus-within/turn-messages:opacity-100","has-[[data-state=open]]:pointer-events-auto has-[[data-state=open]]:opacity-100"]),children:n})})},rl=({activeVariantIndex:t,clientThreadId:s,conversationMode:n,lastMessage:a,messages:r,numVariants:i,onChangeIndex:l,onRate:c,showCanvasButton:g,showCopyButton:u,showDiscussButton:h,showPagination:x,showPlayButton:p,showRatingButtons:d,showRegenerateButton:m,showShareButton:v,turn:b,turnIndex:k})=>{const w=Os(),E=Se(),f=Bs(),S=a?.clientMetadata?.rating;a?.clientMetadata?.requestId;const A=r.some(C=>{const[j]=C.author.name?.split(".")??[];return j===xn.T2UAY3K});return e.jsxs(e.Fragment,{children:[x&&e.jsx(na,{currentPage:t,onChangeIndex:l,length:i}),!1,u&&e.jsx(ya,{onClick:C=>{oa(w,s,k,f,C)}}),!A&&d&&e.jsxs(e.Fragment,{children:[S!=="thumbsDown"&&e.jsx(it,{onClick:()=>c("thumbsUp"),disabled:S==="thumbsUp",icon:S==="thumbsUp"?Lo:ra,label:E.formatMessage({id:"ConversationTurn.goodResponseTooltip",defaultMessage:"Good response"}),testId:"good-response-turn-action-button"}),S!=="thumbsUp"&&e.jsx(it,{onClick:()=>c("thumbsDown"),disabled:S==="thumbsDown",icon:S==="thumbsDown"?Ho:ia,label:E.formatMessage({id:"ConversationTurn.badResponseTooltip",defaultMessage:"Bad response"}),testId:"bad-response-turn-action-button"})]}),p&&a&&e.jsx(al,{conversationId:s,message:a,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-xs text-token-text-tertiary hover:text-token-text-primary"}),!A&&g&&e.jsx(Go,{turn:b}),v&&e.jsx(it,{onClick:()=>{const C=De(s);C&&ct.openSharingModal(C)},label:E.formatMessage({id:"ConversationTurn.shareButtonTooltip",defaultMessage:"Share conversation"}),className:"sm:hidden",icon:Oo}),h&&!1,m&&a&&e.jsx(ll,{clientThreadId:s,conversationMode:n,lastMessage:a,messages:r,hasImageGenMessage:A})]})},il=({activeVariantIndex:t,clientThreadId:s,numVariants:n,onAnticipateEdit:a,onChangeIndex:r,onEnterEdit:i,showCopyButton:l,showEditMessageButton:c,showPagination:g,turnIndex:u})=>{const h=Os(),x=Bs();return e.jsxs(e.Fragment,{children:[l&&e.jsx(ya,{onClick:p=>{oa(h,s,u,x,p)}}),c&&e.jsx(Bo,{onAnticipateEdit:a,onEnterEdit:i}),g&&e.jsx(na,{currentPage:t,onChangeIndex:r,length:n})]})},ll=({clientThreadId:t,conversationMode:s,messages:n,hasImageGenMessage:a,lastMessage:r})=>{const i=bi({clientThreadId:t,conversationMode:s}),l=zo(t,r),c=o.useCallback(({sourceEvent:g,requestedModelId:u,appendMessages:h,extraStreamParams:x})=>{r&&i({sourceEvent:g,nodeId:r.id,requestedModelId:u,appendMessages:h,extraStreamParams:x})},[r,i]);return a?e.jsx(nl,{messages:n,onModelSelect:c}):e.jsx(sl,{className:"h-[30px] rounded-md px-1.5 text-token-text-secondary hover:bg-token-main-surface-secondary touch:px-2.5",clientThreadId:t,message:r,onModelSelect:c,canRegenerateResponse:l})},ya=({onClick:t})=>{const[s,n]=o.useState(!1),a=Wo(),r=Se(),i=o.useCallback(l=>{l.stopPropagation(),$.logEvent(z.chatgptTurnActionCopyClicked),t(l),n(!0),setTimeout(()=>{a()&&n(!1)},2e3),ne.logEvent("chatgpt_turn_action_copy")},[a,t]);return e.jsx(it,{icon:s?vn:bn,onClick:i,label:r.formatMessage({id:"CopyButton.copyTooltip",defaultMessage:"Copy"}),testId:"copy-turn-action-button"})},ws=[1,2,3,4,10,20,30],cl=.5;function dl({clientThreadId:t}){const s=la(ca.isBusinessWorkspace),n=o.useRef(!1),a=ut(t),[r,i,l,c]=J(t,j=>[j?.mode,H.getRequestId(j),H.getConversationLastTurn(j),H.getConversationTurns(j).filter(y=>y.role===X.Assistant).length]),{isUnauthenticated:g}=Ee(),u=o.useMemo(()=>{if(!a)return-1;const j=ea(a);return j()>cl?-1:ws[Math.floor(j()*ws.length)]},[a]),h=Pt(i),[x,p]=o.useState(null),[d,m]=o.useState(!1),[v,b]=o.useState(!1),[k,w]=o.useState(!1),E=j=>{const y=l?.messages[0]?.id;p(j),S(y,j)},f=l?.role===X.Assistant,S=o.useMemo(()=>Qs((j,y)=>{a&&j&&We.submitConversationRating({conversation_id:a,message_id:j,rating:y,shown_at_assistant_turn:u}),$.logEvent(z.conversationRatingSubmitted,{rating:y,showAtAssistantTurn:u,conversationId:a}),m(!0),setTimeout(()=>{b(!0)},1500)},2e3),[a,u]),A=c!==u||h||!f||!!s||r?.kind!==Dt.PrimaryAssistant||k||g;o.useEffect(()=>{!A&&!n.current&&($.logEvent(z.conversationRatingShown,{showAtAssistantTurn:u,conversationId:a}),n.current=!0)},[A]);const C=Vo();return k||!C.forceShowConvoRating&&A?null:e.jsxs("div",{className:"mx-auto",children:[e.jsx(Ue,{children:d&&!v&&e.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(ks,{$padded:!0,children:e.jsx("span",{className:"text-sm text-token-text-tertiary",children:e.jsx(O,{id:"rating.thanks",defaultMessage:"Thanks for your feedback!"})})})},"submitted")}),!d&&e.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},children:e.jsxs(ks,{$padded:!1,children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 px-4 py-3 text-sm text-token-text-secondary",children:[e.jsx(O,{id:"rating.instructions",defaultMessage:"Is this conversation helpful so far?"}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx(Mt,{$selected:x==="thumbsUp",onClick:()=>E("thumbsUp"),children:e.jsx(ra,{className:"icon-md"})}),e.jsx(Mt,{$selected:x==="thumbsDown",onClick:()=>E("thumbsDown"),children:e.jsx(ia,{className:"icon-md"})})]})]}),e.jsx("div",{className:"w-px flex-1 self-stretch bg-token-main-surface-tertiary"}),e.jsx(Mt,{className:"p-3",$selected:!1,onClick:()=>w(!0),children:e.jsx(yn,{className:"icon-md text-token-text-secondary hover:text-token-text-primary"})})]})},"rating")]})}const Mt=ye.button`
  ${t=>t.$selected?"text-token-text-primary":"text-token-text-secondary"}
  hover:text-token-text-primary
`,ks=ye.div`inline-flex rounded-xl border border-gray-100 dark:border-gray-700
${t=>t.$padded&&"py-3 px-4"}
`,ul=oe(()=>le(()=>import("./nnks6z5apisamygz.js"),__vite__mapDeps([33,1,2,3,6,7,34])));function ml({clientThreadId:t,canShowInlineMessageFeedback:s,messageForRating:n,allGroupedMessages:a,currentModelId:r}){let i=null;const l=J(t,x=>{const p=H.getConversationTurns(x);let d=0;for(let m=p.length-1;m>=0;m--){const v=p[m];if(v.messages.some(b=>b.metadata?.is_indepth_feedback))return!0;if(v.messages.some(b=>b.author.role===X.Assistant)&&d++,d>=3)break}return!1}),c=ut(t),g=Ht(x=>x.voiceFeedbackThread),u=c===g,{voiceName:h}=qo();return l?null:(u&&c?(Sn.feedbackShown.success({voice:h}),i=e.jsx("div",{className:"text-center",children:e.jsx($o,{serverThreadId:c})})):n.clientMetadata?.rating&&s?i=e.jsx(ul,{clientThreadId:t,conversationMessage:n,allGroupedMessages:a,currentModelId:r}):i=e.jsx("div",{className:"text-center",children:e.jsx(dl,{clientThreadId:t})}),e.jsx("div",{className:"mt-3 w-full empty:hidden",children:i}))}const gl=oe(()=>le(()=>import("./7xan75dui0uj586g.js"),__vite__mapDeps([25,2,1,3,6,7,26])).then(t=>t.MemoryActionResult)),hl=oe(()=>le(()=>import("./ipkwqpr5cr94roq5.js"),__vite__mapDeps([35,1,6,2,3,7,36,37,38])).then(t=>t.AutomationSourceHeader)),Es=oe(()=>le(()=>import("./ab09ljgxzdctrygc.js"),__vite__mapDeps([39,1,2,3,6,7,16])).then(t=>t.TextMessageEditor)),Ns=80,pl=16,As={minHeight:`calc(100dvh - ${mr}px - 120px)`};function fl(t){const{turnIndex:s,isFinalTurn:n,clientThreadId:a,onChangeRating:r,onRequestCompletion:i,currentModelId:l,avatarClassName:c,showAvatar:g,scrollToMessageId:u,dateHeaderType:h}=t,x=gt();Fs()?.normalizedAccountUserId;const p=!!x&&_n(x),d=Zs(),m=la(ca.isBusinessWorkspace),v=ma(),{value:b}=ue("1760640904"),{value:k}=ue("1456513860"),w=g??!k,f=null!=null,A=jn("2181185232").config.get("enabled",!1),C=hi(),j=De(a),[y,G]=J(a,_=>{const V=H.getConversationTurnAtIndex(_,s),ce=s>0?H.getConversationTurnAtIndex(_,s-1):null,ve=ce!=null&&ce.role===X.User?ce.messages[0].metadata?.visually_hide_response_from_conversation??!1:!1;return[V,ve]}),{messages:N,messageGroups:M}=y,T=Qo(),F=L(N),{messages:U,visibleMessages:Y,messageGroups:Z,lastMessageToRender:W,doesTurnHaveDelayedMessages:re}=o.useMemo(()=>{const _=T.size===0?-1:M.findIndex(Be=>Be.messages.some(ze=>T.has(ze?.id))),V=_!==-1&&_+1<M.length,ce=V?M.slice(0,_+1):M,ve=V?ce.flatMap(Be=>Be.messages):N;return{messages:ve,visibleMessages:ve.filter(Cn),messageGroups:ce,lastMessageToRender:L(ve),doesTurnHaveDelayedMessages:_!==-1}},[N,M,T]),ee=o.useMemo(()=>({clientThreadId:a,turnIndex:s,messageId:F?.id}),[a,s,F?.id]),P=!1,R=Ks(),[D,Ne]=o.useState(!1),[_e,Le]=o.useState(!1),je=o.useContext(da)!=null,B=y.role===X.User,Ae=At(),te=It(a),ge=Js(y.gizmoId??te).data,Ce=ua(a),he=Ko(Ce),$e=Xo(Ce),Qe=o.useContext(zs),ht=Ws(Qe),[Ie,Ke,pt,He,Re,Pe,Xe,pe,K,Ge,ft,fe]=J(a,_=>{const V=H.getParentPromptNode(_,N[0].id),ce=V?.message.clientMetadata?.variantsInStreamInfo??(V?.message.metadata?.paragen_variant_choice?void 0:V?.message.metadata?.paragen_variants_info),ve=H.getTree(_).getAllSiblingIds(N[0].id),Be=ce&&_?.tree!=null&&ve.some(Me=>{const{errType:es}=_.tree.getLeafFromNode(Me).message.clientMetadata??{};return es!=null&&es!=="info"}),ze=H.getConversationTurns(_);return[_?.async_status===kn.STREAMING,H.isMessageTurnEnded(_,F?.id),Be,gr(_?.mode,ge?.gizmo.id),_?.continuingFromSharedConversationId!=null,null,ze.findIndex(Me=>Me.role===X.User)===s,En(ze,Me=>Me.role===X.User)===s,ze.findIndex(Me=>Me.role===X.Assistant)===s,H.getRequestId(_,F?.id),ce,ve]}),Ot=fe.findIndex(_=>N.some(V=>V.id===_));let Sa="default";const _a=U.some(_=>_.content.content_type===Mn.MultimodalText),{layer:ja}=ke("1547743984"),{layer:Ca}=ke("3119715334"),Ma=Ca.get("should-enable-skip",!1),Ta=j!=null&&R&&ja.get("show_share_button_inline",!1),{isUnauthenticated:Bt}=Ee(),wa=y.messages.map(_=>_.id),xe=o.useRef(null),zt=(u?.length??0)>2&&u!=="finalAgentTurn"&&n&&v,Ye=B?L(Y):void 0,xt=Ye?.id,ka=o.useCallback(()=>{xt&&($.logEvent(z.editPrompt,{id:xt,threadId:De(a)}),ne.logEvent("chatgpt_edit_prompt"),Ne(!0))},[xt,a]),Ea=o.useCallback(()=>{Ne(!1)},[]),Na=_=>{F&&(r({nodeId:F.id,messageId:F.id,rating:_}),$.logEvent(_==="thumbsDown"?z.messageFeedbackThumbsDownClicked:z.messageFeedbackThumbsUpClicked,{id:F.id,threadId:De(a),model:l,rating:_}),Le(!0))},[Aa]=o.useState(()=>Date.now()),Ia=Yo(a),{layer:Ra}=Nt("109457"),Wt=J(a,_=>Ia&&H.getConversationTurns(_).filter(V=>V.role===X.Assistant).length<=Ra.get("onboarding_inject_cards_position",3)),Vt=Ge!=null,Pa=Pt(Ge),ie=!Ke&&Pa||re,qt=Ls(),[Fa,$t]=o.useState(Vt),Qt=o.useRef(!1),Da=Zo(a,F);o.useEffect(()=>{if(Qt.current||u===void 0||!v||!xe.current){u==="finalAgentTurn"&&n&&Fe(a,_=>{_.scrollToMessageId=void 0});return}(wa.includes(u)||u==="finalAgentTurn"&&n)&&(Qt.current=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(xe.current)if(u==="finalAgentTurn"&&n)xe.current.scrollIntoView({behavior:"instant",block:"end"}),Fe(a,_=>{_.scrollToMessageId=void 0});else{const _=xe.current.offsetHeight;let V;_>Ns?V=Ns-_:V=0,xe.current.style.scrollMarginTop=`${V+pl}px`,xe.current.scrollIntoView({behavior:"smooth"})}})}))},[u,xe.current]);const{showDebugConversationTurns:Ua}=ta(),La=Jo(),Ha=!d&&!Re&&!Ae&&!B,Ga=er(),Oa=W?.author.role===X.Assistant?W:null,Ba=W?.metadata?.system_hints?.includes(be.Research);tr({isCompletionRequestInProgress:ie,isUserTurn:B,message:Oa});const{isOpen:za}=pi(),Wa=sr(),Ze=ar(He),Oe=!Ga&&!Ze&&Ha&&n&&ft?.num_variants_in_stream===2&&fe.length<=2&&!F?.clientMetadata?.inlineComparisonRating&&!pt,Je=n&&Vt,Va=(Fa||Je)&&!D&&!d&&!Re&&!Ze&&!Ie&&!ie&&!za&&!Wt&&y.role!==X.Developer,qa=Je&&!ie&&!Re&&!d&&(A||C),et=F!=null&&!f&&(!m||$e||p)&&!Ze&&!Bt&&!Ae&&!F.metadata?.b1de6e2_s,$a=et&&Je&&!Ie&&!ie,Kt=!d&&!((ie||Ie)&&n)&&fe.length>1&&!Oe&&!f&&!Wt,Xt=B&&U.some(_=>nr(_)?.shouldHideContent),Qa=B&&Ye!=null&&!Ze&&!d&&!_a&&!Xt&&!Bt&&!f&&!Ba,Ka=F!=null&&(F.clientMetadata?.disclaimers??[]).length===0,Yt=o.useCallback(_=>{Fe(a,V=>{Rt.setCurrentBranch(V,fe[_])}),$.logEvent(z.changeNode,{intent:"toggle_between"})},[a,fe]),Xa=or(y,U,Ua),{toggleThreadSidebar:Zt}=Tn(),vt=o.useMemo(()=>y.messages.length?y.messages[y.messages.length-1].id:void 0,[y.messages]),Ya=o.useCallback(()=>{vt&&Zt({type:"retrievalResults",clientThreadId:a,turnIndex:s,messageId:vt})},[vt,Zt,a,s]),Za=o.useMemo(()=>rr(y,he,!!te),[he,te,y]);if(!Xa&&!Oe)return zt?e.jsx("div",{style:As}):null;if(G)return null;const Ja=W?.metadata?.followup_prompts?W.metadata.followup_prompts.map(_=>({text:_,type:se.Reply})):[],en=!U.some(_=>wn.getAudioAssetPointers(_).length>0)&&!f&&!te,tn=!ie&&U.some(_=>_.author.role===X.Assistant&&_.metadata?.onboarding?.main_usages),bt=U.find(_=>!!_.metadata?.onboarding?.examples)?.metadata?.onboarding?.examples,Jt=!Xt&&(!B||b)&&(!n||!ie);if(La&&!f&&!n&&Y.length===0)return null;const sn=!n&&y.messages.some(_=>_.clientMetadata?.isLastMessageFromSharedConversation);return e.jsxs(ir.Provider,{value:K,children:[e.jsx(lr,{dateHeaderType:h,turn:y}),e.jsxs("article",{className:I("w-full text-token-text-primary",u==="finalAgentTurn"&&v?"opacity-0":"",{hidden:je&&Xe}),style:zt?As:void 0,ref:xe,dir:"auto","data-testid":`conversation-turn-${s}`,"data-scroll-anchor":n,children:[e.jsx(cr,{role:y.role}),e.jsxs(we,{isStaticSharedThread:d,verticalPadding:Sa,horizontalPadding:Oe?"none":ht||w?"standard":"expanded",children:[Oe?e.jsxs(e.Fragment,{children:[e.jsx(zi,{isFeedbackEnabled:et,variantIds:fe,conversationTurnMountTime:Aa,...t}),Ma&&e.jsx("div",{className:"mt-4 flex w-full justify-center",children:e.jsxs(Ft,{color:"secondary",className:"text-token-text-primary","data-testid":"paragen-skip-button",onClick:()=>{Hs.publish({kind:"requestCompletion",isForSkippingParagen:!0})},children:[e.jsx(dr,{className:"mr-1 text-token-text-secondary"}),e.jsx(O,{id:"IuTr+b",defaultMessage:"Skip"})]})})]}):e.jsx(dt,{shouldRemoveGap:f,tabIndex:-1,className:"group/turn-messages focus-visible:outline-none",onFocus:()=>$t(!0),onPointerEnter:()=>$t(!0),children:e.jsxs(e.Fragment,{children:[P,!B&&!P&&w&&e.jsx(vl,{children:e.jsx(Et,{messages:U,isUserTurn:B,avatarClassName:c,gizmo:ge})}),e.jsx("div",{className:wt({isUserTurn:B,shouldDisplaySideBySideFeedback:Oe}),children:e.jsx("div",{className:"relative flex-col gap-1 md:gap-3",children:e.jsxs(e.Fragment,{children:[null,!B&&!d&&e.jsx(gl,{messages:U,clientThreadId:a,gizmoId:ge?.gizmo.id}),Wa&&!B&&e.jsx(hl,{clientThreadId:a,messages:U}),D&&Ye?e.jsx(Es,{message:Ye,clientThreadId:a,onRequestCompletion:i,onExitEdit:Ea,disabled:qt}):e.jsx(kt,{allMessages:N,groupedMessagesToRender:Z,allGroupedMessages:M,...t,isUserTurn:B,isFinalUserTurn:pe,isCompletionRequestInProgress:ie,isFeedbackEnabled:et,isFinalTurn:n,hasActiveRequest:qt}),Za&&e.jsx(Vi,{handleShowRetrievalResults:Ya,clientThreadId:a,turnIndex:s,responseComplete:!(ie||Ie)}),tn&&e.jsx(li,{clientThreadId:a}),bt&&bt.length>0&&!ie&&e.jsx(ci,{clientThreadId:a,examples:bt}),Va&&e.jsx(ol,{isUserTurn:B,alwaysShow:Je,children:B?e.jsx(il,{activeVariantIndex:Ot,clientThreadId:a,numVariants:fe.length,onAnticipateEdit:Es.prefetch,onChangeIndex:Yt,onEnterEdit:ka,showCopyButton:Jt,showEditMessageButton:Qa,showPagination:Kt,turnIndex:s}):e.jsx(rl,{activeVariantIndex:Ot,clientThreadId:a,conversationMode:He,lastMessage:F,messages:U,numVariants:fe.length,onChangeIndex:Yt,onRate:Na,showCanvasButton:Da&&!f,showCopyButton:Jt,showDiscussButton:!1,showPagination:Kt,showPlayButton:Ka,showRatingButtons:et,showRegenerateButton:en,showShareButton:Ta,turn:y,turnIndex:s})}),$a&&e.jsx(ml,{canShowInlineMessageFeedback:_e,clientThreadId:a,messageForRating:F,allGroupedMessages:M,currentModelId:l}),qa&&e.jsx(qi,{followups:Ja,clientThreadId:a,analyticsMetadata:ee})]})})})]})}),sn&&e.jsx("div",{className:"mx-auto -mb-2 mt-8 flex justify-center",children:e.jsxs("p",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(ur,{className:"icon-xs mr-2"}),e.jsx(O,{id:"threadLayout.sharedConversationPrivateDisclaimer",defaultMessage:"Messages beyond this point are only visible to you"})]})})]})]})]})}const xl=qs.memo(fl),vl=ye.div`flex-shrink-0 flex flex-col relative items-end`;function bl(t){const s=H.getConversationTurns(t),n=s.findIndex(r=>r.role===X.Assistant);if(n===-1)return;const a=s[n];for(let r=0;r<a.messageGroups.length;r++)if(a.messageGroups[r].type===ns.SearchGPTQuery){const l=a.messageGroups.slice(r+1).find(({type:g})=>g===ns.Text);if(l==null)return;const c=Nn(l.messages[0]);if(c?.[0]?.type==="navigation")return{turnIndex:n,navigationCitation:c[0],message:l.messages[0]}}}function yl(t,s){if(s==null||t==null)return t;const n=new Set(t.domains.map(a=>a.url));return{...t,domains:[...t.domains,...s.domains.filter(a=>!n.has(a.url))],safe_urls:[...t.safe_urls??[],...s.safe_urls??[]]}}function Sl({clientThreadId:t,prefetchNavlink:s,setPrefetchNavlink:n}){const a=o.use(s),{value:r}=ue("1032814809");o.useEffect(()=>{window.__oai_SSR_NAVLINK&&hr.logEvent(z.searchToolPageLoadTimeToFastNavSSR,{server_timing:a?.timing},window.__oai_SSR_NAVLINK)},[]),o.useEffect(()=>{a==null&&n(void 0)},[a,n]);const i=o.useMemo(()=>a==null?null:{...a.navlink,domains:a.navlink.domains.map(g=>({...g,subtitle:g.subtitle??g.domain}))},[a]),l=J(t,bl),c=o.useMemo(()=>yl(i,l?.navigationCitation),[l,i]);return a==null||c==null?null:e.jsxs("div",{children:[e.jsx(we,{horizontalPadding:"expanded",children:e.jsx(dt,{children:e.jsx("div",{className:wt({isUserTurn:!0,shouldDisplaySideBySideFeedback:!1}),children:e.jsx("div",{className:yi(!0),children:e.jsx(pr,{containsImagesOrAttachments:!1,isUserTurn:!0,children:e.jsx(fr,{text:a.query})})})})})}),e.jsx("div",{className:"-mb-10",children:e.jsx(we,{horizontalPadding:"expanded",children:e.jsx(dt,{children:e.jsxs("div",{className:wt({isUserTurn:!1,shouldDisplaySideBySideFeedback:!1}),children:[e.jsx(vi,{clientThreadId:t,turnIndex:l?.turnIndex??2,nextMessage:l?.message,navigationCitation:c}),r?e.jsxs("div",{className:"relative -top-2 flex justify-end gap-2 font-mono text-xs text-token-text-secondary",children:[e.jsxs("div",{elementtiming:"navlink",children:["server: ",a.timing,"ms"]}),e.jsx(_l,{})]}):null]})})})}),e.jsx(xr,{scriptSrc:"requestAnimationFrame(()=>window.__oai_SSR_NAVLINK=window.__oai_SSR_NAVLINK||performance.now());"})]})}function _l(){const[t,s]=o.useState(null);return o.useEffect(()=>{const n=new PerformanceObserver(a=>{a.getEntries().forEach(r=>{if(r.identifier==="navlink"){const i=r.renderTime;s(l=>l??i)}})});return n.observe({type:"element",buffered:!0}),()=>n.disconnect()},[]),t==null?null:e.jsxs("span",{children:["render: ",t,"ms"]})}function jl({onChangeRating:t,onRequestCompletion:s,clientThreadId:n,scrollContainerRef:a,prefetchNavlink:r,setPrefetchNavlink:i}){const[l,c,g,u]=J(n,T=>[T?.mode,H.getConversationTurnIds(T),T?.conversationOrigin===An.APPLE,T?.scrollToMessageId]),h=vr(),x=ga(),p=ma(),d=br(),[m]=yr(),v=Sr(),[b]=_r(),k=ua(n),w=h.store.useContentAreaDimensions(jr.Header,T=>T?.height?T.height:void 0),E=Cr(k.id),f=l?.kind===Dt.GizmoMagicCreate?"bg-token-main-surface-primary text-token-text-primary":E;o.useEffect(()=>{x&&(ne.logEvent("chatgpt_continue_conversation_page_loaded"),$.logEvent(z.continueConversationPageLoaded),ne.logEvent("chatgpt_conversation_share_page_loaded"),$.logEvent(z.sharedConversationPageLoaded))},[x]);const S=o.useCallback(()=>{d({behavior:"smooth"})},[d]),[A,C]=o.useState(!1),j=A||!p,y=Mr(n),G=o.useRef(null),{getAndroidKeyboardLayout:N}=Xs(),M=Tr(n);return e.jsxs("div",{onCopy:y,className:I("mt-1.5 flex flex-col text-sm @thread-xl/thread:pt-header-height",N()&&"keyboard-open:pb-[calc(var(--composer-height,100px)+var(--screen-keyboard-height,0))]",w?null:"md:pb-9"),style:{paddingBottom:w},children:[r?e.jsx(In,{name:"prefetch-navlink",onError:T=>{Ve.addError("Error with prefetch navlink",{error:T}),i(void 0)},children:e.jsx(o.Suspense,{fallback:null,children:e.jsx(Sl,{clientThreadId:n,prefetchNavlink:r,setPrefetchNavlink:i})})}):null,x&&e.jsxs(e.Fragment,{children:[e.jsx(dt,{children:e.jsx("p",{className:"text-xs text-gray-500",children:e.jsx(O,{id:"threadLayout.sharedConversationCopyDisclaimer",defaultMessage:"This is a copy of a conversation between ChatGPT & Anonymous."})})}),e.jsx("div",{className:"text-center text-xs font-semibold text-token-text-primary",children:e.jsx("button",{onClick:()=>{ct.openModal(wr.ReportConversation),ne.logEvent("chatgpt_conversation_share_report_content_clicked",null,{location:"Static Shared Thread Page"}),$.logEvent(z.sharedConversationReportContentClicked,{location:"Dynamic Shared Thread Page"})},children:e.jsx(O,{id:"thread.reportSharedConversation",defaultMessage:"Report content"})})})]}),c.map((T,F)=>e.jsx(xl,{isFinalTurn:F===c.length-1,turnIndex:F,clientThreadId:n,onChangeRating:t,onRequestCompletion:s,currentModelId:k.id,avatarClassName:f,scrollToBottom:S,scrollToMessageId:u,dateHeaderType:M(F),showAvatar:void 0},T)),a?.current&&e.jsx(Vs,{setIsScrolledToEdge:C,options:{root:a.current,threshold:0,rootMargin:"0%"}},"threadBottomEdgeScrollObserver"),e.jsx("div",{ref:G}),g&&m&&!b&&e.jsx(Is,{className:I("translate-y-[10px] md:translate-y-[30px]"),onClick:()=>{ne.logEvent("chatgpt_thread_scroll_to_top"),v({behavior:"smooth"})},children:e.jsx(kr,{className:"icon-md text-token-text-primary"})}),e.jsx(Ue,{children:j&&e.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeInOut"},children:e.jsx(Is,{className:I(w?null:"bottom-5"),style:{bottom:w},onClick:()=>{ne.logEvent("chatgpt_thread_scroll_to_bottom"),G.current?.scrollIntoView({behavior:"smooth",block:"end"})},children:e.jsx(Er,{className:"icon-md text-token-text-primary"})})})})]})}const Is=ye.button`cursor-pointer absolute z-10 rounded-full bg-clip-padding border text-token-text-secondary border-token-border-light right-1/2 translate-x-1/2 bg-token-main-surface-primary w-8 h-8 flex items-center justify-center`,Cl=oe(()=>le(()=>import("./mbebmpz9wmc7vznv.js"),__vite__mapDeps([40,2,1,3,6,7,41,42,43,44,45,30,46,47])).then(t=>t.OpenDebugSidebarButton)),Ml=oe(()=>le(()=>import("./ot41yq4ptkktbpbq.js"),__vite__mapDeps([48,1,6,2,3,7]))),Tl=oe(()=>le(()=>import("./btkfu0lwj7996ioj.js"),__vite__mapDeps([49,1,2,3,50,6,7])).then(t=>t.default));function wl({clientThreadId:t}){const s=Gn(),n=ut(t),a=J(t,H.getGizmoId),r=async()=>{n&&(await We.patchConversation(n,{is_archived:!1}),s.invalidateQueries({queryKey:["conversation",t]}),Fe(n,i=>{i.initialThreadData.isArchived=!1}),Jr(s,a))};return e.jsxs("div",{className:"my-6 flex flex-col items-center justify-center gap-4",children:[e.jsx("div",{className:"px-3 text-center text-sm text-token-text-secondary",children:e.jsx(O,{id:"thread.archivedConversationDescription",defaultMessage:"This conversation is archived. To continue, please unarchive it first."})}),e.jsx("div",{children:e.jsx(Ft,{disabled:!n,onClick:r,icon:Yr,children:e.jsx(O,{id:"thread.unarchiveButton",defaultMessage:"Unarchive"})})})]})}const kl=function({clientThreadId:t,getGizmosCompletionParams:s,hideAppLaunchers:n,hideHeader:a,hideFooter:r,hideToolsOverlay:i,messagesVerticalAlign:l="top",renderEmptyState:c}){const g=Rn(),{data:u}=Gs(),h=Nr(t),x=Pn(),[p,d,m,v,b,k,w]=J(t,K=>[K?.isLoading,H.getCurrentLeafId(K),H.hasUserMessage(K),H.getConversationTurns(K).length,H.getThreadData(K).isArchived,K?.modelId,K?H.getGizmoId(K):x]),{prefetchSearchPromises:E}=Vn(),[f,S]=o.useState(E?.navlink),[A,C]=o.useState(0);o.useEffect(()=>{p||(ot(t)?Ve.addTiming("chatgpt.web.chatPage.renderNewConversation"):Ve.addTiming("chatgpt.web.chatPage.renderExistingConversation"))},[t,p]);const{setTargetedContent:j}=Ar(),y=g?.includes(Fn),G=Ir(),N=null,M=v>=2,T=ot(t)&&!M&&St(h)&&E==null,F=ot(t)&&!m&&(St(h)||h?.kind===Dt.GizmoTest)&&E==null,Y=Rr(u).id,Z=k??Y,W=!!k,re=Pr(u?.models,Z),ee=Fr(t,h),P=Dr();Ur(v,t),o.useEffect(()=>{P||j(void 0)},[t,j,P,d]),o.useEffect(()=>{ct.setIsConversationScrolledFromTop(!1)},[t]);const R=On(t),D=o.useCallback(K=>{R(s?s(K):K)},[s,R]),{caModal:Ne,onChangeRating:_e}=Lr({clientThreadId:t,currentModelConfig:re}),Le=Hr({clientThreadId:t,handleRequestCompletion:D,prefetchSearchThreadIdPromise:E?.threadId})&&f==null,je=o.useRef(null),B=K=>{{const Ge=e.jsx("div",{className:"relative h-full",children:e.jsxs("div",{className:"flex h-full flex-col overflow-y-auto [scrollbar-gutter:stable]",ref:je,children:[e.jsx(Vs,{setIsScrolledToEdge:ft=>{ct.setIsConversationScrolledFromTop(ft)},options:{root:je?.current}}),K]})});return f!=null?Ge:e.jsx(Dn,{children:e.jsxs(o.Suspense,{fallback:null,children:[e.jsx(Zr,{}),Ge]})})}};o.useEffect(()=>{document.title=ee??"ChatGPT"},[ee,N]);const Ae=o.useContext(zs),te=Ws(Ae),ge=te,Ce=ga(),he=o.useRef(null),$e=o.useRef(null),Qe=Gr(K=>K.composerHeight),ht=o.useMemo(()=>({threadContentScrollContainerElementRef:he,footerRootContainerElementRef:$e}),[]),{value:Ie}=ue("3861593998"),{isUXUpdatesEnabled:Ke}=qe(),pt=Lt(),He=Ys(w),Re=!1,Pe=!!w,Xe=Pe&&He,pe=Pe&&!He||Ie&&!Xe;return e.jsx(da.Provider,{value:f,children:e.jsx(Or,{children:e.jsx(ni,{clientThreadId:t,children:e.jsxs($s,{clientThreadId:t,children:[y&&e.jsx(Ml,{}),e.jsx(Br,{children:ee!=null&&e.jsx("title",{children:ee})}),e.jsx(zr.Provider,{value:D,children:e.jsxs(Wr,{children:[e.jsxs(Vr,{currentPage:A,setCurrentPage:C,enableScroll:!1,className:I("@container/thread",!1),children:[e.jsxs(di,{noKeyboard:!0,clientThreadId:t,currentModelConfig:re,className:I("composer-parent flex h-full flex-col focus-visible:outline-0",Re),children:[e.jsxs(qr,{value:ht,children:[!a&&e.jsx(Hi,{clientThreadId:t,isEmptyState:F}),e.jsx("div",{ref:he,className:"flex flex-1 grow basis-auto flex-col overflow-hidden",style:{"--composer-height":Qe?`${Qe}px`:void 0},children:!p&&!Le?F?c??e.jsx(e.Fragment,{children:Pe?e.jsx(ei,{clientThreadId:t,gizmoId:w,onRequestCompletion:D,currentModelId:Z}):e.jsx(Ri,{clientThreadId:t,currentModelId:Z,isModelLoaded:W,onRequestCompletion:D,shouldUseUnifiedComposer:pe})}):M||f!=null?B(e.jsx(jl,{onChangeRating:_e,onRequestCompletion:D,clientThreadId:t,scrollContainerRef:je,prefetchNavlink:f,setPrefetchNavlink:S},t)):null:null})]}),e.jsx("div",{className:I("isolate w-full basis-auto has-[[data-has-thread-error]]:pt-2 has-[[data-has-thread-error]]:[box-shadow:var(--sharp-edge-bottom-shadow)] dark:border-white/20 md:border-transparent md:pt-0 md:dark:border-transparent",pe&&T&&(pt?"@lg/thread:grow":"lg:grow"),pe&&"flex flex-col"),ref:$e,children:b?e.jsx(wl,{clientThreadId:t}):e.jsxs(e.Fragment,{children:[(!T||pe)&&e.jsx(e.Fragment,{children:e.jsx(ui,{isGizmoThread:Pe,isProjectThread:Xe,clientThreadId:t,isNewThread:T,currentModelId:Z,onRequestCompletion:D,shouldUseUnifiedComposer:pe,isModelLoaded:W,isVanguardUxEnabled:Ke})}),T&&e.jsx(pa,{clientThreadId:t}),T&&pe&&Ke&&!Pe&&!n&&A===0&&e.jsx("div",{style:{marginTop:"-80px"},children:e.jsx(fa,{clientThreadId:t})}),!r&&!ge&&!Re&&St(h)?e.jsx("div",{className:"relative mt-auto flex min-h-8 w-full items-center justify-center p-2 text-center text-xs text-token-text-secondary md:px-[60px]",children:e.jsx($r,{clientThreadId:t})}):e.jsx("div",{className:"h-4"})]})})]}),!1]}),!i&&!te&&e.jsxs("div",{className:"group absolute bottom-2 end-2 z-20 flex flex-col gap-1 md:flex lg:bottom-3 lg:end-3",children:[G?e.jsxs(e.Fragment,{children:[e.jsx(Cl,{}),!1]}):null,e.jsx(Tl,{})]}),Ne,e.jsx(Qr,{clientThreadId:t,isStaticSharedThread:!1,isDynamicSharedThread:Ce}),e.jsx(Kr,{}),e.jsx(Xr,{conversationId:t})]})})]})})})})},ql=qs.memo(kl);export{Ui as C,ql as M};
//# sourceMappingURL=cffgjlidl1olpt2q.js.map
