import{r as c,e as k,j as e,a5 as j,a7 as z,u as se,M as S,d as ne}from"./fs6h2trisr1juto6.js";import{a3 as oe,dE as Q,S as y,P as b,a as _,dD as ae,bw as ie,c5 as v,e$ as re,V as le,fC as ce,F as de,Z as pe,R as ue,A as ge}from"./njq6ygky3ttysgdk.js";import{bk as B,O as me,U as R,b_ as $,b$ as fe,c0 as he,c1 as xe,c2 as ye,c3 as G,c4 as be,c5 as _e,c6 as we,ad as Se,c7 as ve,c8 as Me}from"./d7a6rc8fexfzu7dt.js";import{u as je,a as ke,m as Ee}from"./fu6bathgya5b9rdr.js";import{a as Ne}from"./ijutvl794yycgs5p.js";import{M as Ce}from"./cffgjlidl1olpt2q.js";import"./lj0prj6na7gf1jpf.js";import"./csg4i0wk6hi0jvkd.js";import"./n9whwsbg0rx5cs8k.js";import"./i6ze5suolzahci5v.js";import"./en8ogvlmn3lccz09.js";import"./jyg6m0czwgwjnl3i.js";import"./kukctmibghbbqwq7.js";import"./gunpso70jnmarvod.js";import"./gvhvfcdqhc5unmaw.js";import"./wqepkoieaii7q4ep.js";import"./gfo75oujoeaedm5y.js";import"./npeck75bz46c490i.js";import"./m97sb2fnwj0a6vyo.js";import"./cm0hdcditutj2jz2.js";import"./jcoe6v231ph25bfi.js";function Pe(t,i){const{data:o,isLoading:d,isSuccess:p,isError:f}=se({queryKey:["onboardingSteps",t,i],queryFn:()=>ue.safePost("/onboarding/steps",{requestBody:{main_usage:void 0,main_usages:t,user_description:i},authOption:ge.SendIfAvailable})});return{steps:o?.steps??[],isLoading:d,isSuccess:p,isError:f}}function E({children:t,className:i}){return e.jsx(j.div,{className:i,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.25},exit:{opacity:0,y:-10},children:t})}function Te({isFirstStep:t,userName:i}){return e.jsx(E,{children:e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(S,{...t?a.preparingOnboardingExperience:a.allSetLetMeShowYouAroundWithoutName,values:{name:i,nextLine:o=>e.jsx("span",{className:"block",children:o})}})})})}function Ie({setIsInWelcomePage:t}){const i=B();return c.useEffect(()=>{i&&setTimeout(()=>{t(!1)},2500)},[i,t]),i?e.jsx(E,{children:e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(S,{...a.imChaggptNiceToMeetYou})})}):null}function Ue(t){const i=$(),o=k(),d=le(),p=fe(t);let f=he(t);const m=xe(p,f),s=ye(p,f);return c.useCallback(async u=>{const n="text/plain",h=new Blob([u],{type:n}),x=new File([h],"My_File.txt",{type:n});return G.uploadFile(i,be(x),x,_e.Retrieval,s,o,d,void 0,m?.attachments)},[i,o,d,s,m?.attachments])}function ot({clientThreadId:t,setClientThreadId:i}){const[o,d]=c.useState(!0),{isOpen:p,setIsOpen:f,markAsViewed:m}=je(),[s,u]=c.useState(0),[n,h]=c.useState(new Set(["usage_question"])),[x,M]=c.useState([]),[T,Y]=c.useState(),[I,U]=c.useState(!1),{steps:g,isLoading:N,isError:C}=Pe(I?x:[],I?T:void 0),K=B(),D=ke({clientThreadId:t}),O=Ue(t),{createNewThread:F}=me({clientThreadId:t,setClientThreadId:i}),L=oe(t,de.hasUserMessage),{layer:V}=Q("109457"),Z=V.get("keep_onboarding_after_dismiss",!1),A=k();c.useEffect(()=>{p?(y.logEvent("chatgpt_onboarding_flow_shown"),b.logEvent(_.onboardingShown)):R.setOnboardingConvoState(null)},[p]),c.useEffect(()=>{C&&(m(),y.logEvent("chatgpt_onboarding_flow_error"),b.logEvent(_.onboardingError))},[C,m]),c.useEffect(()=>{if(!(N||!g[s])&&!n.has(g[s].step_type)){h(w=>new Set([...w,g[s].step_type]));const l=g[s].step_prompt;l&&(R.setOnboardingConvoState({onboardingConvoClientThreadId:t}),D({eventSource:"url",stepPrompt:l,authorMetadata:{real_author:ae.Onboarding}}),g[s].step_type==="file_upload"&&g[s].additional_info&&O(g[s].additional_info))}},[s,N,n,D,g,O,t]);const r=g[s];if(c.useEffect(()=>{const l=r?.step_type;(l==="usage_question"||l==="self_description")&&L&&(F(),h(w=>new Set(Array.from(w).filter(q=>q==="usage_question"||q==="self_description"))))},[r?.step_type,F,L]),c.useEffect(()=>{r?.step_type&&(y.logEvent("chatgpt_onboarding_step_shown",null,{step_type:r?.step_type,step_index:s.toString()}),b.logEvent(_.onboardingStepShown,{step_type:r?.step_type,step_index:s.toString()}))},[s,r?.step_type]),C)return null;const P=l=>{f(!1),s===g.length-1?(y.logEvent("chatgpt_onboarding_flow_finished"),b.logEvent(_.onboardingFinished)):(y.logEvent("chatgpt_onboarding_flow_dismissed",null,{step_type:r?.step_type,step_index:s.toString()}),b.logEvent(_.onboardingDismissed,{step_type:r?.step_type,step_index:s.toString()})),l&&!Z&&m()},J=l=>{M(l),g.find(w=>w.step_type==="self_description")||U(!0),u(w=>w+1),y.logEvent("chatgpt_onboarding_usage_question_selected",null,{main_usages:l.join(", ")}),b.logEvent(_.onboardingUsageQuestionSelected,{main_usages:l.join(", ")})},X=l=>{Y(l),U(!0),u(w=>w+1),y.logEvent("chatgpt_onboarding_self_description_entered",null,{main_usages:x.join(", ")}),b.logEvent(_.onboardingSelfDescriptionEntered,{main_usages:x.join(", ")})},ee=()=>{y.logEvent("chatgpt_onboarding_usage_question_skipped",null,{step_type:r?.step_type,step_index:s.toString()}),b.logEvent(_.onboardingUsageQuestionSkipped,{step_type:r?.step_type,step_index:s.toString()}),u(l=>l+1)},te=()=>{y.logEvent("chatgpt_onboarding_go_back",null,{step_type:r?.step_type,step_index:s.toString()}),b.logEvent(_.onboardingGoBack,{step_type:r?.step_type,step_index:s.toString()}),u(l=>l-1)};return e.jsx(ie,{isOpen:p,onClose:()=>P(!1),type:"success",size:"fullscreen",noPadding:!0,className:"w-full",children:e.jsx(Ne,{clientThreadId:t,children:e.jsxs("div",{className:"flex h-full max-h-full flex-col bg-token-main-surface-primary",children:[e.jsxs("div",{className:"absolute left-0 top-0 z-10 flex w-full items-center justify-between bg-none px-4",style:{minHeight:"var(--screen-thread-header-min-height,60px)"},children:[g&&g.length>0&&e.jsx("div",{className:"absolute left-0 top-0 h-2 w-full",children:e.jsx(j.div,{className:"h-1.5 bg-token-main-surface-primary-inverse",initial:{width:"0%",opacity:0},animate:{width:`${(s+1)/g.length*100}%`,opacity:1},transition:{duration:.3}})}),s>0?e.jsx(v,{onClick:te,color:"ghost",className:"border-none",icon:re}):e.jsx("div",{}),r?.step_type==="usage_question"||r?.step_type==="self_description"?e.jsx(v,{onClick:ee,color:"ghost",className:"border-none",children:A.formatMessage(a.skip)}):e.jsx(v,{onClick:()=>P(!0),color:"ghost",className:"border-none",children:A.formatMessage(a.close)})]}),e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center overflow-hidden",children:e.jsx(z,{mode:"wait",children:o?e.jsx(Ie,{setIsInWelcomePage:d},"welcome"):N?e.jsx(Te,{isFirstStep:s<1,userName:K?.name},"loading"):r?.step_type==="usage_question"?e.jsx(De,{mainUsagesProp:x,onSelectMainUsages:J},"usage-question"):r?.step_type==="self_description"?e.jsx(Oe,{mainUsages:x,selfDescriptionProp:T,onEnterSelfDescription:X},"self-description"):["dalle","file_upload","canvas","voice","ask_any_question"].includes(r?.step_type)?e.jsx(Fe,{step:r,gotoStep:u,stepIndex:s,totalSteps:g.length,endOnboarding:P,clientThreadId:t},"tools-onboarding"):null})})]})})})}function De({mainUsagesProp:t,onSelectMainUsages:i}){const[o,d]=c.useState(new Set(t)),[p,f]=c.useState(void 0),m=k(),s=()=>{const n=new Set(o);n.has("other")&&p&&(n.add(p),n.delete("other")),i(Array.from(n))},u=["school","work","personalTasks","funAndEntertainment","other"];return e.jsxs(E,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(S,{...a.tellMeWhyHere})}),e.jsx("p",{className:"mb-6 text-base text-token-text-secondary",children:e.jsx(S,{...a.suggestUsefulIdeas})})]}),e.jsxs("div",{className:"flex flex-col items-start justify-start gap-7 pl-2.5",children:[u.map(n=>e.jsx(we,{id:`main-usage-${n}`,checked:o.has(n),onChange:h=>d(x=>{const M=new Set(x);return h.target.checked?M.add(n):M.delete(n),M}),label:e.jsx("span",{className:"cursor-pointer",children:m.formatMessage(Ee[n])}),className:"!rounded-full"},n)),o.has("other")&&e.jsx(Se,{ariaLabel:m.formatMessage(a.tellMeWhyHere),name:"other",placeholder:m.formatMessage(a.tellMeWhyHere),onChange:n=>f(n.target.value),maxLength:100,className:"ml-6 min-w-64 bg-token-main-surface-primary"})]}),e.jsx(v,{size:"medium",color:"primary",onClick:s,className:"mt-10",disabled:o.size===0,children:e.jsx(S,{...a.next})})]})}function Oe({mainUsages:t,selfDescriptionProp:i,onEnterSelfDescription:o}){const[d,p]=c.useState(i),f=k(),m=c.useMemo(()=>t.includes("school")?a.exampleSchoolSelfDescription:t.includes("work")?a.exampleWorkSelfDescription:t.includes("funAndEntertainment")?a.exampleFunAndEntertainmentSelfDescription:a.examplePersonalTasksSelfDescription,[t]),{layer:s}=Q("109457"),u=s.get("write_custom_instructions_in_onboarding",!1),n=async()=>{o(d),u&&d&&pe.createOrUpdateUserSystemMessage({aboutUserMessage:d,aboutModelMessage:"",disabledTools:[],enabled:!0}).catch(()=>{})};return e.jsxs(E,{className:"flex w-[640px] flex-col items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"mb-4 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(S,{...a.anythingElseYouWantMeToKnow})}),e.jsx("p",{className:"text-base text-token-text-secondary",children:e.jsx(S,{...u?a.selfDescriptionReasonSaveToCustomInstructions:a.selfDescriptionReason,values:{customInstructions:h=>e.jsx("a",{href:ve,className:"underline",target:"_blank",rel:"noreferrer",children:h})}})})]}),e.jsx(Me,{className:"!dark:bg-white/5 mt-10 rounded border border-token-border-light !bg-black/5 p-5 !text-base placeholder-token-text-tertiary",placeholder:f.formatMessage(m),rows:4,value:d,onChange:h=>p(h.target.value),autoFocus:!0}),e.jsx(v,{size:"medium",color:"primary",onClick:n,className:"mt-10",children:e.jsx(S,{...a.next})})]})}function Fe({step:t,gotoStep:i,stepIndex:o,totalSteps:d,endOnboarding:p,clientThreadId:f}){const m=ce({clientThreadId:f}),s=$(),u=k(),n=o===d-1,h=()=>{o<d-1?(y.logEvent("chatgpt_onboarding_flow_next_clicked",null,{source_step_type:t?.step_type,source_step_index:o.toString()}),b.logEvent(_.onboardingNextClicked,{source_step_type:t?.step_type,source_step_index:o.toString()}),t?.step_type==="file_upload"&&G.reset(s),i(o+1)):p(!0),document.body.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})};return e.jsxs(E,{className:"flex h-full w-full flex-row px-8 md:px-12 lg:px-16 xl:px-24",children:[e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center",children:e.jsxs(j.div,{className:"flex w-[90%] flex-1 flex-col items-start justify-center gap-2 md:w-[85%] lg:w-[80%]",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs(z,{mode:"wait",children:[e.jsx(j.h1,{className:"mb-2 text-3xl font-medium text-token-text-primary",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},exit:{opacity:0,y:-10},children:t.title?t.title:W[t.step_type]?u.formatMessage(W[t.step_type]):null},`title-${o}`),e.jsx(j.p,{className:"mb-6 text-base text-token-text-secondary",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},exit:{opacity:0,y:-10},children:t.subtitle?t.subtitle:H[t.step_type]?u.formatMessage(H[t.step_type]):null},`subtitle-${o}`)]}),e.jsx(v,{size:"large",color:"primary",onClick:h,disabled:m&&!n,children:e.jsx(S,{...n?a.tryChatGPT:a.next})})]})}),e.jsx("div",{className:"relative flex h-full min-w-[360px] flex-1 flex-col pb-16 pt-16",children:e.jsx("div",{className:"h-full w-full overflow-auto rounded-[30px] bg-token-main-surface-primary shadow-[0_0_50px] shadow-token-border-light",children:e.jsx(Ce,{hideHeader:!0,hideToolsOverlay:!0,clientThreadId:f})})})]})}const a=ne({skip:{defaultMessage:"Skip",id:"chatgpt.new-onboarding.skip"},close:{defaultMessage:"Close",id:"chatgpt.new-onboarding.close"},submit:{defaultMessage:"Submit",id:"chatgpt.new-onboarding.submit"},next:{defaultMessage:"Next",id:"chatgpt.new-onboarding.next"},finish:{defaultMessage:"Finish",id:"chatgpt.new-onboarding.finish"},tellMeWhyHere:{defaultMessage:"Tell me about why you’re here.",id:"chatgpt.new-onboarding.tell-me-why-here"},suggestUsefulIdeas:{defaultMessage:"I’ll use this information to suggest ideas you might find useful.",id:"chatgpt.new-onboarding.suggest-useful-ideas"},imChaggptNiceToMeetYou:{defaultMessage:"👋 Hi, I’m ChatGPT. It’s nice to meet you!",id:"chatgpt.new-onboarding.im-chatgpt-nice-to-meet-you"},preparingOnboardingExperience:{defaultMessage:"Preparing your onboarding experience...",id:"chatgpt.new-onboarding.preparing-onboarding-experience"},oneLastQuestion:{defaultMessage:"One last question:",id:"chatgpt.new-onboarding.one-last-question-2"},anythingElseYouWantMeToKnow:{defaultMessage:"Is there anything else you’d like me to know?",id:"chatgpt.new-onboarding.anything-else-you-want-me-to-know-2"},oneQuestionAnythingElse:{defaultMessage:"One last question: Is there anything else you’d like me to know?",id:"chatgpt.new-onboarding.one-more-question"},selfDescriptionReason:{defaultMessage:"Details like your job, hobbies, or interests make my responses more relevant.",id:"chatgpt.new-onboarding.self-description-reason"},allSetLetMeShowYouAroundWithoutName:{defaultMessage:"All set!<nextLine></nextLine>Now, let me show you around...",id:"chatgpt.new-onboarding.all-set-let-me-show-you-around-without-name"},selfDescriptionReasonSaveToCustomInstructions:{defaultMessage:"Details like your job, hobbies, or interests make my responses more relevant. I’ll save this information as <customInstructions>Custom Instructions</customInstructions>, which you can update any time.",id:"chatgpt.new-onboarding.self-description-reason-save-to-custom-instructions"},exampleSchoolSelfDescription:{defaultMessage:"I'm a college student studying computer science, and I love to play the guitar.",id:"chatgpt.new-onboarding.example-school-self-description"},exampleWorkSelfDescription:{defaultMessage:"I'm a graphic designer based in Berlin, and I enjoy painting and attending art exhibitions.",id:"chatgpt.new-onboarding.example-work-self-description"},examplePersonalTasksSelfDescription:{defaultMessage:"I live in Sydney and love cooking new recipes and planning travel itineraries.",id:"chatgpt.new-onboarding.example-personal-tasks-self-description"},exampleFunAndEntertainmentSelfDescription:{defaultMessage:"I'm a music enthusiast based in Nashville, and I can talk for hours about guitar techniques and songwriting.",id:"chatgpt.new-onboarding.example-fun-and-entertainment-self-description"},tryChatGPT:{defaultMessage:"Try ChatGPT",id:"chatgpt.new-onboarding.try-chatgpt"}}),W={usage_question:a.tellMeWhyHere},H={usage_question:a.suggestUsefulIdeas};export{Te as LoadingState,ot as default};
//# sourceMappingURL=ek0zfw3jxl64p1zu.js.map
