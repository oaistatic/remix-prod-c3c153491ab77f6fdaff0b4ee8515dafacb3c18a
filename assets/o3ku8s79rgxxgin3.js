import{j as e,r as x,M as k}from"./fs6h2trisr1juto6.js";import{d as r,a3 as w,B as S,z as C,bS as E,P as M,a as T,l as _,c5 as P,X as D}from"./njq6ygky3ttysgdk.js";import{d$ as A,e0 as $}from"./d7a6rc8fexfzu7dt.js";import{S as B}from"./p32qvzx3ml1odktp.js";function F({title:a,content:n,buttons:l,time:s,icon:c,size:t="default",progressBar:f,disabled:i=!1,onClick:d}){const g="border-[rgba(0,0,0,0.1)] dark:border-[rgba(255,255,255,0.1)]",h=t==="small"?`w-full sm:w-[380px] pr-[15px] pl-[20px] pt-[13px] pb-[10px] ${i?"":"gap-4"}`:"w-full gap-4 px-[22px] pb-[22px] pt-[18px]",m=d?"cursor-pointer":"",j=t==="small"?"text-[15px]":"";return e.jsxs("div",{className:r("inline-flex flex-col items-start justify-start rounded-2xl border",g,"bg-token-main-surface-primary dark:bg-token-main-surface-secondary",h,m,j),onClick:d,style:t==="small"&&!i?{boxShadow:"rgba(0, 0, 0, 0.06) 0px 2px 6px 0px"}:void 0,children:[e.jsxs("div",{className:r("flex flex-col items-start justify-start self-stretch",t!=="small"&&"gap-1.5"),children:[e.jsxs("div",{className:r("inline-flex items-start justify-start self-stretch",t!=="small"&&"gap-2"),children:[e.jsx("div",{className:r("shrink grow basis-0 font-medium leading-normal",i?"text-token-text-secondary":"text-token-text-primary"),children:a}),e.jsx("div",{className:"relative h-6 w-6"}),!i&&(c||e.jsx(B,{className:"relative h-6 w-6"}))]}),e.jsx("div",{className:r("flex w-full flex-col items-start justify-start",t==="small"&&"mt-[-2px]"),children:e.jsx("div",{className:r("inline-flex w-full items-start justify-start self-stretch rounded",t==="small"?"gap-1":"gap-2.5 py-1"),children:e.jsx("div",{className:r("w-full font-normal leading-relaxed",i?"text-token-text-tertiary":"text-token-text-secondary"),children:n})})})]}),f?e.jsxs("div",{className:r("mb-2 inline-flex items-center justify-between self-stretch",l?.length&&"mt-[-10px]"),children:[f,l]}):e.jsxs("div",{className:"inline-flex items-center justify-end self-stretch",children:[s&&e.jsx("div",{className:"shrink grow basis-0 text-[15px] font-normal leading-normal text-token-text-tertiary",children:s}),e.jsx("div",{className:"flex gap-2",children:l})]})]})}const R=/\*\*(.*?)(?:\*\*|\n|$)/g,z=a=>{let n=null,l;for(;(l=R.exec(a))!=null;)n=l[1].trim();return n};function L({message:a,isExpandable:n}){const s=a?.create_time?new Date(a.create_time*1e3):Date.now(),c=A(+s,48e4);return e.jsx($,{percentage:c,className:r("mr-4",n?"!w-3/4":"!w-full"),backgroundClassName:"bg-token-sidebar-surface-secondary rounded-full",barClassName:"bg-token-text-primary rounded-full",transitionDuration:`${(100-c)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)",height:8})}function U({messages:a,isStreaming:n,isLastMessage:l,clientThreadId:s,currentGroupedMessageIndex:c,turnIndex:t}){const[f,i]=x.useState(""),[d,g]=x.useState(!1),h=w(s,o=>o?.async_status===D.STREAMING),m=S(a),j=m?.id,v=m?.metadata?.initial_text,N=m?.metadata?.summarization_headline,p=a.map(o=>C(o)).join(`

`),{toggleThreadSidebar:b}=E(),y=x.useCallback(()=>{b({type:"summarizer",clientThreadId:s,currentGroupedMessageIndex:c,turnIndex:t})},[b,s,c,t]);x.useEffect(()=>{const o=z(p);o?i(o):v!=null&&i(v)},[p,v]),x.useEffect(()=>{p.length>0&&g(!0)},[p]),x.useEffect(()=>{d&&M.logEvent(T.receivedA8KM123Message,{client_thread_id:s,message_id:j,conversationId:_(s)})},[d]);const u=h&&l||n;return e.jsx("div",{className:"pb-2",children:e.jsx(F,{buttons:u?[e.jsx(P,{onClick:o=>{o.stopPropagation(),y()},color:"secondary",className:"!h-[38px] text-[15px] font-normal text-token-text-secondary",children:e.jsx("div",{className:"px-1",children:e.jsx(k,{id:"wQcuK8",defaultMessage:"Details"})})},"Details")]:[],time:null,title:N,icon:u?e.jsx("div",{className:""}):null,content:u?`${f}...`:m?.metadata?.finished_text??"",size:"small",disabled:!u,onClick:y,progressBar:u?e.jsx(L,{message:m,isExpandable:d}):null})})}export{U as default};
//# sourceMappingURL=o3ku8s79rgxxgin3.js.map
