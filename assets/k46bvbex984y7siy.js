import{j as a,a5 as M,g as X,r as j,e as W}from"./fs6h2trisr1juto6.js";import{T as Y,m as T}from"./cw7s5l0nt7rrqvcw.js";import{gx as F,c as U,gG as z,gH as P,gI as I,s as O,C as tt}from"./d7a6rc8fexfzu7dt.js";import{bT as et,d as u,g8 as at,B as ot}from"./njq6ygky3ttysgdk.js";import{u as _,c as st,D as nt,d as rt}from"./hi6ookkndgtqt4im.js";import{C as L,T as lt}from"./g68esxvkbqwuwphu.js";import{S as dt}from"./f426ftnka0mj72hs.js";import{S as ct}from"./lscxa7r7b9o6yh7m.js";import{P as H}from"./gfo75oujoeaedm5y.js";import{_ as it}from"./isjdmfmhzv09v01t.js";import{g as mt}from"./btagl6w1gub4aw61.js";import"./l4ce2zdnnawhaijx.js";import"./c1p22j8o7hm9vv5x.js";import"./npeck75bz46c490i.js";const S=({label:t,Icon:e,isCanvasHovered:o=!1,onClick:l,isDisabled:r})=>a.jsx(et,{label:t,children:a.jsx(M.button,{disabled:r,onClick:f=>{f.stopPropagation(),l?.(f)},animate:{opacity:o?1:.64},whileHover:{opacity:1},transition:{type:"tween",duration:.18},className:u("rounded-lg p-1 text-token-text-secondary transition-colors hover:bg-token-surface-hover focus-visible:bg-token-surface-hover focus-visible:outline-0",{"cursor-not-allowed":r}),children:a.jsx(e,{className:"icon-md"})})});var ft=it,xt=F,R=at,ht=parseFloat,ut=Math.min,gt=Math.random;function bt(t,e,o){if(o&&typeof o!="boolean"&&xt(t,e,o)&&(e=o=void 0),o===void 0&&(typeof e=="boolean"?(o=e,e=void 0):typeof t=="boolean"&&(o=t,t=void 0)),t===void 0&&e===void 0?(t=0,e=1):(t=R(t),e===void 0?(e=t,t=0):e=R(e)),t>e){var l=t;t=e,e=l}if(o||t%1||e%1){var r=gt();return ut(t+r*(e-t+ht("1e-"+((r+"").length-1))),e)}return ft(t,e)}var pt=bt;const yt=X(pt),jt=({isCanvasHovered:t=!1,onClick:e})=>{const o=W();return a.jsx(S,{label:o.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),Icon:dt,onClick:e,isCanvasHovered:t})},vt=({textdocVersion:t,clientThreadId:e})=>{const{handleCopy:o,Icon:l,copyLabel:r}=rt({textdocVersion:t,clientThreadId:e});return a.jsx(S,{label:r,Icon:l,onClick:o})},kt=({isCodePreviewable:t,onClick:e,isDisabled:o})=>{const l=W();return a.jsx(S,{label:l.formatMessage(t?T.previewCode:T.runCode),Icon:ct,onClick:e,isDisabled:o})},Ct=({isCanvasOpen:t,isFocused:e,isCanvasHovered:o,isInlinePreview:l,size:r})=>t?e?"0px 2px 6px 0px rgba(0, 0, 0, 0.06)":"0px 2px 6px 0px rgba(0, 0, 0, 0)":l?o||e?`0px ${r==="large"?12:4}px ${r==="large"?32:10}px 0px rgba(0, 0, 0, 0.064)`:`0px ${r==="large"?6:4}px ${r==="large"?14:4}px 0px rgba(0, 0, 0, 0.04)`:"0px 2px 6px 0px rgba(0, 0, 0, 0)",Mt=({textdocId:t,clientThreadId:e,name:o,tag:l,icon:r,iconSelected:f,marginBottom:b,size:m="large",height:v=m==="large"?"22rem":"10rem",minHeight:g,isCanvasOpen:s=!1,isDisabled:x=!1,isFocused:d=!1,isInferring:p=!1,isInlinePreview:n=!1,isStreaming:c=!1,isUserMessage:h=!1,onClick:y,children:k})=>{const C=j.useRef(null),[i,E]=j.useState(!1),[$]=j.useState(()=>yt(100,180,!1)),N=ot(U(t)?.versions),B=_(),{isCodePreviewable:w,isCodeExecutable:V,hasCanvasCodeExecution:G}=st(N),D=c||!G,K=w||V,A=d&&s?f??r:r,Z=A?a.jsx("span",{className:u("flex-shrink-0 transition-[filter]",{grayscale:!d&&!i}),children:A}):a.jsx("div",{className:"flex h-5 w-[18px] flex-shrink-0 items-center overflow-hidden",children:a.jsx(H,{lines:1,size:"base",width:100,widthVariance:0})}),q=!o||p?a.jsx("div",{className:"flex h-6 flex-grow items-center overflow-hidden",style:{width:$},children:a.jsx(H,{lines:1,size:"base",width:100,widthVariance:0})}):a.jsx("span",{className:"min-w-0 truncate",children:o}),J=()=>{!C.current||x||(z.logButtonClick(P.MESSAGE_ATTACHMENT,{type:l}),I(C.current),y?.())},Q=()=>{t&&O({type:tt.Textdoc,textdocId:t,shouldRunCodeOnOpen:!0})};return a.jsxs(M.div,{role:"button",id:mt(t),initial:{opacity:c?0:1,scale:c?.9:1},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:0,duration:.72},className:u("popover relative z-0 flex select-none flex-col overflow-hidden border bg-token-main-surface-primary transition-shadow duration-500",x?"cursor-default":"cursor-pointer",{"border-token-text-tertiary font-medium dark:border-gray-600":d&&s,"font-regular":!d,"border-token-border-light":!i&&!d,"border-token-border-medium":i&&!d,"flex min-w-0 flex-shrink flex-grow-0 items-center justify-between self-start rounded-xl":s||!n,"rounded-2xl":!s&&n,"max-w-full":!h&&(s||!n),"max-w-[var(--user-chat-width,70%)]":h&&(s||!n),"w-full":!h&&!s&&n,"w-[var(--user-chat-width,70%)]":h&&!s&&n}),onMouseEnter:()=>!x&&E(!0),onMouseLeave:()=>E(!1),onClick:J,ref:C,style:{marginBottom:b,height:n&&!s?v:void 0,minHeight:n&&!s?g:void 0,width:m==="small"?"300px":void 0,boxShadow:Ct({isCanvasOpen:s,isFocused:d,isCanvasHovered:i,isInlinePreview:n,size:m})},children:[a.jsxs("div",{className:u("flex w-full min-w-0 items-center justify-between gap-2 self-start border-token-border-light px-4 transition-colors duration-700",{"border-token-border-light":!i&&!d,"border-token-border-medium":i&&!d,"text-sm font-medium text-token-text-primary":!s&&i&&n,"py-2":s||!n,"py-3":!s&&n,"text-sm font-medium text-token-text-secondary":!s&&!i&&n}),children:[a.jsxs("div",{className:u("flex min-w-0 items-center",{"gap-2":s||!n,"gap-3.5":!s&&n}),children:[Z,q]}),s?a.jsx(M.span,{animate:c?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:c&&a.jsx(Y,{gap:1,padding:0})}):n&&!x?a.jsxs("div",{className:"flex gap-2",children:[B&&e&&a.jsx(vt,{clientThreadId:e,textdocVersion:N??null}),B&&K&&a.jsx(kt,{isCodePreviewable:w,onClick:Q,isDisabled:D}),a.jsx(jt,{isCanvasHovered:i,onClick:y})]}):null]}),a.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!s&&k,n&&!s&&a.jsx(L,{size:m,position:"bottom"}),n&&m==="small"&&!s&&a.jsx(L,{size:m,position:"right"})]})]})},Gt=({textdocId:t,clientThreadId:e,name:o,tag:l,icon:r,iconSelected:f,isCanvasOpen:b=!1,isFetching:m=!1,isFocused:v=!1,isInlinePreview:g=!1,isStreaming:s=!1,isUserMessage:x=!1,onClick:d})=>{const[p,n]=j.useState(!1),c=_(),h=k=>{n(k>0)},y=g&&!b?16:12;return a.jsx(Mt,{textdocId:t,name:o,tag:l,icon:r,height:c?"auto":void 0,minHeight:c?"22rem":void 0,iconSelected:f,marginBottom:y,isCanvasOpen:b,isFocused:v,isInlinePreview:g,isStreaming:s,isUserMessage:x,onClick:d,clientThreadId:e,children:g&&a.jsx("div",{className:u("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-light":p,"border-transparent":!p}),children:m?a.jsx(nt,{}):!!t&&a.jsx(lt,{disableScroll:c,onScroll:h,textdocId:t,clientThreadId:e})})})};export{Gt as CanvasMessageAttachment,Mt as CanvasMessageAttachmentWrapper};
//# sourceMappingURL=k46bvbex984y7siy.js.map
